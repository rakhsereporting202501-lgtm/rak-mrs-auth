function R0(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function C0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P0={exports:{}},Mh={},x0={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oc=Symbol.for("react.element"),JA=Symbol.for("react.portal"),XA=Symbol.for("react.fragment"),ZA=Symbol.for("react.strict_mode"),e1=Symbol.for("react.profiler"),t1=Symbol.for("react.provider"),n1=Symbol.for("react.context"),r1=Symbol.for("react.forward_ref"),s1=Symbol.for("react.suspense"),i1=Symbol.for("react.memo"),o1=Symbol.for("react.lazy"),hv=Symbol.iterator;function a1(t){return t===null||typeof t!="object"?null:(t=hv&&t[hv]||t["@@iterator"],typeof t=="function"?t:null)}var k0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N0=Object.assign,D0={};function wl(t,e,n){this.props=t,this.context=e,this.refs=D0,this.updater=n||k0}wl.prototype.isReactComponent={};wl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function b0(){}b0.prototype=wl.prototype;function Qm(t,e,n){this.props=t,this.context=e,this.refs=D0,this.updater=n||k0}var Ym=Qm.prototype=new b0;Ym.constructor=Qm;N0(Ym,wl.prototype);Ym.isPureReactComponent=!0;var fv=Array.isArray,L0=Object.prototype.hasOwnProperty,Jm={current:null},O0={key:!0,ref:!0,__self:!0,__source:!0};function V0(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)L0.call(e,r)&&!O0.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:oc,type:t,key:i,ref:o,props:s,_owner:Jm.current}}function l1(t,e){return{$$typeof:oc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Xm(t){return typeof t=="object"&&t!==null&&t.$$typeof===oc}function u1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var pv=/\/+/g;function Mf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?u1(""+t.key):e.toString(36)}function yd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case oc:case JA:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Mf(o,0):r,fv(s)?(n="",t!=null&&(n=t.replace(pv,"$&/")+"/"),yd(s,e,n,"",function(c){return c})):s!=null&&(Xm(s)&&(s=l1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(pv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",fv(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Mf(i,l);o+=yd(i,e,n,u,s)}else if(u=a1(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Mf(i,l++),o+=yd(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function qc(t,e,n){if(t==null)return t;var r=[],s=0;return yd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function c1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wn={current:null},vd={transition:null},d1={ReactCurrentDispatcher:Wn,ReactCurrentBatchConfig:vd,ReactCurrentOwner:Jm};function M0(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:qc,forEach:function(t,e,n){qc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return qc(t,function(){e++}),e},toArray:function(t){return qc(t,function(e){return e})||[]},only:function(t){if(!Xm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=wl;Fe.Fragment=XA;Fe.Profiler=e1;Fe.PureComponent=Qm;Fe.StrictMode=ZA;Fe.Suspense=s1;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d1;Fe.act=M0;Fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=N0({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Jm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)L0.call(e,u)&&!O0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:oc,type:t.type,key:s,ref:i,props:r,_owner:o}};Fe.createContext=function(t){return t={$$typeof:n1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t1,_context:t},t.Consumer=t};Fe.createElement=V0;Fe.createFactory=function(t){var e=V0.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:r1,render:t}};Fe.isValidElement=Xm;Fe.lazy=function(t){return{$$typeof:o1,_payload:{_status:-1,_result:t},_init:c1}};Fe.memo=function(t,e){return{$$typeof:i1,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=vd.transition;vd.transition={};try{t()}finally{vd.transition=e}};Fe.unstable_act=M0;Fe.useCallback=function(t,e){return Wn.current.useCallback(t,e)};Fe.useContext=function(t){return Wn.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return Wn.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return Wn.current.useEffect(t,e)};Fe.useId=function(){return Wn.current.useId()};Fe.useImperativeHandle=function(t,e,n){return Wn.current.useImperativeHandle(t,e,n)};Fe.useInsertionEffect=function(t,e){return Wn.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return Wn.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return Wn.current.useMemo(t,e)};Fe.useReducer=function(t,e,n){return Wn.current.useReducer(t,e,n)};Fe.useRef=function(t){return Wn.current.useRef(t)};Fe.useState=function(t){return Wn.current.useState(t)};Fe.useSyncExternalStore=function(t,e,n){return Wn.current.useSyncExternalStore(t,e,n)};Fe.useTransition=function(){return Wn.current.useTransition()};Fe.version="18.3.1";x0.exports=Fe;var C=x0.exports;const j0=C0(C),h1=R0({__proto__:null,default:j0},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f1=C,p1=Symbol.for("react.element"),m1=Symbol.for("react.fragment"),g1=Object.prototype.hasOwnProperty,y1=f1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v1={key:!0,ref:!0,__self:!0,__source:!0};function F0(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)g1.call(e,r)&&!v1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:p1,type:t,key:i,ref:o,props:s,_owner:y1.current}}Mh.Fragment=m1;Mh.jsx=F0;Mh.jsxs=F0;P0.exports=Mh;var p=P0.exports,Ap={},U0={exports:{}},wr={},B0={exports:{}},$0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,ue){var ye=G.length;G.push(ue);e:for(;0<ye;){var Se=ye-1>>>1,Ee=G[Se];if(0<s(Ee,ue))G[Se]=ue,G[ye]=Ee,ye=Se;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var ue=G[0],ye=G.pop();if(ye!==ue){G[0]=ye;e:for(var Se=0,Ee=G.length,Ie=Ee>>>1;Se<Ie;){var be=2*(Se+1)-1,Ne=G[be],Xe=be+1,Qe=G[Xe];if(0>s(Ne,ye))Xe<Ee&&0>s(Qe,Ne)?(G[Se]=Qe,G[Xe]=ye,Se=Xe):(G[Se]=Ne,G[be]=ye,Se=be);else if(Xe<Ee&&0>s(Qe,ye))G[Se]=Qe,G[Xe]=ye,Se=Xe;else break e}}return ue}function s(G,ue){var ye=G.sortIndex-ue.sortIndex;return ye!==0?ye:G.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],h=1,f=null,y=3,T=!1,R=!1,D=!1,V=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(G){for(var ue=n(c);ue!==null;){if(ue.callback===null)r(c);else if(ue.startTime<=G)r(c),ue.sortIndex=ue.expirationTime,e(u,ue);else break;ue=n(c)}}function j(G){if(D=!1,x(G),!R)if(n(u)!==null)R=!0,wt(q);else{var ue=n(c);ue!==null&&gt(j,ue.startTime-G)}}function q(G,ue){R=!1,D&&(D=!1,P(m),m=-1),T=!0;var ye=y;try{for(x(ue),f=n(u);f!==null&&(!(f.expirationTime>ue)||G&&!N());){var Se=f.callback;if(typeof Se=="function"){f.callback=null,y=f.priorityLevel;var Ee=Se(f.expirationTime<=ue);ue=t.unstable_now(),typeof Ee=="function"?f.callback=Ee:f===n(u)&&r(u),x(ue)}else r(u);f=n(u)}if(f!==null)var Ie=!0;else{var be=n(c);be!==null&&gt(j,be.startTime-ue),Ie=!1}return Ie}finally{f=null,y=ye,T=!1}}var W=!1,v=null,m=-1,A=5,I=-1;function N(){return!(t.unstable_now()-I<A)}function L(){if(v!==null){var G=t.unstable_now();I=G;var ue=!0;try{ue=v(!0,G)}finally{ue?k():(W=!1,v=null)}}else W=!1}var k;if(typeof _=="function")k=function(){_(L)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ke=de.port2;de.port1.onmessage=L,k=function(){ke.postMessage(null)}}else k=function(){V(L,0)};function wt(G){v=G,W||(W=!0,k())}function gt(G,ue){m=V(function(){G(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){R||T||(R=!0,wt(q))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(G){switch(y){case 1:case 2:case 3:var ue=3;break;default:ue=y}var ye=y;y=ue;try{return G()}finally{y=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,ue){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ye=y;y=G;try{return ue()}finally{y=ye}},t.unstable_scheduleCallback=function(G,ue,ye){var Se=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Se+ye:Se):ye=Se,G){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ye+Ee,G={id:h++,callback:ue,priorityLevel:G,startTime:ye,expirationTime:Ee,sortIndex:-1},ye>Se?(G.sortIndex=ye,e(c,G),n(u)===null&&G===n(c)&&(D?(P(m),m=-1):D=!0,gt(j,ye-Se))):(G.sortIndex=Ee,e(u,G),R||T||(R=!0,wt(q))),G},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(G){var ue=y;return function(){var ye=y;y=ue;try{return G.apply(this,arguments)}finally{y=ye}}}})($0);B0.exports=$0;var _1=B0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w1=C,_r=_1;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z0=new Set,Pu={};function ia(t,e){sl(t,e),sl(t+"Capture",e)}function sl(t,e){for(Pu[t]=e,t=0;t<e.length;t++)z0.add(e[t])}var Gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rp=Object.prototype.hasOwnProperty,E1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mv={},gv={};function T1(t){return Rp.call(gv,t)?!0:Rp.call(mv,t)?!1:E1.test(t)?gv[t]=!0:(mv[t]=!0,!1)}function S1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function I1(t,e,n,r){if(e===null||typeof e>"u"||S1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rn[t]=new Kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rn[e]=new Kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rn[t]=new Kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rn[t]=new Kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rn[t]=new Kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rn[t]=new Kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rn[t]=new Kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rn[t]=new Kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rn[t]=new Kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zm=/[\-:]([a-z])/g;function eg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zm,eg);Rn[e]=new Kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zm,eg);Rn[e]=new Kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zm,eg);Rn[e]=new Kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!1,!1)});Rn.xlinkHref=new Kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function tg(t,e,n,r){var s=Rn.hasOwnProperty(e)?Rn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(I1(e,n,s,r)&&(n=null),r||s===null?T1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ri=w1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hc=Symbol.for("react.element"),xa=Symbol.for("react.portal"),ka=Symbol.for("react.fragment"),ng=Symbol.for("react.strict_mode"),Cp=Symbol.for("react.profiler"),q0=Symbol.for("react.provider"),H0=Symbol.for("react.context"),rg=Symbol.for("react.forward_ref"),Pp=Symbol.for("react.suspense"),xp=Symbol.for("react.suspense_list"),sg=Symbol.for("react.memo"),Si=Symbol.for("react.lazy"),W0=Symbol.for("react.offscreen"),yv=Symbol.iterator;function $l(t){return t===null||typeof t!="object"?null:(t=yv&&t[yv]||t["@@iterator"],typeof t=="function"?t:null)}var xt=Object.assign,jf;function eu(t){if(jf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jf=e&&e[1]||""}return`
`+jf+t}var Ff=!1;function Uf(t,e){if(!t||Ff)return"";Ff=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Ff=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?eu(t):""}function A1(t){switch(t.tag){case 5:return eu(t.type);case 16:return eu("Lazy");case 13:return eu("Suspense");case 19:return eu("SuspenseList");case 0:case 2:case 15:return t=Uf(t.type,!1),t;case 11:return t=Uf(t.type.render,!1),t;case 1:return t=Uf(t.type,!0),t;default:return""}}function kp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ka:return"Fragment";case xa:return"Portal";case Cp:return"Profiler";case ng:return"StrictMode";case Pp:return"Suspense";case xp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case H0:return(t.displayName||"Context")+".Consumer";case q0:return(t._context.displayName||"Context")+".Provider";case rg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sg:return e=t.displayName||null,e!==null?e:kp(t.type)||"Memo";case Si:e=t._payload,t=t._init;try{return kp(t(e))}catch{}}return null}function R1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kp(e);case 8:return e===ng?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function K0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function C1(t){var e=K0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Wc(t){t._valueTracker||(t._valueTracker=C1(t))}function G0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=K0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Bd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Np(t,e){var n=e.checked;return xt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function vv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Q0(t,e){e=e.checked,e!=null&&tg(t,"checked",e,!1)}function Dp(t,e){Q0(t,e);var n=Zi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?bp(t,e.type,n):e.hasOwnProperty("defaultValue")&&bp(t,e.type,Zi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _v(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function bp(t,e,n){(e!=="number"||Bd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var tu=Array.isArray;function qa(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Lp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return xt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(X(92));if(tu(n)){if(1<n.length)throw Error(X(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zi(n)}}function Y0(t,e){var n=Zi(e.value),r=Zi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ev(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function J0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Op(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?J0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Kc,X0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Kc=Kc||document.createElement("div"),Kc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Kc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},P1=["Webkit","ms","Moz","O"];Object.keys(hu).forEach(function(t){P1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hu[e]=hu[t]})});function Z0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hu.hasOwnProperty(t)&&hu[t]?(""+e).trim():e+"px"}function eE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Z0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var x1=xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vp(t,e){if(e){if(x1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function Mp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jp=null;function ig(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fp=null,Ha=null,Wa=null;function Tv(t){if(t=uc(t)){if(typeof Fp!="function")throw Error(X(280));var e=t.stateNode;e&&(e=$h(e),Fp(t.stateNode,t.type,e))}}function tE(t){Ha?Wa?Wa.push(t):Wa=[t]:Ha=t}function nE(){if(Ha){var t=Ha,e=Wa;if(Wa=Ha=null,Tv(t),e)for(t=0;t<e.length;t++)Tv(e[t])}}function rE(t,e){return t(e)}function sE(){}var Bf=!1;function iE(t,e,n){if(Bf)return t(e,n);Bf=!0;try{return rE(t,e,n)}finally{Bf=!1,(Ha!==null||Wa!==null)&&(sE(),nE())}}function ku(t,e){var n=t.stateNode;if(n===null)return null;var r=$h(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(X(231,e,typeof n));return n}var Up=!1;if(Gs)try{var zl={};Object.defineProperty(zl,"passive",{get:function(){Up=!0}}),window.addEventListener("test",zl,zl),window.removeEventListener("test",zl,zl)}catch{Up=!1}function k1(t,e,n,r,s,i,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(h){this.onError(h)}}var fu=!1,$d=null,zd=!1,Bp=null,N1={onError:function(t){fu=!0,$d=t}};function D1(t,e,n,r,s,i,o,l,u){fu=!1,$d=null,k1.apply(N1,arguments)}function b1(t,e,n,r,s,i,o,l,u){if(D1.apply(this,arguments),fu){if(fu){var c=$d;fu=!1,$d=null}else throw Error(X(198));zd||(zd=!0,Bp=c)}}function oa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sv(t){if(oa(t)!==t)throw Error(X(188))}function L1(t){var e=t.alternate;if(!e){if(e=oa(t),e===null)throw Error(X(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Sv(s),t;if(i===r)return Sv(s),e;i=i.sibling}throw Error(X(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(X(189))}}if(n.alternate!==r)throw Error(X(190))}if(n.tag!==3)throw Error(X(188));return n.stateNode.current===n?t:e}function aE(t){return t=L1(t),t!==null?lE(t):null}function lE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lE(t);if(e!==null)return e;t=t.sibling}return null}var uE=_r.unstable_scheduleCallback,Iv=_r.unstable_cancelCallback,O1=_r.unstable_shouldYield,V1=_r.unstable_requestPaint,zt=_r.unstable_now,M1=_r.unstable_getCurrentPriorityLevel,og=_r.unstable_ImmediatePriority,cE=_r.unstable_UserBlockingPriority,qd=_r.unstable_NormalPriority,j1=_r.unstable_LowPriority,dE=_r.unstable_IdlePriority,jh=null,vs=null;function F1(t){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(jh,t,void 0,(t.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:$1,U1=Math.log,B1=Math.LN2;function $1(t){return t>>>=0,t===0?32:31-(U1(t)/B1|0)|0}var Gc=64,Qc=4194304;function nu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=nu(l):(i&=o,i!==0&&(r=nu(i)))}else o=n&~s,o!==0?r=nu(o):i!==0&&(r=nu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yr(e),s=1<<n,r|=t[n],e&=~s;return r}function z1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Yr(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=z1(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function $p(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hE(){var t=Gc;return Gc<<=1,!(Gc&4194240)&&(Gc=64),t}function $f(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ac(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yr(e),t[e]=n}function H1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Yr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function ag(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ut=0;function fE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pE,lg,mE,gE,yE,zp=!1,Yc=[],ji=null,Fi=null,Ui=null,Nu=new Map,Du=new Map,Ci=[],W1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Av(t,e){switch(t){case"focusin":case"focusout":ji=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":Ui=null;break;case"pointerover":case"pointerout":Nu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Du.delete(e.pointerId)}}function ql(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=uc(e),e!==null&&lg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function K1(t,e,n,r,s){switch(e){case"focusin":return ji=ql(ji,t,e,n,r,s),!0;case"dragenter":return Fi=ql(Fi,t,e,n,r,s),!0;case"mouseover":return Ui=ql(Ui,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Nu.set(i,ql(Nu.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Du.set(i,ql(Du.get(i)||null,t,e,n,r,s)),!0}return!1}function vE(t){var e=Fo(t.target);if(e!==null){var n=oa(e);if(n!==null){if(e=n.tag,e===13){if(e=oE(n),e!==null){t.blockedOn=e,yE(t.priority,function(){mE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _d(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=qp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);jp=r,n.target.dispatchEvent(r),jp=null}else return e=uc(n),e!==null&&lg(e),t.blockedOn=n,!1;e.shift()}return!0}function Rv(t,e,n){_d(t)&&n.delete(e)}function G1(){zp=!1,ji!==null&&_d(ji)&&(ji=null),Fi!==null&&_d(Fi)&&(Fi=null),Ui!==null&&_d(Ui)&&(Ui=null),Nu.forEach(Rv),Du.forEach(Rv)}function Hl(t,e){t.blockedOn===e&&(t.blockedOn=null,zp||(zp=!0,_r.unstable_scheduleCallback(_r.unstable_NormalPriority,G1)))}function bu(t){function e(s){return Hl(s,t)}if(0<Yc.length){Hl(Yc[0],t);for(var n=1;n<Yc.length;n++){var r=Yc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ji!==null&&Hl(ji,t),Fi!==null&&Hl(Fi,t),Ui!==null&&Hl(Ui,t),Nu.forEach(e),Du.forEach(e),n=0;n<Ci.length;n++)r=Ci[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ci.length&&(n=Ci[0],n.blockedOn===null);)vE(n),n.blockedOn===null&&Ci.shift()}var Ka=ri.ReactCurrentBatchConfig,Wd=!0;function Q1(t,e,n,r){var s=ut,i=Ka.transition;Ka.transition=null;try{ut=1,ug(t,e,n,r)}finally{ut=s,Ka.transition=i}}function Y1(t,e,n,r){var s=ut,i=Ka.transition;Ka.transition=null;try{ut=4,ug(t,e,n,r)}finally{ut=s,Ka.transition=i}}function ug(t,e,n,r){if(Wd){var s=qp(t,e,n,r);if(s===null)Xf(t,e,r,Kd,n),Av(t,r);else if(K1(s,t,e,n,r))r.stopPropagation();else if(Av(t,r),e&4&&-1<W1.indexOf(t)){for(;s!==null;){var i=uc(s);if(i!==null&&pE(i),i=qp(t,e,n,r),i===null&&Xf(t,e,r,Kd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Xf(t,e,r,null,n)}}var Kd=null;function qp(t,e,n,r){if(Kd=null,t=ig(r),t=Fo(t),t!==null)if(e=oa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Kd=t,null}function _E(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(M1()){case og:return 1;case cE:return 4;case qd:case j1:return 16;case dE:return 536870912;default:return 16}default:return 16}}var bi=null,cg=null,wd=null;function wE(){if(wd)return wd;var t,e=cg,n=e.length,r,s="value"in bi?bi.value:bi.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return wd=s.slice(t,1<r?1-r:void 0)}function Ed(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Jc(){return!0}function Cv(){return!1}function Er(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Jc:Cv,this.isPropagationStopped=Cv,this}return xt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Jc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Jc)},persist:function(){},isPersistent:Jc}),e}var El={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dg=Er(El),lc=xt({},El,{view:0,detail:0}),J1=Er(lc),zf,qf,Wl,Fh=xt({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wl&&(Wl&&t.type==="mousemove"?(zf=t.screenX-Wl.screenX,qf=t.screenY-Wl.screenY):qf=zf=0,Wl=t),zf)},movementY:function(t){return"movementY"in t?t.movementY:qf}}),Pv=Er(Fh),X1=xt({},Fh,{dataTransfer:0}),Z1=Er(X1),eR=xt({},lc,{relatedTarget:0}),Hf=Er(eR),tR=xt({},El,{animationName:0,elapsedTime:0,pseudoElement:0}),nR=Er(tR),rR=xt({},El,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sR=Er(rR),iR=xt({},El,{data:0}),xv=Er(iR),oR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lR[t])?!!e[t]:!1}function hg(){return uR}var cR=xt({},lc,{key:function(t){if(t.key){var e=oR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ed(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hg,charCode:function(t){return t.type==="keypress"?Ed(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ed(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dR=Er(cR),hR=xt({},Fh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kv=Er(hR),fR=xt({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hg}),pR=Er(fR),mR=xt({},El,{propertyName:0,elapsedTime:0,pseudoElement:0}),gR=Er(mR),yR=xt({},Fh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vR=Er(yR),_R=[9,13,27,32],fg=Gs&&"CompositionEvent"in window,pu=null;Gs&&"documentMode"in document&&(pu=document.documentMode);var wR=Gs&&"TextEvent"in window&&!pu,EE=Gs&&(!fg||pu&&8<pu&&11>=pu),Nv=" ",Dv=!1;function TE(t,e){switch(t){case"keyup":return _R.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Na=!1;function ER(t,e){switch(t){case"compositionend":return SE(e);case"keypress":return e.which!==32?null:(Dv=!0,Nv);case"textInput":return t=e.data,t===Nv&&Dv?null:t;default:return null}}function TR(t,e){if(Na)return t==="compositionend"||!fg&&TE(t,e)?(t=wE(),wd=cg=bi=null,Na=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return EE&&e.locale!=="ko"?null:e.data;default:return null}}var SR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!SR[t.type]:e==="textarea"}function IE(t,e,n,r){tE(r),e=Gd(e,"onChange"),0<e.length&&(n=new dg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var mu=null,Lu=null;function IR(t){OE(t,0)}function Uh(t){var e=La(t);if(G0(e))return t}function AR(t,e){if(t==="change")return e}var AE=!1;if(Gs){var Wf;if(Gs){var Kf="oninput"in document;if(!Kf){var Lv=document.createElement("div");Lv.setAttribute("oninput","return;"),Kf=typeof Lv.oninput=="function"}Wf=Kf}else Wf=!1;AE=Wf&&(!document.documentMode||9<document.documentMode)}function Ov(){mu&&(mu.detachEvent("onpropertychange",RE),Lu=mu=null)}function RE(t){if(t.propertyName==="value"&&Uh(Lu)){var e=[];IE(e,Lu,t,ig(t)),iE(IR,e)}}function RR(t,e,n){t==="focusin"?(Ov(),mu=e,Lu=n,mu.attachEvent("onpropertychange",RE)):t==="focusout"&&Ov()}function CR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uh(Lu)}function PR(t,e){if(t==="click")return Uh(e)}function xR(t,e){if(t==="input"||t==="change")return Uh(e)}function kR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Xr=typeof Object.is=="function"?Object.is:kR;function Ou(t,e){if(Xr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Rp.call(e,s)||!Xr(t[s],e[s]))return!1}return!0}function Vv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Mv(t,e){var n=Vv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Vv(n)}}function CE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?CE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function PE(){for(var t=window,e=Bd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Bd(t.document)}return e}function pg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function NR(t){var e=PE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&CE(n.ownerDocument.documentElement,n)){if(r!==null&&pg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Mv(n,i);var o=Mv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DR=Gs&&"documentMode"in document&&11>=document.documentMode,Da=null,Hp=null,gu=null,Wp=!1;function jv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wp||Da==null||Da!==Bd(r)||(r=Da,"selectionStart"in r&&pg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),gu&&Ou(gu,r)||(gu=r,r=Gd(Hp,"onSelect"),0<r.length&&(e=new dg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Da)))}function Xc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ba={animationend:Xc("Animation","AnimationEnd"),animationiteration:Xc("Animation","AnimationIteration"),animationstart:Xc("Animation","AnimationStart"),transitionend:Xc("Transition","TransitionEnd")},Gf={},xE={};Gs&&(xE=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function Bh(t){if(Gf[t])return Gf[t];if(!ba[t])return t;var e=ba[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in xE)return Gf[t]=e[n];return t}var kE=Bh("animationend"),NE=Bh("animationiteration"),DE=Bh("animationstart"),bE=Bh("transitionend"),LE=new Map,Fv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lo(t,e){LE.set(t,e),ia(e,[t])}for(var Qf=0;Qf<Fv.length;Qf++){var Yf=Fv[Qf],bR=Yf.toLowerCase(),LR=Yf[0].toUpperCase()+Yf.slice(1);lo(bR,"on"+LR)}lo(kE,"onAnimationEnd");lo(NE,"onAnimationIteration");lo(DE,"onAnimationStart");lo("dblclick","onDoubleClick");lo("focusin","onFocus");lo("focusout","onBlur");lo(bE,"onTransitionEnd");sl("onMouseEnter",["mouseout","mouseover"]);sl("onMouseLeave",["mouseout","mouseover"]);sl("onPointerEnter",["pointerout","pointerover"]);sl("onPointerLeave",["pointerout","pointerover"]);ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ia("onBeforeInput",["compositionend","keypress","textInput","paste"]);ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OR=new Set("cancel close invalid load scroll toggle".split(" ").concat(ru));function Uv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,b1(r,e,void 0,t),t.currentTarget=null}function OE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Uv(s,l,c),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Uv(s,l,c),i=u}}}if(zd)throw t=Bp,zd=!1,Bp=null,t}function yt(t,e){var n=e[Jp];n===void 0&&(n=e[Jp]=new Set);var r=t+"__bubble";n.has(r)||(VE(e,t,2,!1),n.add(r))}function Jf(t,e,n){var r=0;e&&(r|=4),VE(n,t,r,e)}var Zc="_reactListening"+Math.random().toString(36).slice(2);function Vu(t){if(!t[Zc]){t[Zc]=!0,z0.forEach(function(n){n!=="selectionchange"&&(OR.has(n)||Jf(n,!1,t),Jf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zc]||(e[Zc]=!0,Jf("selectionchange",!1,e))}}function VE(t,e,n,r){switch(_E(e)){case 1:var s=Q1;break;case 4:s=Y1;break;default:s=ug}n=s.bind(null,e,n,t),s=void 0,!Up||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Xf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Fo(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}iE(function(){var c=i,h=ig(n),f=[];e:{var y=LE.get(t);if(y!==void 0){var T=dg,R=t;switch(t){case"keypress":if(Ed(n)===0)break e;case"keydown":case"keyup":T=dR;break;case"focusin":R="focus",T=Hf;break;case"focusout":R="blur",T=Hf;break;case"beforeblur":case"afterblur":T=Hf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=Pv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=Z1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=pR;break;case kE:case NE:case DE:T=nR;break;case bE:T=gR;break;case"scroll":T=J1;break;case"wheel":T=vR;break;case"copy":case"cut":case"paste":T=sR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=kv}var D=(e&4)!==0,V=!D&&t==="scroll",P=D?y!==null?y+"Capture":null:y;D=[];for(var _=c,x;_!==null;){x=_;var j=x.stateNode;if(x.tag===5&&j!==null&&(x=j,P!==null&&(j=ku(_,P),j!=null&&D.push(Mu(_,j,x)))),V)break;_=_.return}0<D.length&&(y=new T(y,R,null,n,h),f.push({event:y,listeners:D}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",y&&n!==jp&&(R=n.relatedTarget||n.fromElement)&&(Fo(R)||R[Qs]))break e;if((T||y)&&(y=h.window===h?h:(y=h.ownerDocument)?y.defaultView||y.parentWindow:window,T?(R=n.relatedTarget||n.toElement,T=c,R=R?Fo(R):null,R!==null&&(V=oa(R),R!==V||R.tag!==5&&R.tag!==6)&&(R=null)):(T=null,R=c),T!==R)){if(D=Pv,j="onMouseLeave",P="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(D=kv,j="onPointerLeave",P="onPointerEnter",_="pointer"),V=T==null?y:La(T),x=R==null?y:La(R),y=new D(j,_+"leave",T,n,h),y.target=V,y.relatedTarget=x,j=null,Fo(h)===c&&(D=new D(P,_+"enter",R,n,h),D.target=x,D.relatedTarget=V,j=D),V=j,T&&R)t:{for(D=T,P=R,_=0,x=D;x;x=wa(x))_++;for(x=0,j=P;j;j=wa(j))x++;for(;0<_-x;)D=wa(D),_--;for(;0<x-_;)P=wa(P),x--;for(;_--;){if(D===P||P!==null&&D===P.alternate)break t;D=wa(D),P=wa(P)}D=null}else D=null;T!==null&&Bv(f,y,T,D,!1),R!==null&&V!==null&&Bv(f,V,R,D,!0)}}e:{if(y=c?La(c):window,T=y.nodeName&&y.nodeName.toLowerCase(),T==="select"||T==="input"&&y.type==="file")var q=AR;else if(bv(y))if(AE)q=xR;else{q=CR;var W=RR}else(T=y.nodeName)&&T.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(q=PR);if(q&&(q=q(t,c))){IE(f,q,n,h);break e}W&&W(t,y,c),t==="focusout"&&(W=y._wrapperState)&&W.controlled&&y.type==="number"&&bp(y,"number",y.value)}switch(W=c?La(c):window,t){case"focusin":(bv(W)||W.contentEditable==="true")&&(Da=W,Hp=c,gu=null);break;case"focusout":gu=Hp=Da=null;break;case"mousedown":Wp=!0;break;case"contextmenu":case"mouseup":case"dragend":Wp=!1,jv(f,n,h);break;case"selectionchange":if(DR)break;case"keydown":case"keyup":jv(f,n,h)}var v;if(fg)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Na?TE(t,n)&&(m="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(m="onCompositionStart");m&&(EE&&n.locale!=="ko"&&(Na||m!=="onCompositionStart"?m==="onCompositionEnd"&&Na&&(v=wE()):(bi=h,cg="value"in bi?bi.value:bi.textContent,Na=!0)),W=Gd(c,m),0<W.length&&(m=new xv(m,t,null,n,h),f.push({event:m,listeners:W}),v?m.data=v:(v=SE(n),v!==null&&(m.data=v)))),(v=wR?ER(t,n):TR(t,n))&&(c=Gd(c,"onBeforeInput"),0<c.length&&(h=new xv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:c}),h.data=v))}OE(f,e)})}function Mu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ku(t,n),i!=null&&r.unshift(Mu(t,i,s)),i=ku(t,e),i!=null&&r.push(Mu(t,i,s))),t=t.return}return r}function wa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Bv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=ku(n,i),u!=null&&o.unshift(Mu(n,u,l))):s||(u=ku(n,i),u!=null&&o.push(Mu(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var VR=/\r\n?/g,MR=/\u0000|\uFFFD/g;function $v(t){return(typeof t=="string"?t:""+t).replace(VR,`
`).replace(MR,"")}function ed(t,e,n){if(e=$v(e),$v(t)!==e&&n)throw Error(X(425))}function Qd(){}var Kp=null,Gp=null;function Qp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yp=typeof setTimeout=="function"?setTimeout:void 0,jR=typeof clearTimeout=="function"?clearTimeout:void 0,zv=typeof Promise=="function"?Promise:void 0,FR=typeof queueMicrotask=="function"?queueMicrotask:typeof zv<"u"?function(t){return zv.resolve(null).then(t).catch(UR)}:Yp;function UR(t){setTimeout(function(){throw t})}function Zf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),bu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);bu(e)}function Bi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Tl=Math.random().toString(36).slice(2),ys="__reactFiber$"+Tl,ju="__reactProps$"+Tl,Qs="__reactContainer$"+Tl,Jp="__reactEvents$"+Tl,BR="__reactListeners$"+Tl,$R="__reactHandles$"+Tl;function Fo(t){var e=t[ys];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qs]||n[ys]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qv(t);t!==null;){if(n=t[ys])return n;t=qv(t)}return e}t=n,n=t.parentNode}return null}function uc(t){return t=t[ys]||t[Qs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function La(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function $h(t){return t[ju]||null}var Xp=[],Oa=-1;function uo(t){return{current:t}}function _t(t){0>Oa||(t.current=Xp[Oa],Xp[Oa]=null,Oa--)}function mt(t,e){Oa++,Xp[Oa]=t.current,t.current=e}var eo={},Un=uo(eo),nr=uo(!1),Ko=eo;function il(t,e){var n=t.type.contextTypes;if(!n)return eo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function rr(t){return t=t.childContextTypes,t!=null}function Yd(){_t(nr),_t(Un)}function Hv(t,e,n){if(Un.current!==eo)throw Error(X(168));mt(Un,e),mt(nr,n)}function ME(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(X(108,R1(t)||"Unknown",s));return xt({},n,r)}function Jd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||eo,Ko=Un.current,mt(Un,t),mt(nr,nr.current),!0}function Wv(t,e,n){var r=t.stateNode;if(!r)throw Error(X(169));n?(t=ME(t,e,Ko),r.__reactInternalMemoizedMergedChildContext=t,_t(nr),_t(Un),mt(Un,t)):_t(nr),mt(nr,n)}var Bs=null,zh=!1,ep=!1;function jE(t){Bs===null?Bs=[t]:Bs.push(t)}function zR(t){zh=!0,jE(t)}function co(){if(!ep&&Bs!==null){ep=!0;var t=0,e=ut;try{var n=Bs;for(ut=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Bs=null,zh=!1}catch(s){throw Bs!==null&&(Bs=Bs.slice(t+1)),uE(og,co),s}finally{ut=e,ep=!1}}return null}var Va=[],Ma=0,Xd=null,Zd=0,xr=[],kr=0,Go=null,$s=1,zs="";function Lo(t,e){Va[Ma++]=Zd,Va[Ma++]=Xd,Xd=t,Zd=e}function FE(t,e,n){xr[kr++]=$s,xr[kr++]=zs,xr[kr++]=Go,Go=t;var r=$s;t=zs;var s=32-Yr(r)-1;r&=~(1<<s),n+=1;var i=32-Yr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,$s=1<<32-Yr(e)+s|n<<s|r,zs=i+t}else $s=1<<i|n<<s|r,zs=t}function mg(t){t.return!==null&&(Lo(t,1),FE(t,1,0))}function gg(t){for(;t===Xd;)Xd=Va[--Ma],Va[Ma]=null,Zd=Va[--Ma],Va[Ma]=null;for(;t===Go;)Go=xr[--kr],xr[kr]=null,zs=xr[--kr],xr[kr]=null,$s=xr[--kr],xr[kr]=null}var yr=null,mr=null,At=!1,Kr=null;function UE(t,e){var n=Nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Kv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yr=t,mr=Bi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yr=t,mr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Go!==null?{id:$s,overflow:zs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,yr=t,mr=null,!0):!1;default:return!1}}function Zp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function em(t){if(At){var e=mr;if(e){var n=e;if(!Kv(t,e)){if(Zp(t))throw Error(X(418));e=Bi(n.nextSibling);var r=yr;e&&Kv(t,e)?UE(r,n):(t.flags=t.flags&-4097|2,At=!1,yr=t)}}else{if(Zp(t))throw Error(X(418));t.flags=t.flags&-4097|2,At=!1,yr=t}}}function Gv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yr=t}function td(t){if(t!==yr)return!1;if(!At)return Gv(t),At=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qp(t.type,t.memoizedProps)),e&&(e=mr)){if(Zp(t))throw BE(),Error(X(418));for(;e;)UE(t,e),e=Bi(e.nextSibling)}if(Gv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){mr=Bi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}mr=null}}else mr=yr?Bi(t.stateNode.nextSibling):null;return!0}function BE(){for(var t=mr;t;)t=Bi(t.nextSibling)}function ol(){mr=yr=null,At=!1}function yg(t){Kr===null?Kr=[t]:Kr.push(t)}var qR=ri.ReactCurrentBatchConfig;function Kl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(X(309));var r=n.stateNode}if(!r)throw Error(X(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(X(284));if(!n._owner)throw Error(X(290,t))}return t}function nd(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qv(t){var e=t._init;return e(t._payload)}function $E(t){function e(P,_){if(t){var x=P.deletions;x===null?(P.deletions=[_],P.flags|=16):x.push(_)}}function n(P,_){if(!t)return null;for(;_!==null;)e(P,_),_=_.sibling;return null}function r(P,_){for(P=new Map;_!==null;)_.key!==null?P.set(_.key,_):P.set(_.index,_),_=_.sibling;return P}function s(P,_){return P=Hi(P,_),P.index=0,P.sibling=null,P}function i(P,_,x){return P.index=x,t?(x=P.alternate,x!==null?(x=x.index,x<_?(P.flags|=2,_):x):(P.flags|=2,_)):(P.flags|=1048576,_)}function o(P){return t&&P.alternate===null&&(P.flags|=2),P}function l(P,_,x,j){return _===null||_.tag!==6?(_=ap(x,P.mode,j),_.return=P,_):(_=s(_,x),_.return=P,_)}function u(P,_,x,j){var q=x.type;return q===ka?h(P,_,x.props.children,j,x.key):_!==null&&(_.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Si&&Qv(q)===_.type)?(j=s(_,x.props),j.ref=Kl(P,_,x),j.return=P,j):(j=Pd(x.type,x.key,x.props,null,P.mode,j),j.ref=Kl(P,_,x),j.return=P,j)}function c(P,_,x,j){return _===null||_.tag!==4||_.stateNode.containerInfo!==x.containerInfo||_.stateNode.implementation!==x.implementation?(_=lp(x,P.mode,j),_.return=P,_):(_=s(_,x.children||[]),_.return=P,_)}function h(P,_,x,j,q){return _===null||_.tag!==7?(_=Wo(x,P.mode,j,q),_.return=P,_):(_=s(_,x),_.return=P,_)}function f(P,_,x){if(typeof _=="string"&&_!==""||typeof _=="number")return _=ap(""+_,P.mode,x),_.return=P,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Hc:return x=Pd(_.type,_.key,_.props,null,P.mode,x),x.ref=Kl(P,null,_),x.return=P,x;case xa:return _=lp(_,P.mode,x),_.return=P,_;case Si:var j=_._init;return f(P,j(_._payload),x)}if(tu(_)||$l(_))return _=Wo(_,P.mode,x,null),_.return=P,_;nd(P,_)}return null}function y(P,_,x,j){var q=_!==null?_.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return q!==null?null:l(P,_,""+x,j);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Hc:return x.key===q?u(P,_,x,j):null;case xa:return x.key===q?c(P,_,x,j):null;case Si:return q=x._init,y(P,_,q(x._payload),j)}if(tu(x)||$l(x))return q!==null?null:h(P,_,x,j,null);nd(P,x)}return null}function T(P,_,x,j,q){if(typeof j=="string"&&j!==""||typeof j=="number")return P=P.get(x)||null,l(_,P,""+j,q);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Hc:return P=P.get(j.key===null?x:j.key)||null,u(_,P,j,q);case xa:return P=P.get(j.key===null?x:j.key)||null,c(_,P,j,q);case Si:var W=j._init;return T(P,_,x,W(j._payload),q)}if(tu(j)||$l(j))return P=P.get(x)||null,h(_,P,j,q,null);nd(_,j)}return null}function R(P,_,x,j){for(var q=null,W=null,v=_,m=_=0,A=null;v!==null&&m<x.length;m++){v.index>m?(A=v,v=null):A=v.sibling;var I=y(P,v,x[m],j);if(I===null){v===null&&(v=A);break}t&&v&&I.alternate===null&&e(P,v),_=i(I,_,m),W===null?q=I:W.sibling=I,W=I,v=A}if(m===x.length)return n(P,v),At&&Lo(P,m),q;if(v===null){for(;m<x.length;m++)v=f(P,x[m],j),v!==null&&(_=i(v,_,m),W===null?q=v:W.sibling=v,W=v);return At&&Lo(P,m),q}for(v=r(P,v);m<x.length;m++)A=T(v,P,m,x[m],j),A!==null&&(t&&A.alternate!==null&&v.delete(A.key===null?m:A.key),_=i(A,_,m),W===null?q=A:W.sibling=A,W=A);return t&&v.forEach(function(N){return e(P,N)}),At&&Lo(P,m),q}function D(P,_,x,j){var q=$l(x);if(typeof q!="function")throw Error(X(150));if(x=q.call(x),x==null)throw Error(X(151));for(var W=q=null,v=_,m=_=0,A=null,I=x.next();v!==null&&!I.done;m++,I=x.next()){v.index>m?(A=v,v=null):A=v.sibling;var N=y(P,v,I.value,j);if(N===null){v===null&&(v=A);break}t&&v&&N.alternate===null&&e(P,v),_=i(N,_,m),W===null?q=N:W.sibling=N,W=N,v=A}if(I.done)return n(P,v),At&&Lo(P,m),q;if(v===null){for(;!I.done;m++,I=x.next())I=f(P,I.value,j),I!==null&&(_=i(I,_,m),W===null?q=I:W.sibling=I,W=I);return At&&Lo(P,m),q}for(v=r(P,v);!I.done;m++,I=x.next())I=T(v,P,m,I.value,j),I!==null&&(t&&I.alternate!==null&&v.delete(I.key===null?m:I.key),_=i(I,_,m),W===null?q=I:W.sibling=I,W=I);return t&&v.forEach(function(L){return e(P,L)}),At&&Lo(P,m),q}function V(P,_,x,j){if(typeof x=="object"&&x!==null&&x.type===ka&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Hc:e:{for(var q=x.key,W=_;W!==null;){if(W.key===q){if(q=x.type,q===ka){if(W.tag===7){n(P,W.sibling),_=s(W,x.props.children),_.return=P,P=_;break e}}else if(W.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Si&&Qv(q)===W.type){n(P,W.sibling),_=s(W,x.props),_.ref=Kl(P,W,x),_.return=P,P=_;break e}n(P,W);break}else e(P,W);W=W.sibling}x.type===ka?(_=Wo(x.props.children,P.mode,j,x.key),_.return=P,P=_):(j=Pd(x.type,x.key,x.props,null,P.mode,j),j.ref=Kl(P,_,x),j.return=P,P=j)}return o(P);case xa:e:{for(W=x.key;_!==null;){if(_.key===W)if(_.tag===4&&_.stateNode.containerInfo===x.containerInfo&&_.stateNode.implementation===x.implementation){n(P,_.sibling),_=s(_,x.children||[]),_.return=P,P=_;break e}else{n(P,_);break}else e(P,_);_=_.sibling}_=lp(x,P.mode,j),_.return=P,P=_}return o(P);case Si:return W=x._init,V(P,_,W(x._payload),j)}if(tu(x))return R(P,_,x,j);if($l(x))return D(P,_,x,j);nd(P,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,_!==null&&_.tag===6?(n(P,_.sibling),_=s(_,x),_.return=P,P=_):(n(P,_),_=ap(x,P.mode,j),_.return=P,P=_),o(P)):n(P,_)}return V}var al=$E(!0),zE=$E(!1),eh=uo(null),th=null,ja=null,vg=null;function _g(){vg=ja=th=null}function wg(t){var e=eh.current;_t(eh),t._currentValue=e}function tm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ga(t,e){th=t,vg=ja=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(tr=!0),t.firstContext=null)}function br(t){var e=t._currentValue;if(vg!==t)if(t={context:t,memoizedValue:e,next:null},ja===null){if(th===null)throw Error(X(308));ja=t,th.dependencies={lanes:0,firstContext:t}}else ja=ja.next=t;return e}var Uo=null;function Eg(t){Uo===null?Uo=[t]:Uo.push(t)}function qE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Eg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ys(t,r)}function Ys(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ii=!1;function Tg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ws(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $i(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ys(t,n)}return s=r.interleaved,s===null?(e.next=e,Eg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ys(t,n)}function Td(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ag(t,n)}}function Yv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function nh(t,e,n,r){var s=t.updateQueue;Ii=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=u))}if(i!==null){var f=s.baseState;o=0,h=c=u=null,l=i;do{var y=l.lane,T=l.eventTime;if((r&y)===y){h!==null&&(h=h.next={eventTime:T,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,D=l;switch(y=e,T=n,D.tag){case 1:if(R=D.payload,typeof R=="function"){f=R.call(T,f,y);break e}f=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=D.payload,y=typeof R=="function"?R.call(T,f,y):R,y==null)break e;f=xt({},f,y);break e;case 2:Ii=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else T={eventTime:T,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(c=h=T,u=f):h=h.next=T,o|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(h===null&&(u=f),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Yo|=o,t.lanes=o,t.memoizedState=f}}function Jv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(X(191,s));s.call(r)}}}var cc={},_s=uo(cc),Fu=uo(cc),Uu=uo(cc);function Bo(t){if(t===cc)throw Error(X(174));return t}function Sg(t,e){switch(mt(Uu,e),mt(Fu,t),mt(_s,cc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Op(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Op(e,t)}_t(_s),mt(_s,e)}function ll(){_t(_s),_t(Fu),_t(Uu)}function WE(t){Bo(Uu.current);var e=Bo(_s.current),n=Op(e,t.type);e!==n&&(mt(Fu,t),mt(_s,n))}function Ig(t){Fu.current===t&&(_t(_s),_t(Fu))}var Ct=uo(0);function rh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tp=[];function Ag(){for(var t=0;t<tp.length;t++)tp[t]._workInProgressVersionPrimary=null;tp.length=0}var Sd=ri.ReactCurrentDispatcher,np=ri.ReactCurrentBatchConfig,Qo=0,Pt=null,un=null,gn=null,sh=!1,yu=!1,Bu=0,HR=0;function On(){throw Error(X(321))}function Rg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Xr(t[n],e[n]))return!1;return!0}function Cg(t,e,n,r,s,i){if(Qo=i,Pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sd.current=t===null||t.memoizedState===null?QR:YR,t=n(r,s),yu){i=0;do{if(yu=!1,Bu=0,25<=i)throw Error(X(301));i+=1,gn=un=null,e.updateQueue=null,Sd.current=JR,t=n(r,s)}while(yu)}if(Sd.current=ih,e=un!==null&&un.next!==null,Qo=0,gn=un=Pt=null,sh=!1,e)throw Error(X(300));return t}function Pg(){var t=Bu!==0;return Bu=0,t}function ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Pt.memoizedState=gn=t:gn=gn.next=t,gn}function Lr(){if(un===null){var t=Pt.alternate;t=t!==null?t.memoizedState:null}else t=un.next;var e=gn===null?Pt.memoizedState:gn.next;if(e!==null)gn=e,un=t;else{if(t===null)throw Error(X(310));un=t,t={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},gn===null?Pt.memoizedState=gn=t:gn=gn.next=t}return gn}function $u(t,e){return typeof e=="function"?e(t):e}function rp(t){var e=Lr(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=un,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,c=i;do{var h=c.lane;if((Qo&h)===h)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=f,o=r):u=u.next=f,Pt.lanes|=h,Yo|=h}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=l,Xr(r,e.memoizedState)||(tr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Pt.lanes|=i,Yo|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function sp(t){var e=Lr(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Xr(i,e.memoizedState)||(tr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function KE(){}function GE(t,e){var n=Pt,r=Lr(),s=e(),i=!Xr(r.memoizedState,s);if(i&&(r.memoizedState=s,tr=!0),r=r.queue,xg(JE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||gn!==null&&gn.memoizedState.tag&1){if(n.flags|=2048,zu(9,YE.bind(null,n,r,s,e),void 0,null),_n===null)throw Error(X(349));Qo&30||QE(n,e,s)}return s}function QE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Pt.updateQueue,e===null?(e={lastEffect:null,stores:null},Pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function YE(t,e,n,r){e.value=n,e.getSnapshot=r,XE(e)&&ZE(t)}function JE(t,e,n){return n(function(){XE(e)&&ZE(t)})}function XE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Xr(t,n)}catch{return!0}}function ZE(t){var e=Ys(t,1);e!==null&&Jr(e,t,1,-1)}function Xv(t){var e=ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$u,lastRenderedState:t},e.queue=t,t=t.dispatch=GR.bind(null,Pt,t),[e.memoizedState,t]}function zu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Pt.updateQueue,e===null?(e={lastEffect:null,stores:null},Pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function eT(){return Lr().memoizedState}function Id(t,e,n,r){var s=ms();Pt.flags|=t,s.memoizedState=zu(1|e,n,void 0,r===void 0?null:r)}function qh(t,e,n,r){var s=Lr();r=r===void 0?null:r;var i=void 0;if(un!==null){var o=un.memoizedState;if(i=o.destroy,r!==null&&Rg(r,o.deps)){s.memoizedState=zu(e,n,i,r);return}}Pt.flags|=t,s.memoizedState=zu(1|e,n,i,r)}function Zv(t,e){return Id(8390656,8,t,e)}function xg(t,e){return qh(2048,8,t,e)}function tT(t,e){return qh(4,2,t,e)}function nT(t,e){return qh(4,4,t,e)}function rT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sT(t,e,n){return n=n!=null?n.concat([t]):null,qh(4,4,rT.bind(null,e,t),n)}function kg(){}function iT(t,e){var n=Lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function oT(t,e){var n=Lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function aT(t,e,n){return Qo&21?(Xr(n,e)||(n=hE(),Pt.lanes|=n,Yo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,tr=!0),t.memoizedState=n)}function WR(t,e){var n=ut;ut=n!==0&&4>n?n:4,t(!0);var r=np.transition;np.transition={};try{t(!1),e()}finally{ut=n,np.transition=r}}function lT(){return Lr().memoizedState}function KR(t,e,n){var r=qi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},uT(t))cT(e,n);else if(n=qE(t,e,n,r),n!==null){var s=Hn();Jr(n,t,r,s),dT(n,e,r)}}function GR(t,e,n){var r=qi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(uT(t))cT(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Xr(l,o)){var u=e.interleaved;u===null?(s.next=s,Eg(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=qE(t,e,s,r),n!==null&&(s=Hn(),Jr(n,t,r,s),dT(n,e,r))}}function uT(t){var e=t.alternate;return t===Pt||e!==null&&e===Pt}function cT(t,e){yu=sh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ag(t,n)}}var ih={readContext:br,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},QR={readContext:br,useCallback:function(t,e){return ms().memoizedState=[t,e===void 0?null:e],t},useContext:br,useEffect:Zv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Id(4194308,4,rT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Id(4194308,4,t,e)},useInsertionEffect:function(t,e){return Id(4,2,t,e)},useMemo:function(t,e){var n=ms();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ms();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=KR.bind(null,Pt,t),[r.memoizedState,t]},useRef:function(t){var e=ms();return t={current:t},e.memoizedState=t},useState:Xv,useDebugValue:kg,useDeferredValue:function(t){return ms().memoizedState=t},useTransition:function(){var t=Xv(!1),e=t[0];return t=WR.bind(null,t[1]),ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Pt,s=ms();if(At){if(n===void 0)throw Error(X(407));n=n()}else{if(n=e(),_n===null)throw Error(X(349));Qo&30||QE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Zv(JE.bind(null,r,i,t),[t]),r.flags|=2048,zu(9,YE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ms(),e=_n.identifierPrefix;if(At){var n=zs,r=$s;n=(r&~(1<<32-Yr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=HR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},YR={readContext:br,useCallback:iT,useContext:br,useEffect:xg,useImperativeHandle:sT,useInsertionEffect:tT,useLayoutEffect:nT,useMemo:oT,useReducer:rp,useRef:eT,useState:function(){return rp($u)},useDebugValue:kg,useDeferredValue:function(t){var e=Lr();return aT(e,un.memoizedState,t)},useTransition:function(){var t=rp($u)[0],e=Lr().memoizedState;return[t,e]},useMutableSource:KE,useSyncExternalStore:GE,useId:lT,unstable_isNewReconciler:!1},JR={readContext:br,useCallback:iT,useContext:br,useEffect:xg,useImperativeHandle:sT,useInsertionEffect:tT,useLayoutEffect:nT,useMemo:oT,useReducer:sp,useRef:eT,useState:function(){return sp($u)},useDebugValue:kg,useDeferredValue:function(t){var e=Lr();return un===null?e.memoizedState=t:aT(e,un.memoizedState,t)},useTransition:function(){var t=sp($u)[0],e=Lr().memoizedState;return[t,e]},useMutableSource:KE,useSyncExternalStore:GE,useId:lT,unstable_isNewReconciler:!1};function qr(t,e){if(t&&t.defaultProps){e=xt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:xt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Hh={isMounted:function(t){return(t=t._reactInternals)?oa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Hn(),s=qi(t),i=Ws(r,s);i.payload=e,n!=null&&(i.callback=n),e=$i(t,i,s),e!==null&&(Jr(e,t,s,r),Td(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Hn(),s=qi(t),i=Ws(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=$i(t,i,s),e!==null&&(Jr(e,t,s,r),Td(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Hn(),r=qi(t),s=Ws(n,r);s.tag=2,e!=null&&(s.callback=e),e=$i(t,s,r),e!==null&&(Jr(e,t,r,n),Td(e,t,r))}};function e_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ou(n,r)||!Ou(s,i):!0}function hT(t,e,n){var r=!1,s=eo,i=e.contextType;return typeof i=="object"&&i!==null?i=br(i):(s=rr(e)?Ko:Un.current,r=e.contextTypes,i=(r=r!=null)?il(t,s):eo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function t_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Hh.enqueueReplaceState(e,e.state,null)}function rm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Tg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=br(i):(i=rr(e)?Ko:Un.current,s.context=il(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(nm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Hh.enqueueReplaceState(s,s.state,null),nh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ul(t,e){try{var n="",r=e;do n+=A1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ip(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var XR=typeof WeakMap=="function"?WeakMap:Map;function fT(t,e,n){n=Ws(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ah||(ah=!0,pm=r),sm(t,e)},n}function pT(t,e,n){n=Ws(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){sm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){sm(t,e),typeof r!="function"&&(zi===null?zi=new Set([this]):zi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function n_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new XR;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=hC.bind(null,t,e,n),e.then(t,t))}function r_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function s_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ws(-1,1),e.tag=2,$i(n,e,1))),n.lanes|=1),t)}var ZR=ri.ReactCurrentOwner,tr=!1;function zn(t,e,n,r){e.child=t===null?zE(e,null,n,r):al(e,t.child,n,r)}function i_(t,e,n,r,s){n=n.render;var i=e.ref;return Ga(e,s),r=Cg(t,e,n,r,i,s),n=Pg(),t!==null&&!tr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Js(t,e,s)):(At&&n&&mg(e),e.flags|=1,zn(t,e,r,s),e.child)}function o_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!jg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,mT(t,e,i,r,s)):(t=Pd(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ou,n(o,r)&&t.ref===e.ref)return Js(t,e,s)}return e.flags|=1,t=Hi(i,r),t.ref=e.ref,t.return=e,e.child=t}function mT(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ou(i,r)&&t.ref===e.ref)if(tr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(tr=!0);else return e.lanes=t.lanes,Js(t,e,s)}return im(t,e,n,r,s)}function gT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Ua,hr),hr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,mt(Ua,hr),hr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,mt(Ua,hr),hr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,mt(Ua,hr),hr|=r;return zn(t,e,s,n),e.child}function yT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function im(t,e,n,r,s){var i=rr(n)?Ko:Un.current;return i=il(e,i),Ga(e,s),n=Cg(t,e,n,r,i,s),r=Pg(),t!==null&&!tr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Js(t,e,s)):(At&&r&&mg(e),e.flags|=1,zn(t,e,n,s),e.child)}function a_(t,e,n,r,s){if(rr(n)){var i=!0;Jd(e)}else i=!1;if(Ga(e,s),e.stateNode===null)Ad(t,e),hT(e,n,r),rm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=br(c):(c=rr(n)?Ko:Un.current,c=il(e,c));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==c)&&t_(e,o,r,c),Ii=!1;var y=e.memoizedState;o.state=y,nh(e,r,o,s),u=e.memoizedState,l!==r||y!==u||nr.current||Ii?(typeof h=="function"&&(nm(e,n,h,r),u=e.memoizedState),(l=Ii||e_(e,n,l,r,y,u,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,HE(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:qr(e.type,l),o.props=c,f=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=br(u):(u=rr(n)?Ko:Un.current,u=il(e,u));var T=n.getDerivedStateFromProps;(h=typeof T=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||y!==u)&&t_(e,o,r,u),Ii=!1,y=e.memoizedState,o.state=y,nh(e,r,o,s);var R=e.memoizedState;l!==f||y!==R||nr.current||Ii?(typeof T=="function"&&(nm(e,n,T,r),R=e.memoizedState),(c=Ii||e_(e,n,c,r,y,R,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return om(t,e,n,r,i,s)}function om(t,e,n,r,s,i){yT(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Wv(e,n,!1),Js(t,e,i);r=e.stateNode,ZR.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=al(e,t.child,null,i),e.child=al(e,null,l,i)):zn(t,e,l,i),e.memoizedState=r.state,s&&Wv(e,n,!0),e.child}function vT(t){var e=t.stateNode;e.pendingContext?Hv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hv(t,e.context,!1),Sg(t,e.containerInfo)}function l_(t,e,n,r,s){return ol(),yg(s),e.flags|=256,zn(t,e,n,r),e.child}var am={dehydrated:null,treeContext:null,retryLane:0};function lm(t){return{baseLanes:t,cachePool:null,transitions:null}}function _T(t,e,n){var r=e.pendingProps,s=Ct.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),mt(Ct,s&1),t===null)return em(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Gh(o,r,0,null),t=Wo(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=lm(n),e.memoizedState=am,t):Ng(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return eC(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Hi(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Hi(l,i):(i=Wo(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?lm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=am,r}return i=t.child,t=i.sibling,r=Hi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ng(t,e){return e=Gh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function rd(t,e,n,r){return r!==null&&yg(r),al(e,t.child,null,n),t=Ng(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eC(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ip(Error(X(422))),rd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Gh({mode:"visible",children:r.children},s,0,null),i=Wo(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&al(e,t.child,null,o),e.child.memoizedState=lm(o),e.memoizedState=am,i);if(!(e.mode&1))return rd(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(X(419)),r=ip(i,r,void 0),rd(t,e,o,r)}if(l=(o&t.childLanes)!==0,tr||l){if(r=_n,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ys(t,s),Jr(r,t,s,-1))}return Mg(),r=ip(Error(X(421))),rd(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=fC.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,mr=Bi(s.nextSibling),yr=e,At=!0,Kr=null,t!==null&&(xr[kr++]=$s,xr[kr++]=zs,xr[kr++]=Go,$s=t.id,zs=t.overflow,Go=e),e=Ng(e,r.children),e.flags|=4096,e)}function u_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),tm(t.return,e,n)}function op(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function wT(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(zn(t,e,r.children,n),r=Ct.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&u_(t,n,e);else if(t.tag===19)u_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(mt(Ct,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&rh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),op(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&rh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}op(e,!0,n,null,i);break;case"together":op(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ad(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Js(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Yo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,n=Hi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Hi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tC(t,e,n){switch(e.tag){case 3:vT(e),ol();break;case 5:WE(e);break;case 1:rr(e.type)&&Jd(e);break;case 4:Sg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;mt(eh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(mt(Ct,Ct.current&1),e.flags|=128,null):n&e.child.childLanes?_T(t,e,n):(mt(Ct,Ct.current&1),t=Js(t,e,n),t!==null?t.sibling:null);mt(Ct,Ct.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return wT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),mt(Ct,Ct.current),r)break;return null;case 22:case 23:return e.lanes=0,gT(t,e,n)}return Js(t,e,n)}var ET,um,TT,ST;ET=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};um=function(){};TT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Bo(_s.current);var i=null;switch(n){case"input":s=Np(t,s),r=Np(t,r),i=[];break;case"select":s=xt({},s,{value:void 0}),r=xt({},r,{value:void 0}),i=[];break;case"textarea":s=Lp(t,s),r=Lp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Qd)}Vp(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Pu.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Pu.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&yt("scroll",t),i||l===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};ST=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gl(t,e){if(!At)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Vn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nC(t,e,n){var r=e.pendingProps;switch(gg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(e),null;case 1:return rr(e.type)&&Yd(),Vn(e),null;case 3:return r=e.stateNode,ll(),_t(nr),_t(Un),Ag(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(td(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Kr!==null&&(ym(Kr),Kr=null))),um(t,e),Vn(e),null;case 5:Ig(e);var s=Bo(Uu.current);if(n=e.type,t!==null&&e.stateNode!=null)TT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return Vn(e),null}if(t=Bo(_s.current),td(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ys]=e,r[ju]=i,t=(e.mode&1)!==0,n){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(s=0;s<ru.length;s++)yt(ru[s],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":vv(r,i),yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},yt("invalid",r);break;case"textarea":wv(r,i),yt("invalid",r)}Vp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ed(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ed(r.textContent,l,t),s=["children",""+l]):Pu.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&yt("scroll",r)}switch(n){case"input":Wc(r),_v(r,i,!0);break;case"textarea":Wc(r),Ev(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Qd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=J0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ys]=e,t[ju]=r,ET(t,e,!1,!1),e.stateNode=t;e:{switch(o=Mp(n,r),n){case"dialog":yt("cancel",t),yt("close",t),s=r;break;case"iframe":case"object":case"embed":yt("load",t),s=r;break;case"video":case"audio":for(s=0;s<ru.length;s++)yt(ru[s],t);s=r;break;case"source":yt("error",t),s=r;break;case"img":case"image":case"link":yt("error",t),yt("load",t),s=r;break;case"details":yt("toggle",t),s=r;break;case"input":vv(t,r),s=Np(t,r),yt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=xt({},r,{value:void 0}),yt("invalid",t);break;case"textarea":wv(t,r),s=Lp(t,r),yt("invalid",t);break;default:s=r}Vp(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?eE(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&X0(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&xu(t,u):typeof u=="number"&&xu(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pu.hasOwnProperty(i)?u!=null&&i==="onScroll"&&yt("scroll",t):u!=null&&tg(t,i,u,o))}switch(n){case"input":Wc(t),_v(t,r,!1);break;case"textarea":Wc(t),Ev(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?qa(t,!!r.multiple,i,!1):r.defaultValue!=null&&qa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Qd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vn(e),null;case 6:if(t&&e.stateNode!=null)ST(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(n=Bo(Uu.current),Bo(_s.current),td(e)){if(r=e.stateNode,n=e.memoizedProps,r[ys]=e,(i=r.nodeValue!==n)&&(t=yr,t!==null))switch(t.tag){case 3:ed(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ed(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ys]=e,e.stateNode=r}return Vn(e),null;case 13:if(_t(Ct),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(At&&mr!==null&&e.mode&1&&!(e.flags&128))BE(),ol(),e.flags|=98560,i=!1;else if(i=td(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[ys]=e}else ol(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Vn(e),i=!1}else Kr!==null&&(ym(Kr),Kr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ct.current&1?cn===0&&(cn=3):Mg())),e.updateQueue!==null&&(e.flags|=4),Vn(e),null);case 4:return ll(),um(t,e),t===null&&Vu(e.stateNode.containerInfo),Vn(e),null;case 10:return wg(e.type._context),Vn(e),null;case 17:return rr(e.type)&&Yd(),Vn(e),null;case 19:if(_t(Ct),i=e.memoizedState,i===null)return Vn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Gl(i,!1);else{if(cn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=rh(t),o!==null){for(e.flags|=128,Gl(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return mt(Ct,Ct.current&1|2),e.child}t=t.sibling}i.tail!==null&&zt()>cl&&(e.flags|=128,r=!0,Gl(i,!1),e.lanes=4194304)}else{if(!r)if(t=rh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!At)return Vn(e),null}else 2*zt()-i.renderingStartTime>cl&&n!==1073741824&&(e.flags|=128,r=!0,Gl(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=zt(),e.sibling=null,n=Ct.current,mt(Ct,r?n&1|2:n&1),e):(Vn(e),null);case 22:case 23:return Vg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?hr&1073741824&&(Vn(e),e.subtreeFlags&6&&(e.flags|=8192)):Vn(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function rC(t,e){switch(gg(e),e.tag){case 1:return rr(e.type)&&Yd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ll(),_t(nr),_t(Un),Ag(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ig(e),null;case 13:if(_t(Ct),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));ol()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return _t(Ct),null;case 4:return ll(),null;case 10:return wg(e.type._context),null;case 22:case 23:return Vg(),null;case 24:return null;default:return null}}var sd=!1,Fn=!1,sC=typeof WeakSet=="function"?WeakSet:Set,he=null;function Fa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ot(t,e,r)}else n.current=null}function cm(t,e,n){try{n()}catch(r){Ot(t,e,r)}}var c_=!1;function iC(t,e){if(Kp=Wd,t=PE(),pg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,c=0,h=0,f=t,y=null;t:for(;;){for(var T;f!==n||s!==0&&f.nodeType!==3||(l=o+s),f!==i||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(T=f.firstChild)!==null;)y=f,f=T;for(;;){if(f===t)break t;if(y===n&&++c===s&&(l=o),y===i&&++h===r&&(u=o),(T=f.nextSibling)!==null)break;f=y,y=f.parentNode}f=T}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gp={focusedElem:t,selectionRange:n},Wd=!1,he=e;he!==null;)if(e=he,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,he=t;else for(;he!==null;){e=he;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var D=R.memoizedProps,V=R.memoizedState,P=e.stateNode,_=P.getSnapshotBeforeUpdate(e.elementType===e.type?D:qr(e.type,D),V);P.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(j){Ot(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,he=t;break}he=e.return}return R=c_,c_=!1,R}function vu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&cm(e,n,i)}s=s.next}while(s!==r)}}function Wh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function dm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function IT(t){var e=t.alternate;e!==null&&(t.alternate=null,IT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ys],delete e[ju],delete e[Jp],delete e[BR],delete e[$R])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function AT(t){return t.tag===5||t.tag===3||t.tag===4}function d_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||AT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Qd));else if(r!==4&&(t=t.child,t!==null))for(hm(t,e,n),t=t.sibling;t!==null;)hm(t,e,n),t=t.sibling}function fm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fm(t,e,n),t=t.sibling;t!==null;)fm(t,e,n),t=t.sibling}var Tn=null,Hr=!1;function _i(t,e,n){for(n=n.child;n!==null;)RT(t,e,n),n=n.sibling}function RT(t,e,n){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(jh,n)}catch{}switch(n.tag){case 5:Fn||Fa(n,e);case 6:var r=Tn,s=Hr;Tn=null,_i(t,e,n),Tn=r,Hr=s,Tn!==null&&(Hr?(t=Tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tn.removeChild(n.stateNode));break;case 18:Tn!==null&&(Hr?(t=Tn,n=n.stateNode,t.nodeType===8?Zf(t.parentNode,n):t.nodeType===1&&Zf(t,n),bu(t)):Zf(Tn,n.stateNode));break;case 4:r=Tn,s=Hr,Tn=n.stateNode.containerInfo,Hr=!0,_i(t,e,n),Tn=r,Hr=s;break;case 0:case 11:case 14:case 15:if(!Fn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&cm(n,e,o),s=s.next}while(s!==r)}_i(t,e,n);break;case 1:if(!Fn&&(Fa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ot(n,e,l)}_i(t,e,n);break;case 21:_i(t,e,n);break;case 22:n.mode&1?(Fn=(r=Fn)||n.memoizedState!==null,_i(t,e,n),Fn=r):_i(t,e,n);break;default:_i(t,e,n)}}function h_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new sC),e.forEach(function(r){var s=pC.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function zr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Tn=l.stateNode,Hr=!1;break e;case 3:Tn=l.stateNode.containerInfo,Hr=!0;break e;case 4:Tn=l.stateNode.containerInfo,Hr=!0;break e}l=l.return}if(Tn===null)throw Error(X(160));RT(i,o,s),Tn=null,Hr=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Ot(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)CT(e,t),e=e.sibling}function CT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zr(e,t),ps(t),r&4){try{vu(3,t,t.return),Wh(3,t)}catch(D){Ot(t,t.return,D)}try{vu(5,t,t.return)}catch(D){Ot(t,t.return,D)}}break;case 1:zr(e,t),ps(t),r&512&&n!==null&&Fa(n,n.return);break;case 5:if(zr(e,t),ps(t),r&512&&n!==null&&Fa(n,n.return),t.flags&32){var s=t.stateNode;try{xu(s,"")}catch(D){Ot(t,t.return,D)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Q0(s,i),Mp(l,o);var c=Mp(l,i);for(o=0;o<u.length;o+=2){var h=u[o],f=u[o+1];h==="style"?eE(s,f):h==="dangerouslySetInnerHTML"?X0(s,f):h==="children"?xu(s,f):tg(s,h,f,c)}switch(l){case"input":Dp(s,i);break;case"textarea":Y0(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var T=i.value;T!=null?qa(s,!!i.multiple,T,!1):y!==!!i.multiple&&(i.defaultValue!=null?qa(s,!!i.multiple,i.defaultValue,!0):qa(s,!!i.multiple,i.multiple?[]:"",!1))}s[ju]=i}catch(D){Ot(t,t.return,D)}}break;case 6:if(zr(e,t),ps(t),r&4){if(t.stateNode===null)throw Error(X(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(D){Ot(t,t.return,D)}}break;case 3:if(zr(e,t),ps(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{bu(e.containerInfo)}catch(D){Ot(t,t.return,D)}break;case 4:zr(e,t),ps(t);break;case 13:zr(e,t),ps(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Lg=zt())),r&4&&h_(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Fn=(c=Fn)||h,zr(e,t),Fn=c):zr(e,t),ps(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(he=t,h=t.child;h!==null;){for(f=he=h;he!==null;){switch(y=he,T=y.child,y.tag){case 0:case 11:case 14:case 15:vu(4,y,y.return);break;case 1:Fa(y,y.return);var R=y.stateNode;if(typeof R.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(D){Ot(r,n,D)}}break;case 5:Fa(y,y.return);break;case 22:if(y.memoizedState!==null){p_(f);continue}}T!==null?(T.return=y,he=T):p_(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Z0("display",o))}catch(D){Ot(t,t.return,D)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(D){Ot(t,t.return,D)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:zr(e,t),ps(t),r&4&&h_(t);break;case 21:break;default:zr(e,t),ps(t)}}function ps(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(AT(n)){var r=n;break e}n=n.return}throw Error(X(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(xu(s,""),r.flags&=-33);var i=d_(t);fm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=d_(t);hm(t,l,o);break;default:throw Error(X(161))}}catch(u){Ot(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oC(t,e,n){he=t,PT(t)}function PT(t,e,n){for(var r=(t.mode&1)!==0;he!==null;){var s=he,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||sd;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Fn;l=sd;var c=Fn;if(sd=o,(Fn=u)&&!c)for(he=s;he!==null;)o=he,u=o.child,o.tag===22&&o.memoizedState!==null?m_(s):u!==null?(u.return=o,he=u):m_(s);for(;i!==null;)he=i,PT(i),i=i.sibling;he=s,sd=l,Fn=c}f_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,he=i):f_(t)}}function f_(t){for(;he!==null;){var e=he;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fn||Wh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Fn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Jv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Jv(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&bu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}Fn||e.flags&512&&dm(e)}catch(y){Ot(e,e.return,y)}}if(e===t){he=null;break}if(n=e.sibling,n!==null){n.return=e.return,he=n;break}he=e.return}}function p_(t){for(;he!==null;){var e=he;if(e===t){he=null;break}var n=e.sibling;if(n!==null){n.return=e.return,he=n;break}he=e.return}}function m_(t){for(;he!==null;){var e=he;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Wh(4,e)}catch(u){Ot(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ot(e,s,u)}}var i=e.return;try{dm(e)}catch(u){Ot(e,i,u)}break;case 5:var o=e.return;try{dm(e)}catch(u){Ot(e,o,u)}}}catch(u){Ot(e,e.return,u)}if(e===t){he=null;break}var l=e.sibling;if(l!==null){l.return=e.return,he=l;break}he=e.return}}var aC=Math.ceil,oh=ri.ReactCurrentDispatcher,Dg=ri.ReactCurrentOwner,Dr=ri.ReactCurrentBatchConfig,Je=0,_n=null,Zt=null,An=0,hr=0,Ua=uo(0),cn=0,qu=null,Yo=0,Kh=0,bg=0,_u=null,er=null,Lg=0,cl=1/0,Us=null,ah=!1,pm=null,zi=null,id=!1,Li=null,lh=0,wu=0,mm=null,Rd=-1,Cd=0;function Hn(){return Je&6?zt():Rd!==-1?Rd:Rd=zt()}function qi(t){return t.mode&1?Je&2&&An!==0?An&-An:qR.transition!==null?(Cd===0&&(Cd=hE()),Cd):(t=ut,t!==0||(t=window.event,t=t===void 0?16:_E(t.type)),t):1}function Jr(t,e,n,r){if(50<wu)throw wu=0,mm=null,Error(X(185));ac(t,n,r),(!(Je&2)||t!==_n)&&(t===_n&&(!(Je&2)&&(Kh|=n),cn===4&&Pi(t,An)),sr(t,r),n===1&&Je===0&&!(e.mode&1)&&(cl=zt()+500,zh&&co()))}function sr(t,e){var n=t.callbackNode;q1(t,e);var r=Hd(t,t===_n?An:0);if(r===0)n!==null&&Iv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Iv(n),e===1)t.tag===0?zR(g_.bind(null,t)):jE(g_.bind(null,t)),FR(function(){!(Je&6)&&co()}),n=null;else{switch(fE(r)){case 1:n=og;break;case 4:n=cE;break;case 16:n=qd;break;case 536870912:n=dE;break;default:n=qd}n=VT(n,xT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xT(t,e){if(Rd=-1,Cd=0,Je&6)throw Error(X(327));var n=t.callbackNode;if(Qa()&&t.callbackNode!==n)return null;var r=Hd(t,t===_n?An:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=uh(t,r);else{e=r;var s=Je;Je|=2;var i=NT();(_n!==t||An!==e)&&(Us=null,cl=zt()+500,Ho(t,e));do try{cC();break}catch(l){kT(t,l)}while(!0);_g(),oh.current=i,Je=s,Zt!==null?e=0:(_n=null,An=0,e=cn)}if(e!==0){if(e===2&&(s=$p(t),s!==0&&(r=s,e=gm(t,s))),e===1)throw n=qu,Ho(t,0),Pi(t,r),sr(t,zt()),n;if(e===6)Pi(t,r);else{if(s=t.current.alternate,!(r&30)&&!lC(s)&&(e=uh(t,r),e===2&&(i=$p(t),i!==0&&(r=i,e=gm(t,i))),e===1))throw n=qu,Ho(t,0),Pi(t,r),sr(t,zt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:Oo(t,er,Us);break;case 3:if(Pi(t,r),(r&130023424)===r&&(e=Lg+500-zt(),10<e)){if(Hd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Hn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Yp(Oo.bind(null,t,er,Us),e);break}Oo(t,er,Us);break;case 4:if(Pi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Yr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=zt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aC(r/1960))-r,10<r){t.timeoutHandle=Yp(Oo.bind(null,t,er,Us),r);break}Oo(t,er,Us);break;case 5:Oo(t,er,Us);break;default:throw Error(X(329))}}}return sr(t,zt()),t.callbackNode===n?xT.bind(null,t):null}function gm(t,e){var n=_u;return t.current.memoizedState.isDehydrated&&(Ho(t,e).flags|=256),t=uh(t,e),t!==2&&(e=er,er=n,e!==null&&ym(e)),t}function ym(t){er===null?er=t:er.push.apply(er,t)}function lC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Xr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pi(t,e){for(e&=~bg,e&=~Kh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yr(e),r=1<<n;t[n]=-1,e&=~r}}function g_(t){if(Je&6)throw Error(X(327));Qa();var e=Hd(t,0);if(!(e&1))return sr(t,zt()),null;var n=uh(t,e);if(t.tag!==0&&n===2){var r=$p(t);r!==0&&(e=r,n=gm(t,r))}if(n===1)throw n=qu,Ho(t,0),Pi(t,e),sr(t,zt()),n;if(n===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Oo(t,er,Us),sr(t,zt()),null}function Og(t,e){var n=Je;Je|=1;try{return t(e)}finally{Je=n,Je===0&&(cl=zt()+500,zh&&co())}}function Jo(t){Li!==null&&Li.tag===0&&!(Je&6)&&Qa();var e=Je;Je|=1;var n=Dr.transition,r=ut;try{if(Dr.transition=null,ut=1,t)return t()}finally{ut=r,Dr.transition=n,Je=e,!(Je&6)&&co()}}function Vg(){hr=Ua.current,_t(Ua)}function Ho(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,jR(n)),Zt!==null)for(n=Zt.return;n!==null;){var r=n;switch(gg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yd();break;case 3:ll(),_t(nr),_t(Un),Ag();break;case 5:Ig(r);break;case 4:ll();break;case 13:_t(Ct);break;case 19:_t(Ct);break;case 10:wg(r.type._context);break;case 22:case 23:Vg()}n=n.return}if(_n=t,Zt=t=Hi(t.current,null),An=hr=e,cn=0,qu=null,bg=Kh=Yo=0,er=_u=null,Uo!==null){for(e=0;e<Uo.length;e++)if(n=Uo[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Uo=null}return t}function kT(t,e){do{var n=Zt;try{if(_g(),Sd.current=ih,sh){for(var r=Pt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}sh=!1}if(Qo=0,gn=un=Pt=null,yu=!1,Bu=0,Dg.current=null,n===null||n.return===null){cn=1,qu=e,Zt=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=An,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var y=h.alternate;y?(h.updateQueue=y.updateQueue,h.memoizedState=y.memoizedState,h.lanes=y.lanes):(h.updateQueue=null,h.memoizedState=null)}var T=r_(o);if(T!==null){T.flags&=-257,s_(T,o,l,i,e),T.mode&1&&n_(i,c,e),e=T,u=c;var R=e.updateQueue;if(R===null){var D=new Set;D.add(u),e.updateQueue=D}else R.add(u);break e}else{if(!(e&1)){n_(i,c,e),Mg();break e}u=Error(X(426))}}else if(At&&l.mode&1){var V=r_(o);if(V!==null){!(V.flags&65536)&&(V.flags|=256),s_(V,o,l,i,e),yg(ul(u,l));break e}}i=u=ul(u,l),cn!==4&&(cn=2),_u===null?_u=[i]:_u.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var P=fT(i,u,e);Yv(i,P);break e;case 1:l=u;var _=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(zi===null||!zi.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=pT(i,l,e);Yv(i,j);break e}}i=i.return}while(i!==null)}bT(n)}catch(q){e=q,Zt===n&&n!==null&&(Zt=n=n.return);continue}break}while(!0)}function NT(){var t=oh.current;return oh.current=ih,t===null?ih:t}function Mg(){(cn===0||cn===3||cn===2)&&(cn=4),_n===null||!(Yo&268435455)&&!(Kh&268435455)||Pi(_n,An)}function uh(t,e){var n=Je;Je|=2;var r=NT();(_n!==t||An!==e)&&(Us=null,Ho(t,e));do try{uC();break}catch(s){kT(t,s)}while(!0);if(_g(),Je=n,oh.current=r,Zt!==null)throw Error(X(261));return _n=null,An=0,cn}function uC(){for(;Zt!==null;)DT(Zt)}function cC(){for(;Zt!==null&&!O1();)DT(Zt)}function DT(t){var e=OT(t.alternate,t,hr);t.memoizedProps=t.pendingProps,e===null?bT(t):Zt=e,Dg.current=null}function bT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rC(n,e),n!==null){n.flags&=32767,Zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{cn=6,Zt=null;return}}else if(n=nC(n,e,hr),n!==null){Zt=n;return}if(e=e.sibling,e!==null){Zt=e;return}Zt=e=t}while(e!==null);cn===0&&(cn=5)}function Oo(t,e,n){var r=ut,s=Dr.transition;try{Dr.transition=null,ut=1,dC(t,e,n,r)}finally{Dr.transition=s,ut=r}return null}function dC(t,e,n,r){do Qa();while(Li!==null);if(Je&6)throw Error(X(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(H1(t,i),t===_n&&(Zt=_n=null,An=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||id||(id=!0,VT(qd,function(){return Qa(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Dr.transition,Dr.transition=null;var o=ut;ut=1;var l=Je;Je|=4,Dg.current=null,iC(t,n),CT(n,t),NR(Gp),Wd=!!Kp,Gp=Kp=null,t.current=n,oC(n),V1(),Je=l,ut=o,Dr.transition=i}else t.current=n;if(id&&(id=!1,Li=t,lh=s),i=t.pendingLanes,i===0&&(zi=null),F1(n.stateNode),sr(t,zt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ah)throw ah=!1,t=pm,pm=null,t;return lh&1&&t.tag!==0&&Qa(),i=t.pendingLanes,i&1?t===mm?wu++:(wu=0,mm=t):wu=0,co(),null}function Qa(){if(Li!==null){var t=fE(lh),e=Dr.transition,n=ut;try{if(Dr.transition=null,ut=16>t?16:t,Li===null)var r=!1;else{if(t=Li,Li=null,lh=0,Je&6)throw Error(X(331));var s=Je;for(Je|=4,he=t.current;he!==null;){var i=he,o=i.child;if(he.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(he=c;he!==null;){var h=he;switch(h.tag){case 0:case 11:case 15:vu(8,h,i)}var f=h.child;if(f!==null)f.return=h,he=f;else for(;he!==null;){h=he;var y=h.sibling,T=h.return;if(IT(h),h===c){he=null;break}if(y!==null){y.return=T,he=y;break}he=T}}}var R=i.alternate;if(R!==null){var D=R.child;if(D!==null){R.child=null;do{var V=D.sibling;D.sibling=null,D=V}while(D!==null)}}he=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,he=o;else e:for(;he!==null;){if(i=he,i.flags&2048)switch(i.tag){case 0:case 11:case 15:vu(9,i,i.return)}var P=i.sibling;if(P!==null){P.return=i.return,he=P;break e}he=i.return}}var _=t.current;for(he=_;he!==null;){o=he;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,he=x;else e:for(o=_;he!==null;){if(l=he,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Wh(9,l)}}catch(q){Ot(l,l.return,q)}if(l===o){he=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,he=j;break e}he=l.return}}if(Je=s,co(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(jh,t)}catch{}r=!0}return r}finally{ut=n,Dr.transition=e}}return!1}function y_(t,e,n){e=ul(n,e),e=fT(t,e,1),t=$i(t,e,1),e=Hn(),t!==null&&(ac(t,1,e),sr(t,e))}function Ot(t,e,n){if(t.tag===3)y_(t,t,n);else for(;e!==null;){if(e.tag===3){y_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zi===null||!zi.has(r))){t=ul(n,t),t=pT(e,t,1),e=$i(e,t,1),t=Hn(),e!==null&&(ac(e,1,t),sr(e,t));break}}e=e.return}}function hC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Hn(),t.pingedLanes|=t.suspendedLanes&n,_n===t&&(An&n)===n&&(cn===4||cn===3&&(An&130023424)===An&&500>zt()-Lg?Ho(t,0):bg|=n),sr(t,e)}function LT(t,e){e===0&&(t.mode&1?(e=Qc,Qc<<=1,!(Qc&130023424)&&(Qc=4194304)):e=1);var n=Hn();t=Ys(t,e),t!==null&&(ac(t,e,n),sr(t,n))}function fC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),LT(t,n)}function pC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),LT(t,n)}var OT;OT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||nr.current)tr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return tr=!1,tC(t,e,n);tr=!!(t.flags&131072)}else tr=!1,At&&e.flags&1048576&&FE(e,Zd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ad(t,e),t=e.pendingProps;var s=il(e,Un.current);Ga(e,n),s=Cg(null,e,r,t,s,n);var i=Pg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,rr(r)?(i=!0,Jd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Tg(e),s.updater=Hh,e.stateNode=s,s._reactInternals=e,rm(e,r,t,n),e=om(null,e,r,!0,i,n)):(e.tag=0,At&&i&&mg(e),zn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ad(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gC(r),t=qr(r,t),s){case 0:e=im(null,e,r,t,n);break e;case 1:e=a_(null,e,r,t,n);break e;case 11:e=i_(null,e,r,t,n);break e;case 14:e=o_(null,e,r,qr(r.type,t),n);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),im(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),a_(t,e,r,s,n);case 3:e:{if(vT(e),t===null)throw Error(X(387));r=e.pendingProps,i=e.memoizedState,s=i.element,HE(t,e),nh(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ul(Error(X(423)),e),e=l_(t,e,r,n,s);break e}else if(r!==s){s=ul(Error(X(424)),e),e=l_(t,e,r,n,s);break e}else for(mr=Bi(e.stateNode.containerInfo.firstChild),yr=e,At=!0,Kr=null,n=zE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ol(),r===s){e=Js(t,e,n);break e}zn(t,e,r,n)}e=e.child}return e;case 5:return WE(e),t===null&&em(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Qp(r,s)?o=null:i!==null&&Qp(r,i)&&(e.flags|=32),yT(t,e),zn(t,e,o,n),e.child;case 6:return t===null&&em(e),null;case 13:return _T(t,e,n);case 4:return Sg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=al(e,null,r,n):zn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),i_(t,e,r,s,n);case 7:return zn(t,e,e.pendingProps,n),e.child;case 8:return zn(t,e,e.pendingProps.children,n),e.child;case 12:return zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,mt(eh,r._currentValue),r._currentValue=o,i!==null)if(Xr(i.value,o)){if(i.children===s.children&&!nr.current){e=Js(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Ws(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),tm(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),tm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ga(e,n),s=br(s),r=r(s),e.flags|=1,zn(t,e,r,n),e.child;case 14:return r=e.type,s=qr(r,e.pendingProps),s=qr(r.type,s),o_(t,e,r,s,n);case 15:return mT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qr(r,s),Ad(t,e),e.tag=1,rr(r)?(t=!0,Jd(e)):t=!1,Ga(e,n),hT(e,r,s),rm(e,r,s,n),om(null,e,r,!0,t,n);case 19:return wT(t,e,n);case 22:return gT(t,e,n)}throw Error(X(156,e.tag))};function VT(t,e){return uE(t,e)}function mC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(t,e,n,r){return new mC(t,e,n,r)}function jg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gC(t){if(typeof t=="function")return jg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===rg)return 11;if(t===sg)return 14}return 2}function Hi(t,e){var n=t.alternate;return n===null?(n=Nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pd(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")jg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ka:return Wo(n.children,s,i,e);case ng:o=8,s|=8;break;case Cp:return t=Nr(12,n,e,s|2),t.elementType=Cp,t.lanes=i,t;case Pp:return t=Nr(13,n,e,s),t.elementType=Pp,t.lanes=i,t;case xp:return t=Nr(19,n,e,s),t.elementType=xp,t.lanes=i,t;case W0:return Gh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q0:o=10;break e;case H0:o=9;break e;case rg:o=11;break e;case sg:o=14;break e;case Si:o=16,r=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=Nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Wo(t,e,n,r){return t=Nr(7,t,r,e),t.lanes=n,t}function Gh(t,e,n,r){return t=Nr(22,t,r,e),t.elementType=W0,t.lanes=n,t.stateNode={isHidden:!1},t}function ap(t,e,n){return t=Nr(6,t,null,e),t.lanes=n,t}function lp(t,e,n){return e=Nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yC(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$f(0),this.expirationTimes=$f(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$f(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Fg(t,e,n,r,s,i,o,l,u){return t=new yC(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tg(i),t}function vC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function MT(t){if(!t)return eo;t=t._reactInternals;e:{if(oa(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(rr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var n=t.type;if(rr(n))return ME(t,n,e)}return e}function jT(t,e,n,r,s,i,o,l,u){return t=Fg(n,r,!0,t,s,i,o,l,u),t.context=MT(null),n=t.current,r=Hn(),s=qi(n),i=Ws(r,s),i.callback=e??null,$i(n,i,s),t.current.lanes=s,ac(t,s,r),sr(t,r),t}function Qh(t,e,n,r){var s=e.current,i=Hn(),o=qi(s);return n=MT(n),e.context===null?e.context=n:e.pendingContext=n,e=Ws(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$i(s,e,o),t!==null&&(Jr(t,s,o,i),Td(t,s,o)),o}function ch(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function v_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ug(t,e){v_(t,e),(t=t.alternate)&&v_(t,e)}function _C(){return null}var FT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Bg(t){this._internalRoot=t}Yh.prototype.render=Bg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));Qh(t,e,null,null)};Yh.prototype.unmount=Bg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Jo(function(){Qh(null,t,null,null)}),e[Qs]=null}};function Yh(t){this._internalRoot=t}Yh.prototype.unstable_scheduleHydration=function(t){if(t){var e=gE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ci.length&&e!==0&&e<Ci[n].priority;n++);Ci.splice(n,0,t),n===0&&vE(t)}};function $g(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function __(){}function wC(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=ch(o);i.call(c)}}var o=jT(e,r,t,0,null,!1,!1,"",__);return t._reactRootContainer=o,t[Qs]=o.current,Vu(t.nodeType===8?t.parentNode:t),Jo(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=ch(u);l.call(c)}}var u=Fg(t,0,!1,null,null,!1,!1,"",__);return t._reactRootContainer=u,t[Qs]=u.current,Vu(t.nodeType===8?t.parentNode:t),Jo(function(){Qh(e,u,n,r)}),u}function Xh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=ch(o);l.call(u)}}Qh(e,o,t,s)}else o=wC(n,e,t,s,r);return ch(o)}pE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=nu(e.pendingLanes);n!==0&&(ag(e,n|1),sr(e,zt()),!(Je&6)&&(cl=zt()+500,co()))}break;case 13:Jo(function(){var r=Ys(t,1);if(r!==null){var s=Hn();Jr(r,t,1,s)}}),Ug(t,1)}};lg=function(t){if(t.tag===13){var e=Ys(t,134217728);if(e!==null){var n=Hn();Jr(e,t,134217728,n)}Ug(t,134217728)}};mE=function(t){if(t.tag===13){var e=qi(t),n=Ys(t,e);if(n!==null){var r=Hn();Jr(n,t,e,r)}Ug(t,e)}};gE=function(){return ut};yE=function(t,e){var n=ut;try{return ut=t,e()}finally{ut=n}};Fp=function(t,e,n){switch(e){case"input":if(Dp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=$h(r);if(!s)throw Error(X(90));G0(r),Dp(r,s)}}}break;case"textarea":Y0(t,n);break;case"select":e=n.value,e!=null&&qa(t,!!n.multiple,e,!1)}};rE=Og;sE=Jo;var EC={usingClientEntryPoint:!1,Events:[uc,La,$h,tE,nE,Og]},Ql={findFiberByHostInstance:Fo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TC={bundleType:Ql.bundleType,version:Ql.version,rendererPackageName:Ql.rendererPackageName,rendererConfig:Ql.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ri.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ql.findFiberByHostInstance||_C,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!od.isDisabled&&od.supportsFiber)try{jh=od.inject(TC),vs=od}catch{}}wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EC;wr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$g(e))throw Error(X(200));return vC(t,e,null,n)};wr.createRoot=function(t,e){if(!$g(t))throw Error(X(299));var n=!1,r="",s=FT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Fg(t,1,!1,null,null,n,!1,r,s),t[Qs]=e.current,Vu(t.nodeType===8?t.parentNode:t),new Bg(e)};wr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=aE(e),t=t===null?null:t.stateNode,t};wr.flushSync=function(t){return Jo(t)};wr.hydrate=function(t,e,n){if(!Jh(e))throw Error(X(200));return Xh(null,t,e,!0,n)};wr.hydrateRoot=function(t,e,n){if(!$g(t))throw Error(X(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=FT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=jT(e,null,t,1,n??null,s,!1,i,o),t[Qs]=e.current,Vu(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Yh(e)};wr.render=function(t,e,n){if(!Jh(e))throw Error(X(200));return Xh(null,t,e,!1,n)};wr.unmountComponentAtNode=function(t){if(!Jh(t))throw Error(X(40));return t._reactRootContainer?(Jo(function(){Xh(null,null,t,!1,function(){t._reactRootContainer=null,t[Qs]=null})}),!0):!1};wr.unstable_batchedUpdates=Og;wr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jh(n))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Xh(t,e,n,!1,r)};wr.version="18.3.1-next-f1338f8080-20240426";function UT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UT)}catch(t){console.error(t)}}UT(),U0.exports=wr;var Hu=U0.exports;const SC=C0(Hu),IC=R0({__proto__:null,default:SC},[Hu]);var w_=Hu;Ap.createRoot=w_.createRoot,Ap.hydrateRoot=w_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function It(){return It=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},It.apply(this,arguments)}var Xt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xt||(Xt={}));const E_="popstate";function AC(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Wu("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Xo(s)}return CC(e,n,null,t)}function Le(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function dl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RC(){return Math.random().toString(36).substr(2,8)}function T_(t,e){return{usr:t.state,key:t.key,idx:e}}function Wu(t,e,n,r){return n===void 0&&(n=null),It({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ho(e):e,{state:n,key:e&&e.key||r||RC()})}function Xo(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ho(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function CC(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Xt.Pop,u=null,c=h();c==null&&(c=0,o.replaceState(It({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=Xt.Pop;let V=h(),P=V==null?null:V-c;c=V,u&&u({action:l,location:D.location,delta:P})}function y(V,P){l=Xt.Push;let _=Wu(D.location,V,P);c=h()+1;let x=T_(_,c),j=D.createHref(_);try{o.pushState(x,"",j)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;s.location.assign(j)}i&&u&&u({action:l,location:D.location,delta:1})}function T(V,P){l=Xt.Replace;let _=Wu(D.location,V,P);c=h();let x=T_(_,c),j=D.createHref(_);o.replaceState(x,"",j),i&&u&&u({action:l,location:D.location,delta:0})}function R(V){let P=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof V=="string"?V:Xo(V);return _=_.replace(/ $/,"%20"),Le(P,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,P)}let D={get action(){return l},get location(){return t(s,o)},listen(V){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(E_,f),u=V,()=>{s.removeEventListener(E_,f),u=null}},createHref(V){return e(s,V)},createURL:R,encodeLocation(V){let P=R(V);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:y,replace:T,go(V){return o.go(V)}};return D}var lt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(lt||(lt={}));const PC=new Set(["lazy","caseSensitive","path","id","index","children"]);function xC(t){return t.index===!0}function dh(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(Le(s.index!==!0||!s.children,"Cannot specify children on an index route"),Le(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),xC(s)){let u=It({},s,e(s),{id:l});return r[l]=u,u}else{let u=It({},s,e(s),{id:l,children:void 0});return r[l]=u,s.children&&(u.children=dh(s.children,e,o,r)),u}})}function Mo(t,e,n){return n===void 0&&(n="/"),xd(t,e,n,!1)}function xd(t,e,n,r){let s=typeof e=="string"?ho(e):e,i=Xs(s.pathname||"/",n);if(i==null)return null;let o=BT(t);NC(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let c=$C(i);l=UC(o[u],c,r)}return l}function kC(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function BT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Le(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let c=Ks([r,u.relativePath]),h=n.concat(u);i.children&&i.children.length>0&&(Le(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),BT(i.children,e,h,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:jC(c,i.index),routesMeta:h})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let u of $T(i.path))s(i,o,u)}),e}function $T(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=$T(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function NC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:FC(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const DC=/^:[\w-]+$/,bC=3,LC=2,OC=1,VC=10,MC=-2,S_=t=>t==="*";function jC(t,e){let n=t.split("/"),r=n.length;return n.some(S_)&&(r+=MC),e&&(r+=LC),n.filter(s=>!S_(s)).reduce((s,i)=>s+(DC.test(i)?bC:i===""?OC:VC),r)}function FC(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function UC(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],c=l===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=hh({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},h),y=u.route;if(!f&&c&&n&&!r[r.length-1].route.index&&(f=hh({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Ks([i,f.pathname]),pathnameBase:HC(Ks([i,f.pathnameBase])),route:y}),f.pathnameBase!=="/"&&(i=Ks([i,f.pathnameBase]))}return o}function hh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=BC(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((c,h,f)=>{let{paramName:y,isOptional:T}=h;if(y==="*"){let D=l[f]||"";o=i.slice(0,i.length-D.length).replace(/(.)\/+$/,"$1")}const R=l[f];return T&&!R?c[y]=void 0:c[y]=(R||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function BC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),dl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function $C(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dl(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Xs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function zC(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ho(t):t;return{pathname:n?n.startsWith("/")?n:qC(n,e):e,search:WC(r),hash:KC(s)}}function qC(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function up(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Zh(t,e){let n=zT(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function ef(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ho(t):(s=It({},t),Le(!s.pathname||!s.pathname.includes("?"),up("?","pathname","search",s)),Le(!s.pathname||!s.pathname.includes("#"),up("#","pathname","hash",s)),Le(!s.search||!s.search.includes("#"),up("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),f-=1;s.pathname=y.join("/")}l=f>=0?e[f]:"/"}let u=zC(s,l),c=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(c||h)&&(u.pathname+="/"),u}const Ks=t=>t.join("/").replace(/\/\/+/g,"/"),HC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),WC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,KC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class fh{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Ku(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const qT=["post","put","patch","delete"],GC=new Set(qT),QC=["get",...qT],YC=new Set(QC),JC=new Set([301,302,303,307,308]),XC=new Set([307,308]),cp={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ZC={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Yl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},zg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eP=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),HT="remix-router-transitions";function tP(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Le(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let b=t.detectErrorBoundary;s=O=>({hasErrorBoundary:b(O)})}else s=eP;let i={},o=dh(t.routes,s,void 0,i),l,u=t.basename||"/",c=t.dataStrategy||iP,h=t.patchRoutesOnNavigation,f=It({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),y=null,T=new Set,R=null,D=null,V=null,P=t.hydrationData!=null,_=Mo(o,t.history.location,u),x=!1,j=null;if(_==null&&!h){let b=Xn(404,{pathname:t.history.location.pathname}),{matches:O,route:S}=L_(o);_=O,j={[S.id]:b}}_&&!t.hydrationData&&lr(_,o,t.history.location.pathname).active&&(_=null);let q;if(_)if(_.some(b=>b.route.lazy))q=!1;else if(!_.some(b=>b.route.loader))q=!0;else if(f.v7_partialHydration){let b=t.hydrationData?t.hydrationData.loaderData:null,O=t.hydrationData?t.hydrationData.errors:null;if(O){let S=_.findIndex(M=>O[M.route.id]!==void 0);q=_.slice(0,S+1).every(M=>!_m(M.route,b,O))}else q=_.every(S=>!_m(S.route,b,O))}else q=t.hydrationData!=null;else if(q=!1,_=[],f.v7_partialHydration){let b=lr(null,o,t.history.location.pathname);b.active&&b.matches&&(x=!0,_=b.matches)}let W,v={historyAction:t.history.action,location:t.history.location,matches:_,initialized:q,navigation:cp,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||j,fetchers:new Map,blockers:new Map},m=Xt.Pop,A=!1,I,N=!1,L=new Map,k=null,de=!1,ke=!1,wt=[],gt=new Set,G=new Map,ue=0,ye=-1,Se=new Map,Ee=new Set,Ie=new Map,be=new Map,Ne=new Set,Xe=new Map,Qe=new Map,ct;function Tr(){if(y=t.history.listen(b=>{let{action:O,location:S,delta:M}=b;if(ct){ct(),ct=void 0;return}dl(Qe.size===0||M!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let B=Qt({currentLocation:v.location,nextLocation:S,historyAction:O});if(B&&M!=null){let Q=new Promise(ae=>{ct=ae});t.history.go(M*-1),ft(B,{state:"blocked",location:S,proceed(){ft(B,{state:"proceeding",proceed:void 0,reset:void 0,location:S}),Q.then(()=>t.history.go(M))},reset(){let ae=new Map(v.blockers);ae.set(B,Yl),Ue({blockers:ae})}});return}return Wt(O,S)}),n){_P(e,L);let b=()=>wP(e,L);e.addEventListener("pagehide",b),k=()=>e.removeEventListener("pagehide",b)}return v.initialized||Wt(Xt.Pop,v.location,{initialHydration:!0}),W}function qt(){y&&y(),k&&k(),T.clear(),I&&I.abort(),v.fetchers.forEach((b,O)=>ir(O)),v.blockers.forEach((b,O)=>Nn(O))}function jt(b){return T.add(b),()=>T.delete(b)}function Ue(b,O){O===void 0&&(O={}),v=It({},v,b);let S=[],M=[];f.v7_fetcherPersist&&v.fetchers.forEach((B,Q)=>{B.state==="idle"&&(Ne.has(Q)?M.push(Q):S.push(Q))}),Ne.forEach(B=>{!v.fetchers.has(B)&&!G.has(B)&&M.push(B)}),[...T].forEach(B=>B(v,{deletedFetchers:M,viewTransitionOpts:O.viewTransitionOpts,flushSync:O.flushSync===!0})),f.v7_fetcherPersist?(S.forEach(B=>v.fetchers.delete(B)),M.forEach(B=>ir(B))):M.forEach(B=>Ne.delete(B))}function Et(b,O,S){var M,B;let{flushSync:Q}=S===void 0?{}:S,ae=v.actionData!=null&&v.navigation.formMethod!=null&&Wr(v.navigation.formMethod)&&v.navigation.state==="loading"&&((M=b.state)==null?void 0:M._isRedirect)!==!0,te;O.actionData?Object.keys(O.actionData).length>0?te=O.actionData:te=null:ae?te=v.actionData:te=null;let ie=O.loaderData?D_(v.loaderData,O.loaderData,O.matches||[],O.errors):v.loaderData,se=v.blockers;se.size>0&&(se=new Map(se),se.forEach((ve,qe)=>se.set(qe,Yl)));let Z=A===!0||v.navigation.formMethod!=null&&Wr(v.navigation.formMethod)&&((B=b.state)==null?void 0:B._isRedirect)!==!0;l&&(o=l,l=void 0),de||m===Xt.Pop||(m===Xt.Push?t.history.push(b,b.state):m===Xt.Replace&&t.history.replace(b,b.state));let ge;if(m===Xt.Pop){let ve=L.get(v.location.pathname);ve&&ve.has(b.pathname)?ge={currentLocation:v.location,nextLocation:b}:L.has(b.pathname)&&(ge={currentLocation:b,nextLocation:v.location})}else if(N){let ve=L.get(v.location.pathname);ve?ve.add(b.pathname):(ve=new Set([b.pathname]),L.set(v.location.pathname,ve)),ge={currentLocation:v.location,nextLocation:b}}Ue(It({},O,{actionData:te,loaderData:ie,historyAction:m,location:b,initialized:!0,navigation:cp,revalidation:"idle",restoreScrollPosition:Mr(b,O.matches||v.matches),preventScrollReset:Z,blockers:se}),{viewTransitionOpts:ge,flushSync:Q===!0}),m=Xt.Pop,A=!1,N=!1,de=!1,ke=!1,wt=[]}async function nn(b,O){if(typeof b=="number"){t.history.go(b);return}let S=vm(v.location,v.matches,u,f.v7_prependBasename,b,f.v7_relativeSplatPath,O==null?void 0:O.fromRouteId,O==null?void 0:O.relative),{path:M,submission:B,error:Q}=I_(f.v7_normalizeFormMethod,!1,S,O),ae=v.location,te=Wu(v.location,M,O&&O.state);te=It({},te,t.history.encodeLocation(te));let ie=O&&O.replace!=null?O.replace:void 0,se=Xt.Push;ie===!0?se=Xt.Replace:ie===!1||B!=null&&Wr(B.formMethod)&&B.formAction===v.location.pathname+v.location.search&&(se=Xt.Replace);let Z=O&&"preventScrollReset"in O?O.preventScrollReset===!0:void 0,ge=(O&&O.flushSync)===!0,ve=Qt({currentLocation:ae,nextLocation:te,historyAction:se});if(ve){ft(ve,{state:"blocked",location:te,proceed(){ft(ve,{state:"proceeding",proceed:void 0,reset:void 0,location:te}),nn(b,O)},reset(){let qe=new Map(v.blockers);qe.set(ve,Yl),Ue({blockers:qe})}});return}return await Wt(se,te,{submission:B,pendingError:Q,preventScrollReset:Z,replace:O&&O.replace,enableViewTransition:O&&O.viewTransition,flushSync:ge})}function Ht(){if(Ye(),Ue({revalidation:"loading"}),v.navigation.state!=="submitting"){if(v.navigation.state==="idle"){Wt(v.historyAction,v.location,{startUninterruptedRevalidation:!0});return}Wt(m||v.historyAction,v.navigation.location,{overrideNavigation:v.navigation,enableViewTransition:N===!0})}}async function Wt(b,O,S){I&&I.abort(),I=null,m=b,de=(S&&S.startUninterruptedRevalidation)===!0,ar(v.location,v.matches),A=(S&&S.preventScrollReset)===!0,N=(S&&S.enableViewTransition)===!0;let M=l||o,B=S&&S.overrideNavigation,Q=S!=null&&S.initialHydration&&v.matches&&v.matches.length>0&&!x?v.matches:Mo(M,O,u),ae=(S&&S.flushSync)===!0;if(Q&&v.initialized&&!ke&&dP(v.location,O)&&!(S&&S.submission&&Wr(S.submission.formMethod))){Et(O,{matches:Q},{flushSync:ae});return}let te=lr(Q,M,O.pathname);if(te.active&&te.matches&&(Q=te.matches),!Q){let{error:Me,notFoundMatches:De,route:He}=Tt(O.pathname);Et(O,{matches:De,loaderData:{},errors:{[He.id]:Me}},{flushSync:ae});return}I=new AbortController;let ie=Ea(t.history,O,I.signal,S&&S.submission),se;if(S&&S.pendingError)se=[jo(Q).route.id,{type:lt.error,error:S.pendingError}];else if(S&&S.submission&&Wr(S.submission.formMethod)){let Me=await Sr(ie,O,S.submission,Q,te.active,{replace:S.replace,flushSync:ae});if(Me.shortCircuited)return;if(Me.pendingActionResult){let[De,He]=Me.pendingActionResult;if(fr(He)&&Ku(He.error)&&He.error.status===404){I=null,Et(O,{matches:Me.matches,loaderData:{},errors:{[De]:He.error}});return}}Q=Me.matches||Q,se=Me.pendingActionResult,B=dp(O,S.submission),ae=!1,te.active=!1,ie=Ea(t.history,ie.url,ie.signal)}let{shortCircuited:Z,matches:ge,loaderData:ve,errors:qe}=await Vr(ie,O,Q,te.active,B,S&&S.submission,S&&S.fetcherSubmission,S&&S.replace,S&&S.initialHydration===!0,ae,se);Z||(I=null,Et(O,It({matches:ge||Q},b_(se),{loaderData:ve,errors:qe})))}async function Sr(b,O,S,M,B,Q){Q===void 0&&(Q={}),Ye();let ae=yP(O,S);if(Ue({navigation:ae},{flushSync:Q.flushSync===!0}),B){let se=await wn(M,O.pathname,b.signal);if(se.type==="aborted")return{shortCircuited:!0};if(se.type==="error"){let Z=jo(se.partialMatches).route.id;return{matches:se.partialMatches,pendingActionResult:[Z,{type:lt.error,error:se.error}]}}else if(se.matches)M=se.matches;else{let{notFoundMatches:Z,error:ge,route:ve}=Tt(O.pathname);return{matches:Z,pendingActionResult:[ve.id,{type:lt.error,error:ge}]}}}let te,ie=su(M,O);if(!ie.route.action&&!ie.route.lazy)te={type:lt.error,error:Xn(405,{method:b.method,pathname:O.pathname,routeId:ie.route.id})};else if(te=(await Be("action",v,b,[ie],M,null))[ie.route.id],b.signal.aborted)return{shortCircuited:!0};if($o(te)){let se;return Q&&Q.replace!=null?se=Q.replace:se=x_(te.response.headers.get("Location"),new URL(b.url),u)===v.location.pathname+v.location.search,await me(b,te,!0,{submission:S,replace:se}),{shortCircuited:!0}}if(Oi(te))throw Xn(400,{type:"defer-action"});if(fr(te)){let se=jo(M,ie.route.id);return(Q&&Q.replace)!==!0&&(m=Xt.Push),{matches:M,pendingActionResult:[se.route.id,te]}}return{matches:M,pendingActionResult:[ie.route.id,te]}}async function Vr(b,O,S,M,B,Q,ae,te,ie,se,Z){let ge=B||dp(O,Q),ve=Q||ae||V_(ge),qe=!de&&(!f.v7_partialHydration||!ie);if(M){if(qe){let tt=Pn(Z);Ue(It({navigation:ge},tt!==void 0?{actionData:tt}:{}),{flushSync:se})}let Ce=await wn(S,O.pathname,b.signal);if(Ce.type==="aborted")return{shortCircuited:!0};if(Ce.type==="error"){let tt=jo(Ce.partialMatches).route.id;return{matches:Ce.partialMatches,loaderData:{},errors:{[tt]:Ce.error}}}else if(Ce.matches)S=Ce.matches;else{let{error:tt,notFoundMatches:bn,route:is}=Tt(O.pathname);return{matches:bn,loaderData:{},errors:{[is.id]:tt}}}}let Me=l||o,[De,He]=R_(t.history,v,S,ve,O,f.v7_partialHydration&&ie===!0,f.v7_skipActionErrorRevalidation,ke,wt,gt,Ne,Ie,Ee,Me,u,Z);if(Qn(Ce=>!(S&&S.some(tt=>tt.route.id===Ce))||De&&De.some(tt=>tt.route.id===Ce)),ye=++ue,De.length===0&&He.length===0){let Ce=Ir();return Et(O,It({matches:S,loaderData:{},errors:Z&&fr(Z[1])?{[Z[0]]:Z[1].error}:null},b_(Z),Ce?{fetchers:new Map(v.fetchers)}:{}),{flushSync:se}),{shortCircuited:!0}}if(qe){let Ce={};if(!M){Ce.navigation=ge;let tt=Pn(Z);tt!==void 0&&(Ce.actionData=tt)}He.length>0&&(Ce.fetchers=xn(He)),Ue(Ce,{flushSync:se})}He.forEach(Ce=>{Gt(Ce.key),Ce.controller&&G.set(Ce.key,Ce.controller)});let pt=()=>He.forEach(Ce=>Gt(Ce.key));I&&I.signal.addEventListener("abort",pt);let{loaderResults:Lt,fetcherResults:dt}=await Pe(v,S,De,He,b);if(b.signal.aborted)return{shortCircuited:!0};I&&I.signal.removeEventListener("abort",pt),He.forEach(Ce=>G.delete(Ce.key));let Rt=ad(Lt);if(Rt)return await me(b,Rt.result,!0,{replace:te}),{shortCircuited:!0};if(Rt=ad(dt),Rt)return Ee.add(Rt.key),await me(b,Rt.result,!0,{replace:te}),{shortCircuited:!0};let{loaderData:Ps,errors:Rr}=N_(v,S,Lt,Z,He,dt,Xe);Xe.forEach((Ce,tt)=>{Ce.subscribe(bn=>{(bn||Ce.done)&&Xe.delete(tt)})}),f.v7_partialHydration&&ie&&v.errors&&(Rr=It({},v.errors,Rr));let fn=Ir(),rn=kn(ye),ss=fn||rn||He.length>0;return It({matches:S,loaderData:Ps,errors:Rr},ss?{fetchers:new Map(v.fetchers)}:{})}function Pn(b){if(b&&!fr(b[1]))return{[b[0]]:b[1].data};if(v.actionData)return Object.keys(v.actionData).length===0?null:v.actionData}function xn(b){return b.forEach(O=>{let S=v.fetchers.get(O.key),M=Jl(void 0,S?S.data:void 0);v.fetchers.set(O.key,M)}),new Map(v.fetchers)}function hn(b,O,S,M){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Gt(b);let B=(M&&M.flushSync)===!0,Q=l||o,ae=vm(v.location,v.matches,u,f.v7_prependBasename,S,f.v7_relativeSplatPath,O,M==null?void 0:M.relative),te=Mo(Q,ae,u),ie=lr(te,Q,ae);if(ie.active&&ie.matches&&(te=ie.matches),!te){Nt(b,O,Xn(404,{pathname:ae}),{flushSync:B});return}let{path:se,submission:Z,error:ge}=I_(f.v7_normalizeFormMethod,!0,ae,M);if(ge){Nt(b,O,ge,{flushSync:B});return}let ve=su(te,se),qe=(M&&M.preventScrollReset)===!0;if(Z&&Wr(Z.formMethod)){Y(b,O,se,ve,te,ie.active,B,qe,Z);return}Ie.set(b,{routeId:O,path:se}),fe(b,O,se,ve,te,ie.active,B,qe,Z)}async function Y(b,O,S,M,B,Q,ae,te,ie){Ye(),Ie.delete(b);function se(je){if(!je.route.action&&!je.route.lazy){let ur=Xn(405,{method:ie.formMethod,pathname:S,routeId:O});return Nt(b,O,ur,{flushSync:ae}),!0}return!1}if(!Q&&se(M))return;let Z=v.fetchers.get(b);et(b,vP(ie,Z),{flushSync:ae});let ge=new AbortController,ve=Ea(t.history,S,ge.signal,ie);if(Q){let je=await wn(B,new URL(ve.url).pathname,ve.signal,b);if(je.type==="aborted")return;if(je.type==="error"){Nt(b,O,je.error,{flushSync:ae});return}else if(je.matches){if(B=je.matches,M=su(B,S),se(M))return}else{Nt(b,O,Xn(404,{pathname:S}),{flushSync:ae});return}}G.set(b,ge);let qe=ue,De=(await Be("action",v,ve,[M],B,b))[M.route.id];if(ve.signal.aborted){G.get(b)===ge&&G.delete(b);return}if(f.v7_fetcherPersist&&Ne.has(b)){if($o(De)||fr(De)){et(b,Ti(void 0));return}}else{if($o(De))if(G.delete(b),ye>qe){et(b,Ti(void 0));return}else return Ee.add(b),et(b,Jl(ie)),me(ve,De,!1,{fetcherSubmission:ie,preventScrollReset:te});if(fr(De)){Nt(b,O,De.error);return}}if(Oi(De))throw Xn(400,{type:"defer-action"});let He=v.navigation.location||v.location,pt=Ea(t.history,He,ge.signal),Lt=l||o,dt=v.navigation.state!=="idle"?Mo(Lt,v.navigation.location,u):v.matches;Le(dt,"Didn't find any matches after fetcher action");let Rt=++ue;Se.set(b,Rt);let Ps=Jl(ie,De.data);v.fetchers.set(b,Ps);let[Rr,fn]=R_(t.history,v,dt,ie,He,!1,f.v7_skipActionErrorRevalidation,ke,wt,gt,Ne,Ie,Ee,Lt,u,[M.route.id,De]);fn.filter(je=>je.key!==b).forEach(je=>{let ur=je.key,li=v.fetchers.get(ur),yo=Jl(void 0,li?li.data:void 0);v.fetchers.set(ur,yo),Gt(ur),je.controller&&G.set(ur,je.controller)}),Ue({fetchers:new Map(v.fetchers)});let rn=()=>fn.forEach(je=>Gt(je.key));ge.signal.addEventListener("abort",rn);let{loaderResults:ss,fetcherResults:Ce}=await Pe(v,dt,Rr,fn,pt);if(ge.signal.aborted)return;ge.signal.removeEventListener("abort",rn),Se.delete(b),G.delete(b),fn.forEach(je=>G.delete(je.key));let tt=ad(ss);if(tt)return me(pt,tt.result,!1,{preventScrollReset:te});if(tt=ad(Ce),tt)return Ee.add(tt.key),me(pt,tt.result,!1,{preventScrollReset:te});let{loaderData:bn,errors:is}=N_(v,dt,ss,void 0,fn,Ce,Xe);if(v.fetchers.has(b)){let je=Ti(De.data);v.fetchers.set(b,je)}kn(Rt),v.navigation.state==="loading"&&Rt>ye?(Le(m,"Expected pending action"),I&&I.abort(),Et(v.navigation.location,{matches:dt,loaderData:bn,errors:is,fetchers:new Map(v.fetchers)})):(Ue({errors:is,loaderData:D_(v.loaderData,bn,dt,is),fetchers:new Map(v.fetchers)}),ke=!1)}async function fe(b,O,S,M,B,Q,ae,te,ie){let se=v.fetchers.get(b);et(b,Jl(ie,se?se.data:void 0),{flushSync:ae});let Z=new AbortController,ge=Ea(t.history,S,Z.signal);if(Q){let De=await wn(B,new URL(ge.url).pathname,ge.signal,b);if(De.type==="aborted")return;if(De.type==="error"){Nt(b,O,De.error,{flushSync:ae});return}else if(De.matches)B=De.matches,M=su(B,S);else{Nt(b,O,Xn(404,{pathname:S}),{flushSync:ae});return}}G.set(b,Z);let ve=ue,Me=(await Be("loader",v,ge,[M],B,b))[M.route.id];if(Oi(Me)&&(Me=await qg(Me,ge.signal,!0)||Me),G.get(b)===Z&&G.delete(b),!ge.signal.aborted){if(Ne.has(b)){et(b,Ti(void 0));return}if($o(Me))if(ye>ve){et(b,Ti(void 0));return}else{Ee.add(b),await me(ge,Me,!1,{preventScrollReset:te});return}if(fr(Me)){Nt(b,O,Me.error);return}Le(!Oi(Me),"Unhandled fetcher deferred data"),et(b,Ti(Me.data))}}async function me(b,O,S,M){let{submission:B,fetcherSubmission:Q,preventScrollReset:ae,replace:te}=M===void 0?{}:M;O.response.headers.has("X-Remix-Revalidate")&&(ke=!0);let ie=O.response.headers.get("Location");Le(ie,"Expected a Location header on the redirect Response"),ie=x_(ie,new URL(b.url),u);let se=Wu(v.location,ie,{_isRedirect:!0});if(n){let De=!1;if(O.response.headers.has("X-Remix-Reload-Document"))De=!0;else if(zg.test(ie)){const He=t.history.createURL(ie);De=He.origin!==e.location.origin||Xs(He.pathname,u)==null}if(De){te?e.location.replace(ie):e.location.assign(ie);return}}I=null;let Z=te===!0||O.response.headers.has("X-Remix-Replace")?Xt.Replace:Xt.Push,{formMethod:ge,formAction:ve,formEncType:qe}=v.navigation;!B&&!Q&&ge&&ve&&qe&&(B=V_(v.navigation));let Me=B||Q;if(XC.has(O.response.status)&&Me&&Wr(Me.formMethod))await Wt(Z,se,{submission:It({},Me,{formAction:ie}),preventScrollReset:ae||A,enableViewTransition:S?N:void 0});else{let De=dp(se,B);await Wt(Z,se,{overrideNavigation:De,fetcherSubmission:Q,preventScrollReset:ae||A,enableViewTransition:S?N:void 0})}}async function Be(b,O,S,M,B,Q){let ae,te={};try{ae=await oP(c,b,O,S,M,B,Q,i,s)}catch(ie){return M.forEach(se=>{te[se.route.id]={type:lt.error,error:ie}}),te}for(let[ie,se]of Object.entries(ae))if(hP(se)){let Z=se.result;te[ie]={type:lt.redirect,response:uP(Z,S,ie,B,u,f.v7_relativeSplatPath)}}else te[ie]=await lP(se);return te}async function Pe(b,O,S,M,B){let Q=b.matches,ae=Be("loader",b,B,S,O,null),te=Promise.all(M.map(async Z=>{if(Z.matches&&Z.match&&Z.controller){let ve=(await Be("loader",b,Ea(t.history,Z.path,Z.controller.signal),[Z.match],Z.matches,Z.key))[Z.match.route.id];return{[Z.key]:ve}}else return Promise.resolve({[Z.key]:{type:lt.error,error:Xn(404,{pathname:Z.path})}})})),ie=await ae,se=(await te).reduce((Z,ge)=>Object.assign(Z,ge),{});return await Promise.all([mP(O,ie,B.signal,Q,b.loaderData),gP(O,se,M)]),{loaderResults:ie,fetcherResults:se}}function Ye(){ke=!0,wt.push(...Qn()),Ie.forEach((b,O)=>{G.has(O)&&gt.add(O),Gt(O)})}function et(b,O,S){S===void 0&&(S={}),v.fetchers.set(b,O),Ue({fetchers:new Map(v.fetchers)},{flushSync:(S&&S.flushSync)===!0})}function Nt(b,O,S,M){M===void 0&&(M={});let B=jo(v.matches,O);ir(b),Ue({errors:{[B.route.id]:S},fetchers:new Map(v.fetchers)},{flushSync:(M&&M.flushSync)===!0})}function Kt(b){return be.set(b,(be.get(b)||0)+1),Ne.has(b)&&Ne.delete(b),v.fetchers.get(b)||ZC}function ir(b){let O=v.fetchers.get(b);G.has(b)&&!(O&&O.state==="loading"&&Se.has(b))&&Gt(b),Ie.delete(b),Se.delete(b),Ee.delete(b),f.v7_fetcherPersist&&Ne.delete(b),gt.delete(b),v.fetchers.delete(b)}function Dt(b){let O=(be.get(b)||0)-1;O<=0?(be.delete(b),Ne.add(b),f.v7_fetcherPersist||ir(b)):be.set(b,O),Ue({fetchers:new Map(v.fetchers)})}function Gt(b){let O=G.get(b);O&&(O.abort(),G.delete(b))}function or(b){for(let O of b){let S=Kt(O),M=Ti(S.data);v.fetchers.set(O,M)}}function Ir(){let b=[],O=!1;for(let S of Ee){let M=v.fetchers.get(S);Le(M,"Expected fetcher: "+S),M.state==="loading"&&(Ee.delete(S),b.push(S),O=!0)}return or(b),O}function kn(b){let O=[];for(let[S,M]of Se)if(M<b){let B=v.fetchers.get(S);Le(B,"Expected fetcher: "+S),B.state==="loading"&&(Gt(S),Se.delete(S),O.push(S))}return or(O),O.length>0}function rs(b,O){let S=v.blockers.get(b)||Yl;return Qe.get(b)!==O&&Qe.set(b,O),S}function Nn(b){v.blockers.delete(b),Qe.delete(b)}function ft(b,O){let S=v.blockers.get(b)||Yl;Le(S.state==="unblocked"&&O.state==="blocked"||S.state==="blocked"&&O.state==="blocked"||S.state==="blocked"&&O.state==="proceeding"||S.state==="blocked"&&O.state==="unblocked"||S.state==="proceeding"&&O.state==="unblocked","Invalid blocker state transition: "+S.state+" -> "+O.state);let M=new Map(v.blockers);M.set(b,O),Ue({blockers:M})}function Qt(b){let{currentLocation:O,nextLocation:S,historyAction:M}=b;if(Qe.size===0)return;Qe.size>1&&dl(!1,"A router only supports one blocker at a time");let B=Array.from(Qe.entries()),[Q,ae]=B[B.length-1],te=v.blockers.get(Q);if(!(te&&te.state==="proceeding")&&ae({currentLocation:O,nextLocation:S,historyAction:M}))return Q}function Tt(b){let O=Xn(404,{pathname:b}),S=l||o,{matches:M,route:B}=L_(S);return Qn(),{notFoundMatches:M,route:B,error:O}}function Qn(b){let O=[];return Xe.forEach((S,M)=>{(!b||b(M))&&(S.cancel(),O.push(M),Xe.delete(M))}),O}function Ar(b,O,S){if(R=b,V=O,D=S||null,!P&&v.navigation===cp){P=!0;let M=Mr(v.location,v.matches);M!=null&&Ue({restoreScrollPosition:M})}return()=>{R=null,V=null,D=null}}function Dn(b,O){return D&&D(b,O.map(M=>kC(M,v.loaderData)))||b.key}function ar(b,O){if(R&&V){let S=Dn(b,O);R[S]=V()}}function Mr(b,O){if(R){let S=Dn(b,O),M=R[S];if(typeof M=="number")return M}return null}function lr(b,O,S){if(h)if(b){if(Object.keys(b[0].params).length>0)return{active:!0,matches:xd(O,S,u,!0)}}else return{active:!0,matches:xd(O,S,u,!0)||[]};return{active:!1,matches:null}}async function wn(b,O,S,M){if(!h)return{type:"success",matches:b};let B=b;for(;;){let Q=l==null,ae=l||o,te=i;try{await h({signal:S,path:O,matches:B,fetcherKey:M,patch:(Z,ge)=>{S.aborted||P_(Z,ge,ae,te,s)}})}catch(Z){return{type:"error",error:Z,partialMatches:B}}finally{Q&&!S.aborted&&(o=[...o])}if(S.aborted)return{type:"aborted"};let ie=Mo(ae,O,u);if(ie)return{type:"success",matches:ie};let se=xd(ae,O,u,!0);if(!se||B.length===se.length&&B.every((Z,ge)=>Z.route.id===se[ge].route.id))return{type:"success",matches:null};B=se}}function Cs(b){i={},l=dh(b,s,void 0,i)}function bt(b,O){let S=l==null;P_(b,O,l||o,i,s),S&&(o=[...o],Ue({}))}return W={get basename(){return u},get future(){return f},get state(){return v},get routes(){return o},get window(){return e},initialize:Tr,subscribe:jt,enableScrollRestoration:Ar,navigate:nn,fetch:hn,revalidate:Ht,createHref:b=>t.history.createHref(b),encodeLocation:b=>t.history.encodeLocation(b),getFetcher:Kt,deleteFetcher:Dt,dispose:qt,getBlocker:rs,deleteBlocker:Nn,patchRoutes:bt,_internalFetchControllers:G,_internalActiveDeferreds:Xe,_internalSetRoutes:Cs},W}function nP(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function vm(t,e,n,r,s,i,o,l){let u,c;if(o){u=[];for(let f of e)if(u.push(f),f.route.id===o){c=f;break}}else u=e,c=e[e.length-1];let h=ef(s||".",Zh(u,i),Xs(t.pathname,n)||t.pathname,l==="path");if(s==null&&(h.search=t.search,h.hash=t.hash),(s==null||s===""||s===".")&&c){let f=Hg(h.search);if(c.route.index&&!f)h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&f){let y=new URLSearchParams(h.search),T=y.getAll("index");y.delete("index"),T.filter(D=>D).forEach(D=>y.append("index",D));let R=y.toString();h.search=R?"?"+R:""}}return r&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Ks([n,h.pathname])),Xo(h)}function I_(t,e,n,r){if(!r||!nP(r))return{path:n};if(r.formMethod&&!pP(r.formMethod))return{path:n,error:Xn(405,{method:r.formMethod})};let s=()=>({path:n,error:Xn(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=GT(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Wr(o))return s();let y=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((T,R)=>{let[D,V]=R;return""+T+D+"="+V+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:y}}}else if(r.formEncType==="application/json"){if(!Wr(o))return s();try{let y=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:y,text:void 0}}}catch{return s()}}}Le(typeof FormData=="function","FormData is not available in this environment");let u,c;if(r.formData)u=wm(r.formData),c=r.formData;else if(r.body instanceof FormData)u=wm(r.body),c=r.body;else if(r.body instanceof URLSearchParams)u=r.body,c=k_(u);else if(r.body==null)u=new URLSearchParams,c=new FormData;else try{u=new URLSearchParams(r.body),c=k_(u)}catch{return s()}let h={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Wr(h.formMethod))return{path:n,submission:h};let f=ho(n);return e&&f.search&&Hg(f.search)&&u.append("index",""),f.search="?"+u,{path:Xo(f),submission:h}}function A_(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function R_(t,e,n,r,s,i,o,l,u,c,h,f,y,T,R,D){let V=D?fr(D[1])?D[1].error:D[1].data:void 0,P=t.createURL(e.location),_=t.createURL(s),x=n;i&&e.errors?x=A_(n,Object.keys(e.errors)[0],!0):D&&fr(D[1])&&(x=A_(n,D[0]));let j=D?D[1].statusCode:void 0,q=o&&j&&j>=400,W=x.filter((m,A)=>{let{route:I}=m;if(I.lazy)return!0;if(I.loader==null)return!1;if(i)return _m(I,e.loaderData,e.errors);if(rP(e.loaderData,e.matches[A],m)||u.some(k=>k===m.route.id))return!0;let N=e.matches[A],L=m;return C_(m,It({currentUrl:P,currentParams:N.params,nextUrl:_,nextParams:L.params},r,{actionResult:V,actionStatus:j,defaultShouldRevalidate:q?!1:l||P.pathname+P.search===_.pathname+_.search||P.search!==_.search||WT(N,L)}))}),v=[];return f.forEach((m,A)=>{if(i||!n.some(de=>de.route.id===m.routeId)||h.has(A))return;let I=Mo(T,m.path,R);if(!I){v.push({key:A,routeId:m.routeId,path:m.path,matches:null,match:null,controller:null});return}let N=e.fetchers.get(A),L=su(I,m.path),k=!1;y.has(A)?k=!1:c.has(A)?(c.delete(A),k=!0):N&&N.state!=="idle"&&N.data===void 0?k=l:k=C_(L,It({currentUrl:P,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:V,actionStatus:j,defaultShouldRevalidate:q?!1:l})),k&&v.push({key:A,routeId:m.routeId,path:m.path,matches:I,match:L,controller:new AbortController})}),[W,v]}function _m(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function rP(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function WT(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function C_(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function P_(t,e,n,r,s){var i;let o;if(t){let c=r[t];Le(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),o=c.children}else o=n;let l=e.filter(c=>!o.some(h=>KT(c,h))),u=dh(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...u)}function KT(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>KT(n,i))}):!1}async function sP(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Le(s,"No route found in manifest");let i={};for(let o in r){let u=s[o]!==void 0&&o!=="hasErrorBoundary";dl(!u,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!u&&!PC.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,It({},e(s),{lazy:void 0}))}async function iP(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function oP(t,e,n,r,s,i,o,l,u,c){let h=i.map(T=>T.route.lazy?sP(T.route,u,l):void 0),f=i.map((T,R)=>{let D=h[R],V=s.some(_=>_.route.id===T.route.id);return It({},T,{shouldLoad:V,resolve:async _=>(_&&r.method==="GET"&&(T.route.lazy||T.route.loader)&&(V=!0),V?aP(e,r,T,D,_,c):Promise.resolve({type:lt.data,result:void 0}))})}),y=await t({matches:f,request:r,params:i[0].params,fetcherKey:o,context:c});try{await Promise.all(h)}catch{}return y}async function aP(t,e,n,r,s,i){let o,l,u=c=>{let h,f=new Promise((R,D)=>h=D);l=()=>h(),e.signal.addEventListener("abort",l);let y=R=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):c({request:e,params:n.params,context:i},...R!==void 0?[R]:[]),T=(async()=>{try{return{type:"data",result:await(s?s(D=>y(D)):y())}}catch(R){return{type:"error",result:R}}})();return Promise.race([T,f])};try{let c=n.route[t];if(r)if(c){let h,[f]=await Promise.all([u(c).catch(y=>{h=y}),r]);if(h!==void 0)throw h;o=f}else if(await r,c=n.route[t],c)o=await u(c);else if(t==="action"){let h=new URL(e.url),f=h.pathname+h.search;throw Xn(405,{method:e.method,pathname:f,routeId:n.route.id})}else return{type:lt.data,result:void 0};else if(c)o=await u(c);else{let h=new URL(e.url),f=h.pathname+h.search;throw Xn(404,{pathname:f})}Le(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:lt.error,result:c}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function lP(t){let{result:e,type:n}=t;if(QT(e)){let f;try{let y=e.headers.get("Content-Type");y&&/\bapplication\/json\b/.test(y)?e.body==null?f=null:f=await e.json():f=await e.text()}catch(y){return{type:lt.error,error:y}}return n===lt.error?{type:lt.error,error:new fh(e.status,e.statusText,f),statusCode:e.status,headers:e.headers}:{type:lt.data,data:f,statusCode:e.status,headers:e.headers}}if(n===lt.error){if(O_(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:lt.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:lt.error,error:new fh(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Ku(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:lt.error,error:e,statusCode:Ku(e)?e.status:void 0}}if(fP(e)){var l,u;return{type:lt.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((u=e.init)==null?void 0:u.headers)&&new Headers(e.init.headers)}}if(O_(e)){var c,h;return{type:lt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(h=e.init)!=null&&h.headers?new Headers(e.init.headers):void 0}}return{type:lt.data,data:e}}function uP(t,e,n,r,s,i){let o=t.headers.get("Location");if(Le(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!zg.test(o)){let l=r.slice(0,r.findIndex(u=>u.route.id===n)+1);o=vm(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function x_(t,e,n){if(zg.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Xs(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Ea(t,e,n,r){let s=t.createURL(GT(e)).toString(),i={signal:n};if(r&&Wr(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=wm(r.formData):i.body=r.formData}return new Request(s,i)}function wm(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function k_(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function cP(t,e,n,r,s){let i={},o=null,l,u=!1,c={},h=n&&fr(n[1])?n[1].error:void 0;return t.forEach(f=>{if(!(f.route.id in e))return;let y=f.route.id,T=e[y];if(Le(!$o(T),"Cannot handle redirect results in processLoaderData"),fr(T)){let R=T.error;h!==void 0&&(R=h,h=void 0),o=o||{};{let D=jo(t,y);o[D.route.id]==null&&(o[D.route.id]=R)}i[y]=void 0,u||(u=!0,l=Ku(T.error)?T.error.status:500),T.headers&&(c[y]=T.headers)}else Oi(T)?(r.set(y,T.deferredData),i[y]=T.deferredData.data,T.statusCode!=null&&T.statusCode!==200&&!u&&(l=T.statusCode),T.headers&&(c[y]=T.headers)):(i[y]=T.data,T.statusCode&&T.statusCode!==200&&!u&&(l=T.statusCode),T.headers&&(c[y]=T.headers))}),h!==void 0&&n&&(o={[n[0]]:h},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:c}}function N_(t,e,n,r,s,i,o){let{loaderData:l,errors:u}=cP(e,n,r,o);return s.forEach(c=>{let{key:h,match:f,controller:y}=c,T=i[h];if(Le(T,"Did not find corresponding fetcher result"),!(y&&y.signal.aborted))if(fr(T)){let R=jo(t.matches,f==null?void 0:f.route.id);u&&u[R.route.id]||(u=It({},u,{[R.route.id]:T.error})),t.fetchers.delete(h)}else if($o(T))Le(!1,"Unhandled fetcher revalidation redirect");else if(Oi(T))Le(!1,"Unhandled fetcher deferred data");else{let R=Ti(T.data);t.fetchers.set(h,R)}}),{loaderData:l,errors:u}}function D_(t,e,n,r){let s=It({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function b_(t){return t?fr(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function jo(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function L_(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Xn(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",u="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?u="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?u="defer() is not supported in actions":i==="invalid-body"&&(u="Unable to encode submission body")):t===403?(l="Forbidden",u='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",u='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?u="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(u='Invalid request method "'+s.toUpperCase()+'"')),new fh(t||500,l,new Error(u),!0)}function ad(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if($o(s))return{key:r,result:s}}}function GT(t){let e=typeof t=="string"?ho(t):t;return Xo(It({},e,{hash:""}))}function dP(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function hP(t){return QT(t.result)&&JC.has(t.result.status)}function Oi(t){return t.type===lt.deferred}function fr(t){return t.type===lt.error}function $o(t){return(t&&t.type)===lt.redirect}function O_(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function fP(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function QT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function pP(t){return YC.has(t.toLowerCase())}function Wr(t){return GC.has(t.toLowerCase())}async function mP(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,u]=i[o],c=t.find(y=>(y==null?void 0:y.route.id)===l);if(!c)continue;let h=r.find(y=>y.route.id===c.route.id),f=h!=null&&!WT(h,c)&&(s&&s[c.route.id])!==void 0;Oi(u)&&f&&await qg(u,n,!1).then(y=>{y&&(e[l]=y)})}}async function gP(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(c=>(c==null?void 0:c.route.id)===i)&&Oi(l)&&(Le(o,"Expected an AbortController for revalidating fetcher deferred result"),await qg(l,o.signal,!0).then(c=>{c&&(e[s]=c)}))}}async function qg(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:lt.data,data:t.deferredData.unwrappedData}}catch(s){return{type:lt.error,error:s}}return{type:lt.data,data:t.deferredData.data}}}function Hg(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function su(t,e){let n=typeof e=="string"?ho(e).search:e.search;if(t[t.length-1].route.index&&Hg(n||""))return t[t.length-1];let r=zT(t);return r[r.length-1]}function V_(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function dp(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function yP(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Jl(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function vP(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Ti(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function _P(t,e){try{let n=t.sessionStorage.getItem(HT);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function wP(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(HT,JSON.stringify(n))}catch(r){dl(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ph(){return ph=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ph.apply(this,arguments)}const dc=C.createContext(null),Wg=C.createContext(null),si=C.createContext(null),Kg=C.createContext(null),ii=C.createContext({outlet:null,matches:[],isDataRoute:!1}),YT=C.createContext(null);function EP(t,e){let{relative:n}=e===void 0?{}:e;Sl()||Le(!1);let{basename:r,navigator:s}=C.useContext(si),{hash:i,pathname:o,search:l}=tf(t,{relative:n}),u=o;return r!=="/"&&(u=o==="/"?r:Ks([r,o])),s.createHref({pathname:u,search:l,hash:i})}function Sl(){return C.useContext(Kg)!=null}function aa(){return Sl()||Le(!1),C.useContext(Kg).location}function JT(t){C.useContext(si).static||C.useLayoutEffect(t)}function oi(){let{isDataRoute:t}=C.useContext(ii);return t?LP():TP()}function TP(){Sl()||Le(!1);let t=C.useContext(dc),{basename:e,future:n,navigator:r}=C.useContext(si),{matches:s}=C.useContext(ii),{pathname:i}=aa(),o=JSON.stringify(Zh(s,n.v7_relativeSplatPath)),l=C.useRef(!1);return JT(()=>{l.current=!0}),C.useCallback(function(c,h){if(h===void 0&&(h={}),!l.current)return;if(typeof c=="number"){r.go(c);return}let f=ef(c,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Ks([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,i,t])}function SP(){let{matches:t}=C.useContext(ii),e=t[t.length-1];return e?e.params:{}}function tf(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=C.useContext(si),{matches:s}=C.useContext(ii),{pathname:i}=aa(),o=JSON.stringify(Zh(s,r.v7_relativeSplatPath));return C.useMemo(()=>ef(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function IP(t,e,n,r){Sl()||Le(!1);let{navigator:s}=C.useContext(si),{matches:i}=C.useContext(ii),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let c=aa(),h;h=c;let f=h.pathname||"/",y=f;if(u!=="/"){let D=u.replace(/^\//,"").split("/");y="/"+f.replace(/^\//,"").split("/").slice(D.length).join("/")}let T=Mo(t,{pathname:y});return xP(T&&T.map(D=>Object.assign({},D,{params:Object.assign({},l,D.params),pathname:Ks([u,s.encodeLocation?s.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?u:Ks([u,s.encodeLocation?s.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),i,n,r)}function AP(){let t=bP(),e=Ku(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:s},n):null,null)}const RP=C.createElement(AP,null);class CP extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(ii.Provider,{value:this.props.routeContext},C.createElement(YT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PP(t){let{routeContext:e,match:n,children:r}=t,s=C.useContext(dc);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(ii.Provider,{value:e},r)}function xP(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||Le(!1),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:y,errors:T}=n,R=f.route.loader&&y[f.route.id]===void 0&&(!T||T[f.route.id]===void 0);if(f.route.lazy||R){u=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((h,f,y)=>{let T,R=!1,D=null,V=null;n&&(T=l&&f.route.id?l[f.route.id]:void 0,D=f.route.errorElement||RP,u&&(c<0&&y===0?(OP("route-fallback"),R=!0,V=null):c===y&&(R=!0,V=f.route.hydrateFallbackElement||null)));let P=e.concat(o.slice(0,y+1)),_=()=>{let x;return T?x=D:R?x=V:f.route.Component?x=C.createElement(f.route.Component,null):f.route.element?x=f.route.element:x=h,C.createElement(PP,{match:f,routeContext:{outlet:h,matches:P,isDataRoute:n!=null},children:x})};return n&&(f.route.ErrorBoundary||f.route.errorElement||y===0)?C.createElement(CP,{location:n.location,revalidation:n.revalidation,component:D,error:T,children:_(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):_()},null)}var XT=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(XT||{}),ZT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ZT||{});function kP(t){let e=C.useContext(dc);return e||Le(!1),e}function NP(t){let e=C.useContext(Wg);return e||Le(!1),e}function DP(t){let e=C.useContext(ii);return e||Le(!1),e}function eS(t){let e=DP(),n=e.matches[e.matches.length-1];return n.route.id||Le(!1),n.route.id}function bP(){var t;let e=C.useContext(YT),n=NP(ZT.UseRouteError),r=eS();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function LP(){let{router:t}=kP(XT.UseNavigateStable),e=eS(),n=C.useRef(!1);return JT(()=>{n.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ph({fromRouteId:e},i)))},[t,e])}const M_={};function OP(t,e,n){M_[t]||(M_[t]=!0)}function VP(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function tS(t){let{to:e,replace:n,state:r,relative:s}=t;Sl()||Le(!1);let{future:i,static:o}=C.useContext(si),{matches:l}=C.useContext(ii),{pathname:u}=aa(),c=oi(),h=ef(e,Zh(l,i.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(h);return C.useEffect(()=>c(JSON.parse(f),{replace:n,state:r,relative:s}),[c,f,s,n,r]),null}function MP(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Xt.Pop,navigator:i,static:o=!1,future:l}=t;Sl()&&Le(!1);let u=e.replace(/^\/*/,"/"),c=C.useMemo(()=>({basename:u,navigator:i,static:o,future:ph({v7_relativeSplatPath:!1},l)}),[u,l,i,o]);typeof r=="string"&&(r=ho(r));let{pathname:h="/",search:f="",hash:y="",state:T=null,key:R="default"}=r,D=C.useMemo(()=>{let V=Xs(h,u);return V==null?null:{location:{pathname:V,search:f,hash:y,state:T,key:R},navigationType:s}},[u,h,f,y,T,R,s]);return D==null?null:C.createElement(si.Provider,{value:c},C.createElement(Kg.Provider,{children:n,value:D}))}new Promise(()=>{});function jP(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:C.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:C.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:C.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hl(){return hl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hl.apply(this,arguments)}function nS(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function FP(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function UP(t,e){return t.button===0&&(!e||e==="_self")&&!FP(t)}function Em(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function BP(t,e){let n=Em(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const $P=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zP=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],qP="6";try{window.__reactRouterVersion=qP}catch{}function HP(t,e){return tP({basename:void 0,future:hl({},void 0,{v7_prependBasename:!0}),history:AC({window:void 0}),hydrationData:WP(),routes:t,mapRouteProperties:jP,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function WP(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=hl({},e,{errors:KP(e.errors)})),e}function KP(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new fh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const rS=C.createContext({isTransitioning:!1}),GP=C.createContext(new Map),QP="startTransition",j_=h1[QP],YP="flushSync",F_=IC[YP];function JP(t){j_?j_(t):t()}function Xl(t){F_?F_(t):t()}let XP=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function ZP(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=C.useState(n.state),[o,l]=C.useState(),[u,c]=C.useState({isTransitioning:!1}),[h,f]=C.useState(),[y,T]=C.useState(),[R,D]=C.useState(),V=C.useRef(new Map),{v7_startTransition:P}=r||{},_=C.useCallback(m=>{P?JP(m):m()},[P]),x=C.useCallback((m,A)=>{let{deletedFetchers:I,flushSync:N,viewTransitionOpts:L}=A;m.fetchers.forEach((de,ke)=>{de.data!==void 0&&V.current.set(ke,de.data)}),I.forEach(de=>V.current.delete(de));let k=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!L||k){N?Xl(()=>i(m)):_(()=>i(m));return}if(N){Xl(()=>{y&&(h&&h.resolve(),y.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:L.currentLocation,nextLocation:L.nextLocation})});let de=n.window.document.startViewTransition(()=>{Xl(()=>i(m))});de.finished.finally(()=>{Xl(()=>{f(void 0),T(void 0),l(void 0),c({isTransitioning:!1})})}),Xl(()=>T(de));return}y?(h&&h.resolve(),y.skipTransition(),D({state:m,currentLocation:L.currentLocation,nextLocation:L.nextLocation})):(l(m),c({isTransitioning:!0,flushSync:!1,currentLocation:L.currentLocation,nextLocation:L.nextLocation}))},[n.window,y,h,V,_]);C.useLayoutEffect(()=>n.subscribe(x),[n,x]),C.useEffect(()=>{u.isTransitioning&&!u.flushSync&&f(new XP)},[u]),C.useEffect(()=>{if(h&&o&&n.window){let m=o,A=h.promise,I=n.window.document.startViewTransition(async()=>{_(()=>i(m)),await A});I.finished.finally(()=>{f(void 0),T(void 0),l(void 0),c({isTransitioning:!1})}),T(I)}},[_,o,h,n.window]),C.useEffect(()=>{h&&o&&s.location.key===o.location.key&&h.resolve()},[h,y,s.location,o]),C.useEffect(()=>{!u.isTransitioning&&R&&(l(R.state),c({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}),D(void 0))},[u.isTransitioning,R]),C.useEffect(()=>{},[]);let j=C.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:m=>n.navigate(m),push:(m,A,I)=>n.navigate(m,{state:A,preventScrollReset:I==null?void 0:I.preventScrollReset}),replace:(m,A,I)=>n.navigate(m,{replace:!0,state:A,preventScrollReset:I==null?void 0:I.preventScrollReset})}),[n]),q=n.basename||"/",W=C.useMemo(()=>({router:n,navigator:j,static:!1,basename:q}),[n,j,q]),v=C.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return C.useEffect(()=>VP(r,n.future),[r,n.future]),C.createElement(C.Fragment,null,C.createElement(dc.Provider,{value:W},C.createElement(Wg.Provider,{value:s},C.createElement(GP.Provider,{value:V.current},C.createElement(rS.Provider,{value:u},C.createElement(MP,{basename:q,location:s.location,navigationType:s.historyAction,navigator:j,future:v},s.initialized||n.future.v7_partialHydration?C.createElement(ex,{routes:n.routes,future:n.future,state:s}):e))))),null)}const ex=C.memo(tx);function tx(t){let{routes:e,future:n,state:r}=t;return IP(e,void 0,r,n)}const nx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mh=C.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:u,to:c,preventScrollReset:h,viewTransition:f}=e,y=nS(e,$P),{basename:T}=C.useContext(si),R,D=!1;if(typeof c=="string"&&rx.test(c)&&(R=c,nx))try{let x=new URL(window.location.href),j=c.startsWith("//")?new URL(x.protocol+c):new URL(c),q=Xs(j.pathname,T);j.origin===x.origin&&q!=null?c=q+j.search+j.hash:D=!0}catch{}let V=EP(c,{relative:s}),P=ix(c,{replace:o,state:l,target:u,preventScrollReset:h,relative:s,viewTransition:f});function _(x){r&&r(x),x.defaultPrevented||P(x)}return C.createElement("a",hl({},y,{href:R||V,onClick:D||i?r:_,ref:n,target:u}))}),U_=C.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:u,viewTransition:c,children:h}=e,f=nS(e,zP),y=tf(u,{relative:f.relative}),T=aa(),R=C.useContext(Wg),{navigator:D,basename:V}=C.useContext(si),P=R!=null&&ox(y)&&c===!0,_=D.encodeLocation?D.encodeLocation(y).pathname:y.pathname,x=T.pathname,j=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;s||(x=x.toLowerCase(),j=j?j.toLowerCase():null,_=_.toLowerCase()),j&&V&&(j=Xs(j,V)||j);const q=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let W=x===_||!o&&x.startsWith(_)&&x.charAt(q)==="/",v=j!=null&&(j===_||!o&&j.startsWith(_)&&j.charAt(_.length)==="/"),m={isActive:W,isPending:v,isTransitioning:P},A=W?r:void 0,I;typeof i=="function"?I=i(m):I=[i,W?"active":null,v?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let N=typeof l=="function"?l(m):l;return C.createElement(mh,hl({},f,{"aria-current":A,className:I,ref:n,style:N,to:u,viewTransition:c}),typeof h=="function"?h(m):h)});var Tm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Tm||(Tm={}));var B_;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(B_||(B_={}));function sx(t){let e=C.useContext(dc);return e||Le(!1),e}function ix(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,u=oi(),c=aa(),h=tf(t,{relative:o});return C.useCallback(f=>{if(UP(f,n)){f.preventDefault();let y=r!==void 0?r:Xo(c)===Xo(h);u(t,{replace:y,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[c,u,h,r,s,n,t,i,o,l])}function sS(t){let e=C.useRef(Em(t)),n=C.useRef(!1),r=aa(),s=C.useMemo(()=>BP(r.search,n.current?null:e.current),[r.search]),i=oi(),o=C.useCallback((l,u)=>{const c=Em(typeof l=="function"?l(s):l);n.current=!0,i("?"+c,u)},[i,s]);return[s,o]}function ox(t,e){e===void 0&&(e={});let n=C.useContext(rS);n==null&&Le(!1);let{basename:r}=sx(Tm.useViewTransitionState),s=tf(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Xs(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Xs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return hh(s.pathname,o)!=null||hh(s.pathname,i)!=null}const ax=()=>{};var $_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},lx=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},oS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let y=(l&15)<<2|c>>6,T=c&63;u||(T=64,o||(y=64)),r.push(n[h],n[f],n[y],n[T])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(iS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):lx(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||c==null||f==null)throw new ux;const y=i<<2|l>>4;if(r.push(y),c!==64){const T=l<<4&240|c>>2;if(r.push(T),f!==64){const R=c<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ux extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const cx=function(t){const e=iS(t);return oS.encodeByteArray(e,!0)},gh=function(t){return cx(t).replace(/\./g,"")},aS=function(t){try{return oS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=()=>dx().__FIREBASE_DEFAULTS__,fx=()=>{if(typeof process>"u"||typeof $_>"u")return;const t=$_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},px=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&aS(t[1]);return e&&JSON.parse(e)},nf=()=>{try{return ax()||hx()||fx()||px()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},lS=t=>{var e,n;return(n=(e=nf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},mx=t=>{const e=lS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},uS=()=>{var t;return(t=nf())===null||t===void 0?void 0:t.config},cS=t=>{var e;return(e=nf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dS(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[gh(JSON.stringify(n)),gh(JSON.stringify(o)),""].join(".")}const Eu={};function vx(){const t={prod:[],emulator:[]};for(const e of Object.keys(Eu))Eu[e]?t.emulator.push(e):t.prod.push(e);return t}function _x(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let z_=!1;function hS(t,e){if(typeof window>"u"||typeof document>"u"||!Il(window.location.host)||Eu[t]===e||Eu[t]||z_)return;Eu[t]=e;function n(y){return`__firebase__banner__${y}`}const r="__firebase__banner",i=vx().prod.length>0;function o(){const y=document.getElementById(r);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,T){y.setAttribute("width","24"),y.setAttribute("id",T),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function c(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{z_=!0,o()},y}function h(y,T){y.setAttribute("id",T),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function f(){const y=_x(r),T=n("text"),R=document.getElementById(T)||document.createElement("span"),D=n("learnmore"),V=document.getElementById(D)||document.createElement("a"),P=n("preprendIcon"),_=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const x=y.element;l(x),h(V,D);const j=c();u(_,P),x.append(_,R,V,j),document.body.appendChild(x)}i?(R.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wx(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bn())}function Ex(){var t;const e=(t=nf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Tx(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Sx(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ix(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ax(){const t=Bn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Rx(){return!Ex()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Cx(){try{return typeof indexedDB=="object"}catch{return!1}}function Px(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx="FirebaseError";class ai extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=xx,Object.setPrototypeOf(this,ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hc.prototype.create)}}class hc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?kx(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new ai(s,l,r)}}function kx(t,e){return t.replace(Nx,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Nx=/\{\$([^}]+)}/g;function Dx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Zo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(q_(i)&&q_(o)){if(!Zo(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function q_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function iu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ou(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function bx(t,e){const n=new Lx(t,e);return n.subscribe.bind(n)}class Lx{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Ox(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=hp),s.error===void 0&&(s.error=hp),s.complete===void 0&&(s.complete=hp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ox(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function hp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(t){return t&&t._delegate?t._delegate:t}class ea{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new gx;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jx(e))try{this.getOrInitializeService({instanceIdentifier:Vo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Vo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vo){return this.instances.has(e)}getOptions(e=Vo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Mx(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vo){return this.component?this.component.multipleInstances?e:Vo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Mx(t){return t===Vo?void 0:t}function jx(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Vx(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($e||($e={}));const Ux={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},Bx=$e.INFO,$x={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},zx=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=$x[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gg{constructor(e){this.name=e,this._logLevel=Bx,this._logHandler=zx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ux[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const qx=(t,e)=>e.some(n=>t instanceof n);let H_,W_;function Hx(){return H_||(H_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wx(){return W_||(W_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fS=new WeakMap,Sm=new WeakMap,pS=new WeakMap,fp=new WeakMap,Qg=new WeakMap;function Kx(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Wi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&fS.set(n,t)}).catch(()=>{}),Qg.set(e,t),e}function Gx(t){if(Sm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Sm.set(t,e)}let Im={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Sm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||pS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Qx(t){Im=t(Im)}function Yx(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(pp(this),e,...n);return pS.set(r,e.sort?e.sort():[e]),Wi(r)}:Wx().includes(t)?function(...e){return t.apply(pp(this),e),Wi(fS.get(this))}:function(...e){return Wi(t.apply(pp(this),e))}}function Jx(t){return typeof t=="function"?Yx(t):(t instanceof IDBTransaction&&Gx(t),qx(t,Hx())?new Proxy(t,Im):t)}function Wi(t){if(t instanceof IDBRequest)return Kx(t);if(fp.has(t))return fp.get(t);const e=Jx(t);return e!==t&&(fp.set(t,e),Qg.set(e,t)),e}const pp=t=>Qg.get(t);function Xx(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Wi(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Wi(o.result),u.oldVersion,u.newVersion,Wi(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const Zx=["get","getKey","getAll","getAllKeys","count"],ek=["put","add","delete","clear"],mp=new Map;function K_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(mp.get(e))return mp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ek.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Zx.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&u.done]))[0]};return mp.set(e,i),i}Qx(t=>({...t,get:(e,n,r)=>K_(e,n)||t.get(e,n,r),has:(e,n)=>!!K_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(nk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function nk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Am="@firebase/app",G_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=new Gg("@firebase/app"),rk="@firebase/app-compat",sk="@firebase/analytics-compat",ik="@firebase/analytics",ok="@firebase/app-check-compat",ak="@firebase/app-check",lk="@firebase/auth",uk="@firebase/auth-compat",ck="@firebase/database",dk="@firebase/data-connect",hk="@firebase/database-compat",fk="@firebase/functions",pk="@firebase/functions-compat",mk="@firebase/installations",gk="@firebase/installations-compat",yk="@firebase/messaging",vk="@firebase/messaging-compat",_k="@firebase/performance",wk="@firebase/performance-compat",Ek="@firebase/remote-config",Tk="@firebase/remote-config-compat",Sk="@firebase/storage",Ik="@firebase/storage-compat",Ak="@firebase/firestore",Rk="@firebase/ai",Ck="@firebase/firestore-compat",Pk="firebase",xk="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm="[DEFAULT]",kk={[Am]:"fire-core",[rk]:"fire-core-compat",[ik]:"fire-analytics",[sk]:"fire-analytics-compat",[ak]:"fire-app-check",[ok]:"fire-app-check-compat",[lk]:"fire-auth",[uk]:"fire-auth-compat",[ck]:"fire-rtdb",[dk]:"fire-data-connect",[hk]:"fire-rtdb-compat",[fk]:"fire-fn",[pk]:"fire-fn-compat",[mk]:"fire-iid",[gk]:"fire-iid-compat",[yk]:"fire-fcm",[vk]:"fire-fcm-compat",[_k]:"fire-perf",[wk]:"fire-perf-compat",[Ek]:"fire-rc",[Tk]:"fire-rc-compat",[Sk]:"fire-gcs",[Ik]:"fire-gcs-compat",[Ak]:"fire-fst",[Ck]:"fire-fst-compat",[Rk]:"fire-vertex","fire-js":"fire-js",[Pk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu=new Map,Nk=new Map,Cm=new Map;function Q_(t,e){try{t.container.addComponent(e)}catch(n){Zs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fl(t){const e=t.name;if(Cm.has(e))return Zs.debug(`There were multiple attempts to register component ${e}.`),!1;Cm.set(e,t);for(const n of Gu.values())Q_(n,t);for(const n of Nk.values())Q_(n,t);return!0}function Yg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Gr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ki=new hc("app","Firebase",Dk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ea("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ki.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=xk;function mS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Rm,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Ki.create("bad-app-name",{appName:String(s)});if(n||(n=uS()),!n)throw Ki.create("no-options");const i=Gu.get(s);if(i){if(Zo(n,i.options)&&Zo(r,i.config))return i;throw Ki.create("duplicate-app",{appName:s})}const o=new Fx(s);for(const u of Cm.values())o.addComponent(u);const l=new bk(n,r,o);return Gu.set(s,l),l}function gS(t=Rm){const e=Gu.get(t);if(!e&&t===Rm&&uS())return mS();if(!e)throw Ki.create("no-app",{appName:t});return e}function Lk(){return Array.from(Gu.values())}function Gi(t,e,n){var r;let s=(r=kk[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zs.warn(l.join(" "));return}fl(new ea(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok="firebase-heartbeat-database",Vk=1,Qu="firebase-heartbeat-store";let gp=null;function yS(){return gp||(gp=Xx(Ok,Vk,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ki.create("idb-open",{originalErrorMessage:t.message})})),gp}async function Mk(t){try{const n=(await yS()).transaction(Qu),r=await n.objectStore(Qu).get(vS(t));return await n.done,r}catch(e){if(e instanceof ai)Zs.warn(e.message);else{const n=Ki.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zs.warn(n.message)}}}async function Y_(t,e){try{const r=(await yS()).transaction(Qu,"readwrite");await r.objectStore(Qu).put(e,vS(t)),await r.done}catch(n){if(n instanceof ai)Zs.warn(n.message);else{const r=Ki.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Zs.warn(r.message)}}}function vS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=1024,Fk=30;class Uk{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $k(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=J_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>Fk){const o=zk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Zs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=J_(),{heartbeatsToSend:r,unsentEntries:s}=Bk(this._heartbeatsCache.heartbeats),i=gh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Zs.warn(n),""}}}function J_(){return new Date().toISOString().substring(0,10)}function Bk(t,e=jk){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),X_(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),X_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class $k{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Cx()?Px().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Mk(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Y_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Y_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function X_(t){return gh(JSON.stringify({version:2,heartbeats:t})).length}function zk(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(t){fl(new ea("platform-logger",e=>new tk(e),"PRIVATE")),fl(new ea("heartbeat",e=>new Uk(e),"PRIVATE")),Gi(Am,G_,t),Gi(Am,G_,"esm2017"),Gi("fire-js","")}qk("");function Jg(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function _S(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Hk=_S,wS=new hc("auth","Firebase",_S());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new Gg("@firebase/auth");function Wk(t,...e){yh.logLevel<=$e.WARN&&yh.warn(`Auth (${Al}): ${t}`,...e)}function kd(t,...e){yh.logLevel<=$e.ERROR&&yh.error(`Auth (${Al}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t,...e){throw Xg(t,...e)}function ws(t,...e){return Xg(t,...e)}function ES(t,e,n){const r=Object.assign(Object.assign({},Hk()),{[e]:n});return new hc("auth","Firebase",r).create(e,{appName:t.name})}function Qi(t){return ES(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Xg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return wS.create(t,...e)}function Re(t,e,...n){if(!t)throw Xg(e,...n)}function qs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw kd(e),new Error(e)}function ei(t,e){t||qs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Kk(){return Z_()==="http:"||Z_()==="https:"}function Z_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Kk()||Sx()||"connection"in navigator)?navigator.onLine:!0}function Qk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,n){this.shortDelay=e,this.longDelay=n,ei(n>e,"Short delay should be less than long delay!"),this.isMobile=wx()||Ix()}get(){return Gk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t,e){ei(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Xk=new pc(3e4,6e4);function la(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function fo(t,e,n,r,s={}){return SS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=fc(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:u},i);return Tx()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Il(t.emulatorConfig.host)&&(c.credentials="include"),TS.fetch()(await IS(t,t.config.apiHost,n,l),c)})}async function SS(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Yk),e);try{const s=new eN(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ld(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,c]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ld(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ld(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw ld(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ES(t,h,c);Zr(t,h)}}catch(s){if(s instanceof ai)throw s;Zr(t,"network-request-failed",{message:String(s)})}}async function rf(t,e,n,r,s={}){const i=await fo(t,e,n,r,s);return"mfaPendingCredential"in i&&Zr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function IS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Zg(t.config,s):`${t.config.apiScheme}://${s}`;return Jk.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Zk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class eN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ws(this.auth,"network-request-failed")),Xk.get())})}}function ld(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=ws(t,e,r);return s.customData._tokenResponse=n,s}function ew(t){return t!==void 0&&t.enterprise!==void 0}class tN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Zk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function nN(t,e){return fo(t,"GET","/v2/recaptchaConfig",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(t,e){return fo(t,"POST","/v1/accounts:delete",e)}async function vh(t,e){return fo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sN(t,e=!1){const n=Mt(t),r=await n.getIdToken(e),s=ey(r);Re(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Tu(yp(s.auth_time)),issuedAtTime:Tu(yp(s.iat)),expirationTime:Tu(yp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function yp(t){return Number(t)*1e3}function ey(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return kd("JWT malformed, contained fewer than 3 sections"),null;try{const s=aS(n);return s?JSON.parse(s):(kd("Failed to decode base64 JWT payload"),null)}catch(s){return kd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function tw(t){const e=ey(t);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ai&&iN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function iN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tu(this.lastLoginAt),this.creationTime=Tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _h(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Yu(t,vh(n,{idToken:r}));Re(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?AS(i.providerUserInfo):[],l=lN(t.providerData,o),u=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=u?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new xm(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function aN(t){const e=Mt(t);await _h(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lN(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function AS(t){return t.map(e=>{var{providerId:n}=e,r=Jg(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uN(t,e){const n=await SS(t,{},async()=>{const r=fc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await IS(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return t.emulatorConfig&&Il(t.emulatorConfig.host)&&(u.credentials="include"),TS.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function cN(t,e){return fo(t,"POST","/v2/accounts:revokeToken",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const n=tw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await uN(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ya;return r&&(Re(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Re(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Re(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ya,this.toJSON())}_performRefresh(){return qs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(t,e){Re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Jg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new oN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new xm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Yu(this,this.stsTokenManager.getToken(this.auth,e));return Re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return sN(this,e)}reload(){return aN(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Qr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await _h(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Gr(this.auth.app))return Promise.reject(Qi(this.auth));const e=await this.getIdToken();return await Yu(this,rN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,c,h;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,T=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,R=(o=n.photoURL)!==null&&o!==void 0?o:void 0,D=(l=n.tenantId)!==null&&l!==void 0?l:void 0,V=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,P=(c=n.createdAt)!==null&&c!==void 0?c:void 0,_=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:x,emailVerified:j,isAnonymous:q,providerData:W,stsTokenManager:v}=n;Re(x&&v,e,"internal-error");const m=Ya.fromJSON(this.name,v);Re(typeof x=="string",e,"internal-error"),wi(f,e.name),wi(y,e.name),Re(typeof j=="boolean",e,"internal-error"),Re(typeof q=="boolean",e,"internal-error"),wi(T,e.name),wi(R,e.name),wi(D,e.name),wi(V,e.name),wi(P,e.name),wi(_,e.name);const A=new Qr({uid:x,auth:e,email:y,emailVerified:j,displayName:f,isAnonymous:q,photoURL:R,phoneNumber:T,tenantId:D,stsTokenManager:m,createdAt:P,lastLoginAt:_});return W&&Array.isArray(W)&&(A.providerData=W.map(I=>Object.assign({},I))),V&&(A._redirectEventId=V),A}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ya;s.updateFromServerResponse(n);const i=new Qr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await _h(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Re(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?AS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Ya;l.updateFromIdToken(r);const u=new Qr({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new xm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=new Map;function Hs(t){ei(t instanceof Function,"Expected a class definition");let e=nw.get(t);return e?(ei(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}RS.type="NONE";const rw=RS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(t,e,n){return`firebase:${t}:${e}:${n}`}class Ja{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Nd(this.userKey,s.apiKey,i),this.fullPersistenceKey=Nd("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await vh(this.auth,{idToken:e}).catch(()=>{});return n?Qr._fromGetAccountInfoResponse(this.auth,n,e):null}return Qr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ja(Hs(rw),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Hs(rw);const o=Nd(r,e.config.apiKey,e.name);let l=null;for(const c of n)try{const h=await c._get(o);if(h){let f;if(typeof h=="string"){const y=await vh(e,{idToken:h}).catch(()=>{});if(!y)break;f=await Qr._fromGetAccountInfoResponse(e,y,h)}else f=Qr._fromJSON(e,h);c!==i&&(l=f),i=c;break}}catch{}const u=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Ja(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Ja(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DS(e))return"Blackberry";if(bS(e))return"Webos";if(PS(e))return"Safari";if((e.includes("chrome/")||xS(e))&&!e.includes("edge/"))return"Chrome";if(NS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function CS(t=Bn()){return/firefox\//i.test(t)}function PS(t=Bn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xS(t=Bn()){return/crios\//i.test(t)}function kS(t=Bn()){return/iemobile/i.test(t)}function NS(t=Bn()){return/android/i.test(t)}function DS(t=Bn()){return/blackberry/i.test(t)}function bS(t=Bn()){return/webos/i.test(t)}function ty(t=Bn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function dN(t=Bn()){var e;return ty(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function hN(){return Ax()&&document.documentMode===10}function LS(t=Bn()){return ty(t)||NS(t)||bS(t)||DS(t)||/windows phone/i.test(t)||kS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t,e=[]){let n;switch(t){case"Browser":n=sw(Bn());break;case"Worker":n=`${sw(Bn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Al}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pN(t,e={}){return fo(t,"GET","/v2/passwordPolicy",la(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=6;class gN{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:mN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new iw(this),this.idTokenSubscription=new iw(this),this.beforeStateQueue=new fN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hs(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ja.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await vh(this,{idToken:e}),r=await Qr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Gr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await _h(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Qk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Gr(this.app))return Promise.reject(Qi(this));const n=e?Mt(e):null;return n&&Re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Gr(this.app)?Promise.reject(Qi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Gr(this.app)?Promise.reject(Qi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await pN(this),n=new gN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await cN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hs(e)||this._popupRedirectResolver;Re(n,this,"argument-error"),this.redirectPersistenceManager=await Ja.create(this,[Hs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(Gr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Wk(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Rl(t){return Mt(t)}class iw{constructor(e){this.auth=e,this.observer=null,this.addObserver=bx(n=>this.observer=n)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vN(t){sf=t}function VS(t){return sf.loadJS(t)}function _N(){return sf.recaptchaEnterpriseScript}function wN(){return sf.gapiScript}function EN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class TN{constructor(){this.enterprise=new SN}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class SN{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const IN="recaptcha-enterprise",MS="NO_RECAPTCHA";class AN{constructor(e){this.type=IN,this.auth=Rl(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{nN(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const c=new tN(u);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(u=>{l(u)})})}function s(i,o,l){const u=window.grecaptcha;ew(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(MS)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new TN().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&ew(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=_N();u.length!==0&&(u+=l),VS(u).then(()=>{s(l,i,o)}).catch(c=>{o(c)})}}).catch(l=>{o(l)})})}}async function ow(t,e,n,r=!1,s=!1){const i=new AN(t);let o;if(s)o=MS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,c=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function aw(t,e,n,r,s){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ow(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await ow(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(t,e){const n=Yg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Zo(i,e??{}))return s;Zr(s,"already-initialized")}return n.initialize({options:e})}function CN(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function PN(t,e,n){const r=Rl(t);Re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=jS(e),{host:o,port:l}=xN(e),u=l===null?"":`:${l}`,c={url:`${i}//${o}${u}/`},h=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Re(Zo(c,r.config.emulator)&&Zo(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Il(o)?(dS(`${i}//${o}${u}`),hS("Auth",!0)):kN()}function jS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xN(t){const e=jS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:lw(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:lw(o)}}}function lw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qs("not implemented")}_getIdTokenResponse(e){return qs("not implemented")}_linkToIdToken(e,n){return qs("not implemented")}_getReauthenticationResolver(e){return qs("not implemented")}}async function NN(t,e){return fo(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DN(t,e){return rf(t,"POST","/v1/accounts:signInWithPassword",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bN(t,e){return rf(t,"POST","/v1/accounts:signInWithEmailLink",la(t,e))}async function LN(t,e){return rf(t,"POST","/v1/accounts:signInWithEmailLink",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends ny{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ju(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ju(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aw(e,n,"signInWithPassword",DN);case"emailLink":return bN(e,{email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aw(e,r,"signUpPassword",NN);case"emailLink":return LN(e,{idToken:n,email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xa(t,e){return rf(t,"POST","/v1/accounts:signInWithIdp",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON="http://localhost";class ta extends ny{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ta(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Jg(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ta(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Xa(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Xa(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Xa(e,n)}buildRequest(){const e={requestUri:ON,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=fc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function MN(t){const e=iu(ou(t)).link,n=e?iu(ou(e)).deep_link_id:null,r=iu(ou(t)).deep_link_id;return(r?iu(ou(r)).link:null)||r||n||e||t}class ry{constructor(e){var n,r,s,i,o,l;const u=iu(ou(e)),c=(n=u.apiKey)!==null&&n!==void 0?n:null,h=(r=u.oobCode)!==null&&r!==void 0?r:null,f=VN((s=u.mode)!==null&&s!==void 0?s:null);Re(c&&h&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=h,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=MN(e);try{return new ry(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(){this.providerId=Cl.PROVIDER_ID}static credential(e,n){return Ju._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=ry.parseLink(n);return Re(r,"argument-error"),Ju._fromEmailAndCode(e,r.code,r.tenantId)}}Cl.PROVIDER_ID="password";Cl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Cl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc extends FS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends mc{constructor(){super("facebook.com")}static credential(e){return ta._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.FACEBOOK_SIGN_IN_METHOD="facebook.com";xi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki extends mc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ta._fromParams({providerId:ki.PROVIDER_ID,signInMethod:ki.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ki.credentialFromTaggedObject(e)}static credentialFromError(e){return ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ki.credential(n,r)}catch{return null}}}ki.GOOGLE_SIGN_IN_METHOD="google.com";ki.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends mc{constructor(){super("github.com")}static credential(e){return ta._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ni.credential(e.oauthAccessToken)}catch{return null}}}Ni.GITHUB_SIGN_IN_METHOD="github.com";Ni.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends mc{constructor(){super("twitter.com")}static credential(e,n){return ta._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Di.credential(n,r)}catch{return null}}}Di.TWITTER_SIGN_IN_METHOD="twitter.com";Di.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Qr._fromIdTokenResponse(e,r,s),o=uw(r);return new pl({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=uw(r);return new pl({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function uw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh extends ai{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,wh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new wh(e,n,r,s)}}function US(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?wh._fromErrorAndOperation(t,i,e,r):i})}async function jN(t,e,n=!1){const r=await Yu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return pl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN(t,e,n=!1){const{auth:r}=t;if(Gr(r.app))return Promise.reject(Qi(r));const s="reauthenticate";try{const i=await Yu(t,US(r,s,e,t),n);Re(i.idToken,r,"internal-error");const o=ey(i.idToken);Re(o,r,"internal-error");const{sub:l}=o;return Re(t.uid===l,r,"user-mismatch"),pl._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Zr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BS(t,e,n=!1){if(Gr(t.app))return Promise.reject(Qi(t));const r="signIn",s=await US(t,r,e),i=await pl._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function UN(t,e){return BS(Rl(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(t){const e=Rl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function $N(t,e,n){return Gr(t.app)?Promise.reject(Qi(t)):UN(Mt(t),Cl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&BN(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(t,e){return Mt(t).setPersistence(e)}function qN(t,e,n,r){return Mt(t).onIdTokenChanged(e,n,r)}function HN(t,e,n){return Mt(t).beforeAuthStateChanged(e,n)}function WN(t,e,n,r){return Mt(t).onAuthStateChanged(e,n,r)}function KN(t){return Mt(t).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN=1e3,QN=10;class zS extends $S{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);hN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,QN):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},GN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}zS.type="LOCAL";const qS=zS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS extends $S{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}HS.type="SESSION";const WS=HS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new of(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async c=>c(n.origin,i)),u=await YN(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}of.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const c=sy("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const y=f;if(y.data.eventId===c)switch(y.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(y.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(){return window}function XN(t){Es().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){return typeof Es().WorkerGlobalScope<"u"&&typeof Es().importScripts=="function"}async function ZN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function eD(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function tD(){return KS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="firebaseLocalStorageDb",nD=1,Th="firebaseLocalStorage",QS="fbase_key";class gc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function af(t,e){return t.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function rD(){const t=indexedDB.deleteDatabase(GS);return new gc(t).toPromise()}function km(){const t=indexedDB.open(GS,nD);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Th,{keyPath:QS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Th)?e(r):(r.close(),await rD(),e(await km()))})})}async function cw(t,e,n){const r=af(t,!0).put({[QS]:e,value:n});return new gc(r).toPromise()}async function sD(t,e){const n=af(t,!1).get(e),r=await new gc(n).toPromise();return r===void 0?null:r.value}function dw(t,e){const n=af(t,!0).delete(e);return new gc(n).toPromise()}const iD=800,oD=3;class YS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await km(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>oD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=of._getInstance(tD()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await ZN(),!this.activeServiceWorker)return;this.sender=new JN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||eD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await km();return await cw(e,Eh,"1"),await dw(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>cw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>sD(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>dw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=af(s,!1).getAll();return new gc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YS.type="LOCAL";const aD=YS;new pc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lD(t,e){return e?Hs(e):(Re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy extends ny{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xa(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Xa(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Xa(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function uD(t){return BS(t.auth,new iy(t),t.bypassAuthState)}function cD(t){const{auth:e,user:n}=t;return Re(n,e,"internal-error"),FN(n,new iy(t),t.bypassAuthState)}async function dD(t){const{auth:e,user:n}=t;return Re(n,e,"internal-error"),jN(n,new iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uD;case"linkViaPopup":case"linkViaRedirect":return dD;case"reauthViaPopup":case"reauthViaRedirect":return cD;default:Zr(this.auth,"internal-error")}}resolve(e){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD=new pc(2e3,1e4);class Ba extends JS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ba.currentPopupAction&&Ba.currentPopupAction.cancel(),Ba.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){ei(this.filter.length===1,"Popup operations only handle one event");const e=sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ws(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ws(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ba.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ws(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hD.get())};e()}}Ba.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fD="pendingRedirect",Dd=new Map;class pD extends JS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Dd.get(this.auth._key());if(!e){try{const r=await mD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Dd.set(this.auth._key(),e)}return this.bypassAuthState||Dd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mD(t,e){const n=vD(e),r=yD(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function gD(t,e){Dd.set(t._key(),e)}function yD(t){return Hs(t._redirectPersistence)}function vD(t){return Nd(fD,t.config.apiKey,t.name)}async function _D(t,e,n=!1){if(Gr(t.app))return Promise.reject(Qi(t));const r=Rl(t),s=lD(r,e),o=await new pD(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=10*60*1e3;class ED{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TD(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!XS(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(ws(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wD&&this.cachedEventUids.clear(),this.cachedEventUids.has(hw(e))}saveEventToCache(e){this.cachedEventUids.add(hw(e)),this.lastProcessedEventTime=Date.now()}}function hw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function XS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SD(t,e={}){return fo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,AD=/^https?/;async function RD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await SD(t);for(const n of e)try{if(CD(n))return}catch{}Zr(t,"unauthorized-domain")}function CD(t){const e=Pm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!AD.test(n))return!1;if(ID.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new pc(3e4,6e4);function fw(){const t=Es().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function xD(t){return new Promise((e,n)=>{var r,s,i;function o(){fw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fw(),n(ws(t,"network-request-failed"))},timeout:PD.get()})}if(!((s=(r=Es().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Es().gapi)===null||i===void 0)&&i.load)o();else{const l=EN("iframefcb");return Es()[l]=()=>{gapi.load?o():n(ws(t,"network-request-failed"))},VS(`${wN()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw bd=null,e})}let bd=null;function kD(t){return bd=bd||xD(t),bd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=new pc(5e3,15e3),DD="__/auth/iframe",bD="emulator/auth/iframe",LD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VD(t){const e=t.config;Re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Zg(e,bD):`https://${t.config.authDomain}/${DD}`,r={apiKey:e.apiKey,appName:t.name,v:Al},s=OD.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${fc(r).slice(1)}`}async function MD(t){const e=await kD(t),n=Es().gapi;return Re(n,t,"internal-error"),e.open({where:document.body,url:VD(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:LD,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=ws(t,"network-request-failed"),l=Es().setTimeout(()=>{i(o)},ND.get());function u(){Es().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FD=500,UD=600,BD="_blank",$D="http://localhost";class pw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zD(t,e,n,r=FD,s=UD){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},jD),{width:r.toString(),height:s.toString(),top:i,left:o}),c=Bn().toLowerCase();n&&(l=xS(c)?BD:n),CS(c)&&(e=e||$D,u.scrollbars="yes");const h=Object.entries(u).reduce((y,[T,R])=>`${y}${T}=${R},`,"");if(dN(c)&&l!=="_self")return qD(e||"",l),new pw(null);const f=window.open(e||"",l,h);Re(f,t,"popup-blocked");try{f.focus()}catch{}return new pw(f)}function qD(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD="__/auth/handler",WD="emulator/auth/handler",KD=encodeURIComponent("fac");async function mw(t,e,n,r,s,i){Re(t.config.authDomain,t,"auth-domain-config-required"),Re(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Al,eventId:s};if(e instanceof FS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Dx(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof mc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),c=u?`#${KD}=${encodeURIComponent(u)}`:"";return`${GD(t)}?${fc(l).slice(1)}${c}`}function GD({config:t}){return t.emulator?Zg(t,WD):`https://${t.authDomain}/${HD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="webStorageSupport";class QD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WS,this._completeRedirectFn=_D,this._overrideRedirectResult=gD}async _openPopup(e,n,r,s){var i;ei((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await mw(e,n,r,Pm(),s);return zD(e,o,sy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await mw(e,n,r,Pm(),s);return XN(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ei(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await MD(e),r=new ED(e);return n.register("authEvent",s=>(Re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(vp,{type:vp},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[vp];o!==void 0&&n(!!o),Zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=RD(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return LS()||PS()||ty()}}const YD=QD;var gw="@firebase/auth",yw="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZD(t){fl(new ea("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Re(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OS(t)},c=new yN(r,s,i,u);return CN(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),fl(new ea("auth-internal",e=>{const n=Rl(e.getProvider("auth").getImmediate());return(r=>new JD(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gi(gw,yw,XD(t)),Gi(gw,yw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb=5*60,tb=cS("authIdTokenMaxAge")||eb;let vw=null;const nb=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>tb)return;const s=n==null?void 0:n.token;vw!==s&&(vw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function lf(t=gS()){const e=Yg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=RN(t,{popupRedirectResolver:YD,persistence:[aD,qS,WS]}),r=cS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=nb(i.toString());HN(n,o,()=>o(n.currentUser)),qN(n,l=>o(l))}}const s=lS("auth");return s&&PN(n,`http://${s}`),n}function rb(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}vN({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=ws("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",rb().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZD("Browser");var _w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yi,ZS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,m){function A(){}A.prototype=m.prototype,v.D=m.prototype,v.prototype=new A,v.prototype.constructor=v,v.C=function(I,N,L){for(var k=Array(arguments.length-2),de=2;de<arguments.length;de++)k[de-2]=arguments[de];return m.prototype[N].apply(I,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,m,A){A||(A=0);var I=Array(16);if(typeof m=="string")for(var N=0;16>N;++N)I[N]=m.charCodeAt(A++)|m.charCodeAt(A++)<<8|m.charCodeAt(A++)<<16|m.charCodeAt(A++)<<24;else for(N=0;16>N;++N)I[N]=m[A++]|m[A++]<<8|m[A++]<<16|m[A++]<<24;m=v.g[0],A=v.g[1],N=v.g[2];var L=v.g[3],k=m+(L^A&(N^L))+I[0]+3614090360&4294967295;m=A+(k<<7&4294967295|k>>>25),k=L+(N^m&(A^N))+I[1]+3905402710&4294967295,L=m+(k<<12&4294967295|k>>>20),k=N+(A^L&(m^A))+I[2]+606105819&4294967295,N=L+(k<<17&4294967295|k>>>15),k=A+(m^N&(L^m))+I[3]+3250441966&4294967295,A=N+(k<<22&4294967295|k>>>10),k=m+(L^A&(N^L))+I[4]+4118548399&4294967295,m=A+(k<<7&4294967295|k>>>25),k=L+(N^m&(A^N))+I[5]+1200080426&4294967295,L=m+(k<<12&4294967295|k>>>20),k=N+(A^L&(m^A))+I[6]+2821735955&4294967295,N=L+(k<<17&4294967295|k>>>15),k=A+(m^N&(L^m))+I[7]+4249261313&4294967295,A=N+(k<<22&4294967295|k>>>10),k=m+(L^A&(N^L))+I[8]+1770035416&4294967295,m=A+(k<<7&4294967295|k>>>25),k=L+(N^m&(A^N))+I[9]+2336552879&4294967295,L=m+(k<<12&4294967295|k>>>20),k=N+(A^L&(m^A))+I[10]+4294925233&4294967295,N=L+(k<<17&4294967295|k>>>15),k=A+(m^N&(L^m))+I[11]+2304563134&4294967295,A=N+(k<<22&4294967295|k>>>10),k=m+(L^A&(N^L))+I[12]+1804603682&4294967295,m=A+(k<<7&4294967295|k>>>25),k=L+(N^m&(A^N))+I[13]+4254626195&4294967295,L=m+(k<<12&4294967295|k>>>20),k=N+(A^L&(m^A))+I[14]+2792965006&4294967295,N=L+(k<<17&4294967295|k>>>15),k=A+(m^N&(L^m))+I[15]+1236535329&4294967295,A=N+(k<<22&4294967295|k>>>10),k=m+(N^L&(A^N))+I[1]+4129170786&4294967295,m=A+(k<<5&4294967295|k>>>27),k=L+(A^N&(m^A))+I[6]+3225465664&4294967295,L=m+(k<<9&4294967295|k>>>23),k=N+(m^A&(L^m))+I[11]+643717713&4294967295,N=L+(k<<14&4294967295|k>>>18),k=A+(L^m&(N^L))+I[0]+3921069994&4294967295,A=N+(k<<20&4294967295|k>>>12),k=m+(N^L&(A^N))+I[5]+3593408605&4294967295,m=A+(k<<5&4294967295|k>>>27),k=L+(A^N&(m^A))+I[10]+38016083&4294967295,L=m+(k<<9&4294967295|k>>>23),k=N+(m^A&(L^m))+I[15]+3634488961&4294967295,N=L+(k<<14&4294967295|k>>>18),k=A+(L^m&(N^L))+I[4]+3889429448&4294967295,A=N+(k<<20&4294967295|k>>>12),k=m+(N^L&(A^N))+I[9]+568446438&4294967295,m=A+(k<<5&4294967295|k>>>27),k=L+(A^N&(m^A))+I[14]+3275163606&4294967295,L=m+(k<<9&4294967295|k>>>23),k=N+(m^A&(L^m))+I[3]+4107603335&4294967295,N=L+(k<<14&4294967295|k>>>18),k=A+(L^m&(N^L))+I[8]+1163531501&4294967295,A=N+(k<<20&4294967295|k>>>12),k=m+(N^L&(A^N))+I[13]+2850285829&4294967295,m=A+(k<<5&4294967295|k>>>27),k=L+(A^N&(m^A))+I[2]+4243563512&4294967295,L=m+(k<<9&4294967295|k>>>23),k=N+(m^A&(L^m))+I[7]+1735328473&4294967295,N=L+(k<<14&4294967295|k>>>18),k=A+(L^m&(N^L))+I[12]+2368359562&4294967295,A=N+(k<<20&4294967295|k>>>12),k=m+(A^N^L)+I[5]+4294588738&4294967295,m=A+(k<<4&4294967295|k>>>28),k=L+(m^A^N)+I[8]+2272392833&4294967295,L=m+(k<<11&4294967295|k>>>21),k=N+(L^m^A)+I[11]+1839030562&4294967295,N=L+(k<<16&4294967295|k>>>16),k=A+(N^L^m)+I[14]+4259657740&4294967295,A=N+(k<<23&4294967295|k>>>9),k=m+(A^N^L)+I[1]+2763975236&4294967295,m=A+(k<<4&4294967295|k>>>28),k=L+(m^A^N)+I[4]+1272893353&4294967295,L=m+(k<<11&4294967295|k>>>21),k=N+(L^m^A)+I[7]+4139469664&4294967295,N=L+(k<<16&4294967295|k>>>16),k=A+(N^L^m)+I[10]+3200236656&4294967295,A=N+(k<<23&4294967295|k>>>9),k=m+(A^N^L)+I[13]+681279174&4294967295,m=A+(k<<4&4294967295|k>>>28),k=L+(m^A^N)+I[0]+3936430074&4294967295,L=m+(k<<11&4294967295|k>>>21),k=N+(L^m^A)+I[3]+3572445317&4294967295,N=L+(k<<16&4294967295|k>>>16),k=A+(N^L^m)+I[6]+76029189&4294967295,A=N+(k<<23&4294967295|k>>>9),k=m+(A^N^L)+I[9]+3654602809&4294967295,m=A+(k<<4&4294967295|k>>>28),k=L+(m^A^N)+I[12]+3873151461&4294967295,L=m+(k<<11&4294967295|k>>>21),k=N+(L^m^A)+I[15]+530742520&4294967295,N=L+(k<<16&4294967295|k>>>16),k=A+(N^L^m)+I[2]+3299628645&4294967295,A=N+(k<<23&4294967295|k>>>9),k=m+(N^(A|~L))+I[0]+4096336452&4294967295,m=A+(k<<6&4294967295|k>>>26),k=L+(A^(m|~N))+I[7]+1126891415&4294967295,L=m+(k<<10&4294967295|k>>>22),k=N+(m^(L|~A))+I[14]+2878612391&4294967295,N=L+(k<<15&4294967295|k>>>17),k=A+(L^(N|~m))+I[5]+4237533241&4294967295,A=N+(k<<21&4294967295|k>>>11),k=m+(N^(A|~L))+I[12]+1700485571&4294967295,m=A+(k<<6&4294967295|k>>>26),k=L+(A^(m|~N))+I[3]+2399980690&4294967295,L=m+(k<<10&4294967295|k>>>22),k=N+(m^(L|~A))+I[10]+4293915773&4294967295,N=L+(k<<15&4294967295|k>>>17),k=A+(L^(N|~m))+I[1]+2240044497&4294967295,A=N+(k<<21&4294967295|k>>>11),k=m+(N^(A|~L))+I[8]+1873313359&4294967295,m=A+(k<<6&4294967295|k>>>26),k=L+(A^(m|~N))+I[15]+4264355552&4294967295,L=m+(k<<10&4294967295|k>>>22),k=N+(m^(L|~A))+I[6]+2734768916&4294967295,N=L+(k<<15&4294967295|k>>>17),k=A+(L^(N|~m))+I[13]+1309151649&4294967295,A=N+(k<<21&4294967295|k>>>11),k=m+(N^(A|~L))+I[4]+4149444226&4294967295,m=A+(k<<6&4294967295|k>>>26),k=L+(A^(m|~N))+I[11]+3174756917&4294967295,L=m+(k<<10&4294967295|k>>>22),k=N+(m^(L|~A))+I[2]+718787259&4294967295,N=L+(k<<15&4294967295|k>>>17),k=A+(L^(N|~m))+I[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,v.g[2]=v.g[2]+N&4294967295,v.g[3]=v.g[3]+L&4294967295}r.prototype.u=function(v,m){m===void 0&&(m=v.length);for(var A=m-this.blockSize,I=this.B,N=this.h,L=0;L<m;){if(N==0)for(;L<=A;)s(this,v,L),L+=this.blockSize;if(typeof v=="string"){for(;L<m;)if(I[N++]=v.charCodeAt(L++),N==this.blockSize){s(this,I),N=0;break}}else for(;L<m;)if(I[N++]=v[L++],N==this.blockSize){s(this,I),N=0;break}}this.h=N,this.o+=m},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;var A=8*this.o;for(m=v.length-8;m<v.length;++m)v[m]=A&255,A/=256;for(this.u(v),v=Array(16),m=A=0;4>m;++m)for(var I=0;32>I;I+=8)v[A++]=this.g[m]>>>I&255;return v};function i(v,m){var A=l;return Object.prototype.hasOwnProperty.call(A,v)?A[v]:A[v]=m(v)}function o(v,m){this.h=m;for(var A=[],I=!0,N=v.length-1;0<=N;N--){var L=v[N]|0;I&&L==m||(A[N]=L,I=!1)}this.g=A}var l={};function u(v){return-128<=v&&128>v?i(v,function(m){return new o([m|0],0>m?-1:0)}):new o([v|0],0>v?-1:0)}function c(v){if(isNaN(v)||!isFinite(v))return f;if(0>v)return V(c(-v));for(var m=[],A=1,I=0;v>=A;I++)m[I]=v/A|0,A*=4294967296;return new o(m,0)}function h(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return V(h(v.substring(1),m));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(m,8)),I=f,N=0;N<v.length;N+=8){var L=Math.min(8,v.length-N),k=parseInt(v.substring(N,N+L),m);8>L?(L=c(Math.pow(m,L)),I=I.j(L).add(c(k))):(I=I.j(A),I=I.add(c(k)))}return I}var f=u(0),y=u(1),T=u(16777216);t=o.prototype,t.m=function(){if(D(this))return-V(this).m();for(var v=0,m=1,A=0;A<this.g.length;A++){var I=this.i(A);v+=(0<=I?I:4294967296+I)*m,m*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(R(this))return"0";if(D(this))return"-"+V(this).toString(v);for(var m=c(Math.pow(v,6)),A=this,I="";;){var N=j(A,m).g;A=P(A,N.j(m));var L=((0<A.g.length?A.g[0]:A.h)>>>0).toString(v);if(A=N,R(A))return L+I;for(;6>L.length;)L="0"+L;I=L+I}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function R(v){if(v.h!=0)return!1;for(var m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function D(v){return v.h==-1}t.l=function(v){return v=P(this,v),D(v)?-1:R(v)?0:1};function V(v){for(var m=v.g.length,A=[],I=0;I<m;I++)A[I]=~v.g[I];return new o(A,~v.h).add(y)}t.abs=function(){return D(this)?V(this):this},t.add=function(v){for(var m=Math.max(this.g.length,v.g.length),A=[],I=0,N=0;N<=m;N++){var L=I+(this.i(N)&65535)+(v.i(N)&65535),k=(L>>>16)+(this.i(N)>>>16)+(v.i(N)>>>16);I=k>>>16,L&=65535,k&=65535,A[N]=k<<16|L}return new o(A,A[A.length-1]&-2147483648?-1:0)};function P(v,m){return v.add(V(m))}t.j=function(v){if(R(this)||R(v))return f;if(D(this))return D(v)?V(this).j(V(v)):V(V(this).j(v));if(D(v))return V(this.j(V(v)));if(0>this.l(T)&&0>v.l(T))return c(this.m()*v.m());for(var m=this.g.length+v.g.length,A=[],I=0;I<2*m;I++)A[I]=0;for(I=0;I<this.g.length;I++)for(var N=0;N<v.g.length;N++){var L=this.i(I)>>>16,k=this.i(I)&65535,de=v.i(N)>>>16,ke=v.i(N)&65535;A[2*I+2*N]+=k*ke,_(A,2*I+2*N),A[2*I+2*N+1]+=L*ke,_(A,2*I+2*N+1),A[2*I+2*N+1]+=k*de,_(A,2*I+2*N+1),A[2*I+2*N+2]+=L*de,_(A,2*I+2*N+2)}for(I=0;I<m;I++)A[I]=A[2*I+1]<<16|A[2*I];for(I=m;I<2*m;I++)A[I]=0;return new o(A,0)};function _(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function x(v,m){this.g=v,this.h=m}function j(v,m){if(R(m))throw Error("division by zero");if(R(v))return new x(f,f);if(D(v))return m=j(V(v),m),new x(V(m.g),V(m.h));if(D(m))return m=j(v,V(m)),new x(V(m.g),m.h);if(30<v.g.length){if(D(v)||D(m))throw Error("slowDivide_ only works with positive integers.");for(var A=y,I=m;0>=I.l(v);)A=q(A),I=q(I);var N=W(A,1),L=W(I,1);for(I=W(I,2),A=W(A,2);!R(I);){var k=L.add(I);0>=k.l(v)&&(N=N.add(A),L=k),I=W(I,1),A=W(A,1)}return m=P(v,N.j(m)),new x(N,m)}for(N=f;0<=v.l(m);){for(A=Math.max(1,Math.floor(v.m()/m.m())),I=Math.ceil(Math.log(A)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),L=c(A),k=L.j(m);D(k)||0<k.l(v);)A-=I,L=c(A),k=L.j(m);R(L)&&(L=y),N=N.add(L),v=P(v,k)}return new x(N,v)}t.A=function(v){return j(this,v).h},t.and=function(v){for(var m=Math.max(this.g.length,v.g.length),A=[],I=0;I<m;I++)A[I]=this.i(I)&v.i(I);return new o(A,this.h&v.h)},t.or=function(v){for(var m=Math.max(this.g.length,v.g.length),A=[],I=0;I<m;I++)A[I]=this.i(I)|v.i(I);return new o(A,this.h|v.h)},t.xor=function(v){for(var m=Math.max(this.g.length,v.g.length),A=[],I=0;I<m;I++)A[I]=this.i(I)^v.i(I);return new o(A,this.h^v.h)};function q(v){for(var m=v.g.length+1,A=[],I=0;I<m;I++)A[I]=v.i(I)<<1|v.i(I-1)>>>31;return new o(A,v.h)}function W(v,m){var A=m>>5;m%=32;for(var I=v.g.length-A,N=[],L=0;L<I;L++)N[L]=0<m?v.i(L+A)>>>m|v.i(L+A+1)<<32-m:v.i(L+A);return new o(N,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ZS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Yi=o}).apply(typeof _w<"u"?_w:typeof self<"u"?self:typeof window<"u"?window:{});var ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var eI,au,tI,Ld,Nm,nI,rI,sI;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,g){return a==Array.prototype||a==Object.prototype||(a[d]=g.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ud=="object"&&ud];for(var d=0;d<a.length;++d){var g=a[d];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(a,d){if(d)e:{var g=r;a=a.split(".");for(var E=0;E<a.length-1;E++){var F=a[E];if(!(F in g))break e;g=g[F]}a=a[a.length-1],E=g[a],d=d(E),d!=E&&d!=null&&e(g,a,{configurable:!0,writable:!0,value:d})}}function i(a,d){a instanceof String&&(a+="");var g=0,E=!1,F={next:function(){if(!E&&g<a.length){var z=g++;return{value:d(z,a[z]),done:!1}}return E=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}s("Array.prototype.values",function(a){return a||function(){return i(this,function(d,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function c(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function h(a,d,g){return a.call.apply(a.bind,arguments)}function f(a,d,g){if(!a)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var F=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(F,E),a.apply(d,F)}}return function(){return a.apply(d,arguments)}}function y(a,d,g){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,y.apply(null,arguments)}function T(a,d){var g=Array.prototype.slice.call(arguments,1);return function(){var E=g.slice();return E.push.apply(E,arguments),a.apply(this,E)}}function R(a,d){function g(){}g.prototype=d.prototype,a.aa=d.prototype,a.prototype=new g,a.prototype.constructor=a,a.Qb=function(E,F,z){for(var ne=Array(arguments.length-2),at=2;at<arguments.length;at++)ne[at-2]=arguments[at];return d.prototype[F].apply(E,ne)}}function D(a){const d=a.length;if(0<d){const g=Array(d);for(let E=0;E<d;E++)g[E]=a[E];return g}return[]}function V(a,d){for(let g=1;g<arguments.length;g++){const E=arguments[g];if(u(E)){const F=a.length||0,z=E.length||0;a.length=F+z;for(let ne=0;ne<z;ne++)a[F+ne]=E[ne]}else a.push(E)}}class P{constructor(d,g){this.i=d,this.j=g,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function _(a){return/^[\s\xa0]*$/.test(a)}function x(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function j(a){return j[" "](a),a}j[" "]=function(){};var q=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function W(a,d,g){for(const E in a)d.call(g,a[E],E,a)}function v(a,d){for(const g in a)d.call(void 0,a[g],g,a)}function m(a){const d={};for(const g in a)d[g]=a[g];return d}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,d){let g,E;for(let F=1;F<arguments.length;F++){E=arguments[F];for(g in E)a[g]=E[g];for(let z=0;z<A.length;z++)g=A[z],Object.prototype.hasOwnProperty.call(E,g)&&(a[g]=E[g])}}function N(a){var d=1;a=a.split(":");const g=[];for(;0<d&&a.length;)g.push(a.shift()),d--;return a.length&&g.push(a.join(":")),g}function L(a){l.setTimeout(()=>{throw a},0)}function k(){var a=ue;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class de{constructor(){this.h=this.g=null}add(d,g){const E=ke.get();E.set(d,g),this.h?this.h.next=E:this.g=E,this.h=E}}var ke=new P(()=>new wt,a=>a.reset());class wt{constructor(){this.next=this.g=this.h=null}set(d,g){this.h=d,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let gt,G=!1,ue=new de,ye=()=>{const a=l.Promise.resolve(void 0);gt=()=>{a.then(Se)}};var Se=()=>{for(var a;a=k();){try{a.h.call(a.g)}catch(g){L(g)}var d=ke;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}G=!1};function Ee(){this.s=this.s,this.C=this.C}Ee.prototype.s=!1,Ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};l.addEventListener("test",g,d),l.removeEventListener("test",g,d)}catch{}return a}();function Ne(a,d){if(Ie.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var g=this.type=a.type,E=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(q){e:{try{j(d.nodeName);var F=!0;break e}catch{}F=!1}F||(d=null)}}else g=="mouseover"?d=a.fromElement:g=="mouseout"&&(d=a.toElement);this.relatedTarget=d,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Xe[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ne.aa.h.call(this)}}R(Ne,Ie);var Xe={2:"touch",3:"pen",4:"mouse"};Ne.prototype.h=function(){Ne.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Qe="closure_listenable_"+(1e6*Math.random()|0),ct=0;function Tr(a,d,g,E,F){this.listener=a,this.proxy=null,this.src=d,this.type=g,this.capture=!!E,this.ha=F,this.key=++ct,this.da=this.fa=!1}function qt(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function jt(a){this.src=a,this.g={},this.h=0}jt.prototype.add=function(a,d,g,E,F){var z=a.toString();a=this.g[z],a||(a=this.g[z]=[],this.h++);var ne=Et(a,d,E,F);return-1<ne?(d=a[ne],g||(d.fa=!1)):(d=new Tr(d,this.src,z,!!E,F),d.fa=g,a.push(d)),d};function Ue(a,d){var g=d.type;if(g in a.g){var E=a.g[g],F=Array.prototype.indexOf.call(E,d,void 0),z;(z=0<=F)&&Array.prototype.splice.call(E,F,1),z&&(qt(d),a.g[g].length==0&&(delete a.g[g],a.h--))}}function Et(a,d,g,E){for(var F=0;F<a.length;++F){var z=a[F];if(!z.da&&z.listener==d&&z.capture==!!g&&z.ha==E)return F}return-1}var nn="closure_lm_"+(1e6*Math.random()|0),Ht={};function Wt(a,d,g,E,F){if(Array.isArray(d)){for(var z=0;z<d.length;z++)Wt(a,d[z],g,E,F);return null}return g=Be(g),a&&a[Qe]?a.K(d,g,c(E)?!!E.capture:!1,F):Sr(a,d,g,!1,E,F)}function Sr(a,d,g,E,F,z){if(!d)throw Error("Invalid event type");var ne=c(F)?!!F.capture:!!F,at=fe(a);if(at||(a[nn]=at=new jt(a)),g=at.add(d,g,E,ne,z),g.proxy)return g;if(E=Vr(),g.proxy=E,E.src=a,E.listener=g,a.addEventListener)be||(F=ne),F===void 0&&(F=!1),a.addEventListener(d.toString(),E,F);else if(a.attachEvent)a.attachEvent(hn(d.toString()),E);else if(a.addListener&&a.removeListener)a.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Vr(){function a(g){return d.call(a.src,a.listener,g)}const d=Y;return a}function Pn(a,d,g,E,F){if(Array.isArray(d))for(var z=0;z<d.length;z++)Pn(a,d[z],g,E,F);else E=c(E)?!!E.capture:!!E,g=Be(g),a&&a[Qe]?(a=a.i,d=String(d).toString(),d in a.g&&(z=a.g[d],g=Et(z,g,E,F),-1<g&&(qt(z[g]),Array.prototype.splice.call(z,g,1),z.length==0&&(delete a.g[d],a.h--)))):a&&(a=fe(a))&&(d=a.g[d.toString()],a=-1,d&&(a=Et(d,g,E,F)),(g=-1<a?d[a]:null)&&xn(g))}function xn(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[Qe])Ue(d.i,a);else{var g=a.type,E=a.proxy;d.removeEventListener?d.removeEventListener(g,E,a.capture):d.detachEvent?d.detachEvent(hn(g),E):d.addListener&&d.removeListener&&d.removeListener(E),(g=fe(d))?(Ue(g,a),g.h==0&&(g.src=null,d[nn]=null)):qt(a)}}}function hn(a){return a in Ht?Ht[a]:Ht[a]="on"+a}function Y(a,d){if(a.da)a=!0;else{d=new Ne(d,this);var g=a.listener,E=a.ha||a.src;a.fa&&xn(a),a=g.call(E,d)}return a}function fe(a){return a=a[nn],a instanceof jt?a:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function Be(a){return typeof a=="function"?a:(a[me]||(a[me]=function(d){return a.handleEvent(d)}),a[me])}function Pe(){Ee.call(this),this.i=new jt(this),this.M=this,this.F=null}R(Pe,Ee),Pe.prototype[Qe]=!0,Pe.prototype.removeEventListener=function(a,d,g,E){Pn(this,a,d,g,E)};function Ye(a,d){var g,E=a.F;if(E)for(g=[];E;E=E.F)g.push(E);if(a=a.M,E=d.type||d,typeof d=="string")d=new Ie(d,a);else if(d instanceof Ie)d.target=d.target||a;else{var F=d;d=new Ie(E,a),I(d,F)}if(F=!0,g)for(var z=g.length-1;0<=z;z--){var ne=d.g=g[z];F=et(ne,E,!0,d)&&F}if(ne=d.g=a,F=et(ne,E,!0,d)&&F,F=et(ne,E,!1,d)&&F,g)for(z=0;z<g.length;z++)ne=d.g=g[z],F=et(ne,E,!1,d)&&F}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var g=a.g[d],E=0;E<g.length;E++)qt(g[E]);delete a.g[d],a.h--}}this.F=null},Pe.prototype.K=function(a,d,g,E){return this.i.add(String(a),d,!1,g,E)},Pe.prototype.L=function(a,d,g,E){return this.i.add(String(a),d,!0,g,E)};function et(a,d,g,E){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var F=!0,z=0;z<d.length;++z){var ne=d[z];if(ne&&!ne.da&&ne.capture==g){var at=ne.listener,sn=ne.ha||ne.src;ne.fa&&Ue(a.i,ne),F=at.call(sn,E)!==!1&&F}}return F&&!E.defaultPrevented}function Nt(a,d,g){if(typeof a=="function")g&&(a=y(a,g));else if(a&&typeof a.handleEvent=="function")a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(a,d||0)}function Kt(a){a.g=Nt(()=>{a.g=null,a.i&&(a.i=!1,Kt(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class ir extends Ee{constructor(d,g){super(),this.m=d,this.l=g,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Kt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(a){Ee.call(this),this.h=a,this.g={}}R(Dt,Ee);var Gt=[];function or(a){W(a.g,function(d,g){this.g.hasOwnProperty(g)&&xn(d)},a),a.g={}}Dt.prototype.N=function(){Dt.aa.N.call(this),or(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ir=l.JSON.stringify,kn=l.JSON.parse,rs=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Nn(){}Nn.prototype.h=null;function ft(a){return a.h||(a.h=a.i())}function Qt(){}var Tt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qn(){Ie.call(this,"d")}R(Qn,Ie);function Ar(){Ie.call(this,"c")}R(Ar,Ie);var Dn={},ar=null;function Mr(){return ar=ar||new Pe}Dn.La="serverreachability";function lr(a){Ie.call(this,Dn.La,a)}R(lr,Ie);function wn(a){const d=Mr();Ye(d,new lr(d))}Dn.STAT_EVENT="statevent";function Cs(a,d){Ie.call(this,Dn.STAT_EVENT,a),this.stat=d}R(Cs,Ie);function bt(a){const d=Mr();Ye(d,new Cs(d,a))}Dn.Ma="timingevent";function b(a,d){Ie.call(this,Dn.Ma,a),this.size=d}R(b,Ie);function O(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function S(){this.g=!0}S.prototype.xa=function(){this.g=!1};function M(a,d,g,E,F,z){a.info(function(){if(a.g)if(z)for(var ne="",at=z.split("&"),sn=0;sn<at.length;sn++){var We=at[sn].split("=");if(1<We.length){var on=We[0];We=We[1];var an=on.split("_");ne=2<=an.length&&an[1]=="type"?ne+(on+"="+We+"&"):ne+(on+"=redacted&")}}else ne=null;else ne=z;return"XMLHTTP REQ ("+E+") [attempt "+F+"]: "+d+`
`+g+`
`+ne})}function B(a,d,g,E,F,z,ne){a.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+F+"]: "+d+`
`+g+`
`+z+" "+ne})}function Q(a,d,g,E){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+te(a,g)+(E?" "+E:"")})}function ae(a,d){a.info(function(){return"TIMEOUT: "+d})}S.prototype.info=function(){};function te(a,d){if(!a.g)return d;if(!d)return null;try{var g=JSON.parse(d);if(g){for(a=0;a<g.length;a++)if(Array.isArray(g[a])){var E=g[a];if(!(2>E.length)){var F=E[1];if(Array.isArray(F)&&!(1>F.length)){var z=F[0];if(z!="noop"&&z!="stop"&&z!="close")for(var ne=1;ne<F.length;ne++)F[ne]=""}}}}return Ir(g)}catch{return d}}var ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},se={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Z;function ge(){}R(ge,Nn),ge.prototype.g=function(){return new XMLHttpRequest},ge.prototype.i=function(){return{}},Z=new ge;function ve(a,d,g,E){this.j=a,this.i=d,this.l=g,this.R=E||1,this.U=new Dt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qe}function qe(){this.i=null,this.g="",this.h=!1}var Me={},De={};function He(a,d,g){a.L=1,a.v=ha(cr(d)),a.m=g,a.P=!0,pt(a,null)}function pt(a,d){a.F=Date.now(),Rt(a),a.A=cr(a.v);var g=a.A,E=a.R;Array.isArray(E)||(E=[String(E)]),kc(g.i,"t",E),a.C=0,g=a.j.J,a.h=new qe,a.g=Mc(a.j,g?d:null,!a.m),0<a.O&&(a.M=new ir(y(a.Y,a,a.g),a.O)),d=a.U,g=a.g,E=a.ca;var F="readystatechange";Array.isArray(F)||(F&&(Gt[0]=F.toString()),F=Gt);for(var z=0;z<F.length;z++){var ne=Wt(g,F[z],E||d.handleEvent,!1,d.h||d);if(!ne)break;d.g[ne.key]=ne}d=a.H?m(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),wn(),M(a.i,a.u,a.A,a.l,a.R,a.m)}ve.prototype.ca=function(a){a=a.target;const d=this.M;d&&jr(a)==3?d.j():this.Y(a)},ve.prototype.Y=function(a){try{if(a==this.g)e:{const an=jr(this.g);var d=this.g.Ba();const Vs=this.g.Z();if(!(3>an)&&(an!=3||this.g&&(this.h.h||this.g.oa()||Ol(this.g)))){this.J||an!=4||d==7||(d==8||0>=Vs?wn(3):wn(2)),Rr(this);var g=this.g.Z();this.X=g;t:if(Lt(this)){var E=Ol(this.g);a="";var F=E.length,z=jr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rn(this),fn(this);var ne="";break t}this.h.i=new l.TextDecoder}for(d=0;d<F;d++)this.h.h=!0,a+=this.h.i.decode(E[d],{stream:!(z&&d==F-1)});E.length=0,this.h.g+=a,this.C=0,ne=this.h.g}else ne=this.g.oa();if(this.o=g==200,B(this.i,this.u,this.A,this.l,this.R,an,g),this.o){if(this.T&&!this.K){t:{if(this.g){var at,sn=this.g;if((at=sn.g?sn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(at)){var We=at;break t}}We=null}if(g=We)Q(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ss(this,g);else{this.o=!1,this.s=3,bt(12),rn(this),fn(this);break e}}if(this.P){g=!0;let Yn;for(;!this.J&&this.C<ne.length;)if(Yn=dt(this,ne),Yn==De){an==4&&(this.s=4,bt(14),g=!1),Q(this.i,this.l,null,"[Incomplete Response]");break}else if(Yn==Me){this.s=4,bt(15),Q(this.i,this.l,ne,"[Invalid Chunk]"),g=!1;break}else Q(this.i,this.l,Yn,null),ss(this,Yn);if(Lt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),an!=4||ne.length!=0||this.h.h||(this.s=1,bt(16),g=!1),this.o=this.o&&g,!g)Q(this.i,this.l,ne,"[Invalid Chunked Response]"),rn(this),fn(this);else if(0<ne.length&&!this.W){this.W=!0;var on=this.j;on.g==this&&on.ba&&!on.M&&(on.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),ds(on),on.M=!0,bt(11))}}else Q(this.i,this.l,ne,null),ss(this,ne);an==4&&rn(this),this.o&&!this.J&&(an==4?Lc(this.j,this):(this.o=!1,Rt(this)))}else Lf(this.g),g==400&&0<ne.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),rn(this),fn(this)}}}catch{}finally{}};function Lt(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function dt(a,d){var g=a.C,E=d.indexOf(`
`,g);return E==-1?De:(g=Number(d.substring(g,E)),isNaN(g)?Me:(E+=1,E+g>d.length?De:(d=d.slice(E,E+g),a.C=E+g,d)))}ve.prototype.cancel=function(){this.J=!0,rn(this)};function Rt(a){a.S=Date.now()+a.I,Ps(a,a.I)}function Ps(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=O(y(a.ba,a),d)}function Rr(a){a.B&&(l.clearTimeout(a.B),a.B=null)}ve.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(ae(this.i,this.A),this.L!=2&&(wn(),bt(17)),rn(this),this.s=2,fn(this)):Ps(this,this.S-a)};function fn(a){a.j.G==0||a.J||Lc(a.j,a)}function rn(a){Rr(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,or(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function ss(a,d){try{var g=a.j;if(g.G!=0&&(g.g==a||je(g.h,a))){if(!a.K&&je(g.h,a)&&g.G==3){try{var E=g.Da.g.parse(d)}catch{E=null}if(Array.isArray(E)&&E.length==3){var F=E;if(F[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<a.F)xo(g),hi(g);else break e;pi(g),bt(18)}}else g.za=F[1],0<g.za-g.T&&37500>F[2]&&g.F&&g.v==0&&!g.C&&(g.C=O(y(g.Za,g),6e3));if(1>=is(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Os(g,11)}else if((a.K||g.g==a)&&xo(g),!_(d))for(F=g.Da.g.parse(d),d=0;d<F.length;d++){let We=F[d];if(g.T=We[0],We=We[1],g.G==2)if(We[0]=="c"){g.K=We[1],g.ia=We[2];const on=We[3];on!=null&&(g.la=on,g.j.info("VER="+g.la));const an=We[4];an!=null&&(g.Aa=an,g.j.info("SVER="+g.Aa));const Vs=We[5];Vs!=null&&typeof Vs=="number"&&0<Vs&&(E=1.5*Vs,g.L=E,g.j.info("backChannelRequestTimeoutMs_="+E)),E=g;const Yn=a.g;if(Yn){const ko=Yn.g?Yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ko){var z=E.h;z.g||ko.indexOf("spdy")==-1&&ko.indexOf("quic")==-1&&ko.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(ur(z,z.h),z.h=null))}if(E.D){const va=Yn.g?Yn.g.getResponseHeader("X-HTTP-Session-Id"):null;va&&(E.ya=va,nt(E.I,E.D,va))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-a.F,g.j.info("Handshake RTT: "+g.R+"ms")),E=g;var ne=a;if(E.qa=Vc(E,E.J?E.ia:null,E.W),ne.K){li(E.h,ne);var at=ne,sn=E.L;sn&&(at.I=sn),at.B&&(Rr(at),Rt(at)),E.g=ne}else Po(E);0<g.i.length&&Ls(g)}else We[0]!="stop"&&We[0]!="close"||Os(g,7);else g.G==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?Os(g,7):Fr(g):We[0]!="noop"&&g.l&&g.l.ta(We),g.v=0)}}wn(4)}catch{}}var Ce=class{constructor(a,d){this.g=a,this.map=d}};function tt(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bn(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function is(a){return a.h?1:a.g?a.g.size:0}function je(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function ur(a,d){a.g?a.g.add(d):a.h=d}function li(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}tt.prototype.cancel=function(){if(this.i=yo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function yo(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const g of a.g.values())d=d.concat(g.D);return d}return D(a.i)}function Rc(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var d=[],g=a.length,E=0;E<g;E++)d.push(a[E]);return d}d=[],g=0;for(E in a)d[g++]=a[E];return d}function vo(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var d=[];a=a.length;for(var g=0;g<a;g++)d.push(g);return d}d=[],g=0;for(const E in a)d[g++]=E;return d}}}function Cc(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var g=vo(a),E=Rc(a),F=E.length,z=0;z<F;z++)d.call(void 0,E[z],g&&g[z],a)}var _o=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yt(a,d){if(a){a=a.split("&");for(var g=0;g<a.length;g++){var E=a[g].indexOf("="),F=null;if(0<=E){var z=a[g].substring(0,E);F=a[g].substring(E+1)}else z=a[g];d(z,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function xs(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof xs){this.h=a.h,wo(this,a.j),this.o=a.o,this.g=a.g,Ll(this,a.s),this.l=a.l;var d=a.i,g=new os;g.i=d.i,d.g&&(g.g=new Map(d.g),g.h=d.h),Eo(this,g),this.m=a.m}else a&&(d=String(a).match(_o))?(this.h=!1,wo(this,d[1]||"",!0),this.o=To(d[2]||""),this.g=To(d[3]||"",!0),Ll(this,d[4]),this.l=To(d[5]||"",!0),Eo(this,d[6]||"",!0),this.m=To(d[7]||"")):(this.h=!1,this.i=new os(null,this.h))}xs.prototype.toString=function(){var a=[],d=this.j;d&&a.push(So(d,Pc,!0),":");var g=this.g;return(g||d=="file")&&(a.push("//"),(d=this.o)&&a.push(So(d,Pc,!0),"@"),a.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&a.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(So(g,g.charAt(0)=="/"?Pf:Cf,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",So(g,kf)),a.join("")};function cr(a){return new xs(a)}function wo(a,d,g){a.j=g?To(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function Ll(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function Eo(a,d,g){d instanceof os?(a.i=d,Nc(a.i,a.h)):(g||(d=So(d,xf)),a.i=new os(d,a.h))}function nt(a,d,g){a.i.set(d,g)}function ha(a){return nt(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function To(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function So(a,d,g){return typeof a=="string"?(a=encodeURI(a).replace(d,Rf),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Rf(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Pc=/[#\/\?@]/g,Cf=/[#\?:]/g,Pf=/[#\?]/g,xf=/[#\?@]/g,kf=/#/g;function os(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function as(a){a.g||(a.g=new Map,a.h=0,a.i&&Yt(a.i,function(d,g){a.add(decodeURIComponent(d.replace(/\+/g," ")),g)}))}t=os.prototype,t.add=function(a,d){as(this),this.i=null,a=ks(this,a);var g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(d),this.h+=1,this};function Io(a,d){as(a),d=ks(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function xc(a,d){return as(a),d=ks(a,d),a.g.has(d)}t.forEach=function(a,d){as(this),this.g.forEach(function(g,E){g.forEach(function(F){a.call(d,F,E,this)},this)},this)},t.na=function(){as(this);const a=Array.from(this.g.values()),d=Array.from(this.g.keys()),g=[];for(let E=0;E<d.length;E++){const F=a[E];for(let z=0;z<F.length;z++)g.push(d[E])}return g},t.V=function(a){as(this);let d=[];if(typeof a=="string")xc(this,a)&&(d=d.concat(this.g.get(ks(this,a))));else{a=Array.from(this.g.values());for(let g=0;g<a.length;g++)d=d.concat(a[g])}return d},t.set=function(a,d){return as(this),this.i=null,a=ks(this,a),xc(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},t.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function kc(a,d,g){Io(a,d),0<g.length&&(a.i=null,a.g.set(ks(a,d),D(g)),a.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(var g=0;g<d.length;g++){var E=d[g];const z=encodeURIComponent(String(E)),ne=this.V(E);for(E=0;E<ne.length;E++){var F=z;ne[E]!==""&&(F+="="+encodeURIComponent(String(ne[E]))),a.push(F)}}return this.i=a.join("&")};function ks(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function Nc(a,d){d&&!a.j&&(as(a),a.i=null,a.g.forEach(function(g,E){var F=E.toLowerCase();E!=F&&(Io(this,E),kc(this,F,g))},a)),a.j=d}function Nf(a,d){const g=new S;if(l.Image){const E=new Image;E.onload=T(ls,g,"TestLoadImage: loaded",!0,d,E),E.onerror=T(ls,g,"TestLoadImage: error",!1,d,E),E.onabort=T(ls,g,"TestLoadImage: abort",!1,d,E),E.ontimeout=T(ls,g,"TestLoadImage: timeout",!1,d,E),l.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=a}else d(!1)}function Df(a,d){const g=new S,E=new AbortController,F=setTimeout(()=>{E.abort(),ls(g,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:E.signal}).then(z=>{clearTimeout(F),z.ok?ls(g,"TestPingServer: ok",!0,d):ls(g,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(F),ls(g,"TestPingServer: error",!1,d)})}function ls(a,d,g,E,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),E(g)}catch{}}function bf(){this.g=new rs}function ui(a,d,g){const E=g||"";try{Cc(a,function(F,z){let ne=F;c(F)&&(ne=Ir(F)),d.push(E+z+"="+encodeURIComponent(ne))})}catch(F){throw d.push(E+"type="+encodeURIComponent("_badmap")),F}}function us(a){this.l=a.Ub||null,this.j=a.eb||!1}R(us,Nn),us.prototype.g=function(){return new fa(this.l,this.j)},us.prototype.i=function(a){return function(){return a}}({});function fa(a,d){Pe.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(fa,Pe),t=fa.prototype,t.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,ci(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ns(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,ci(this)),this.g&&(this.readyState=3,ci(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cr(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cr(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?Ns(this):ci(this),this.readyState==3&&Cr(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Ns(this))},t.Qa=function(a){this.g&&(this.response=a,Ns(this))},t.ga=function(){this.g&&Ns(this)};function Ns(a){a.readyState=4,a.l=null,a.j=null,a.v=null,ci(a)}t.setRequestHeader=function(a,d){this.u.append(a,d)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var g=d.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=d.next();return a.join(`\r
`)};function ci(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(fa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Ao(a){let d="";return W(a,function(g,E){d+=E,d+=":",d+=g,d+=`\r
`}),d}function Ds(a,d,g){e:{for(E in g){var E=!1;break e}E=!0}E||(g=Ao(g),typeof a=="string"?g!=null&&encodeURIComponent(String(g)):nt(a,d,g))}function ot(a){Pe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(ot,Pe);var pa=/^https?$/i,Dc=["POST","PUT"];t=ot.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,d,g,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Z.g(),this.v=this.o?ft(this.o):ft(Z),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(z){cs(this,z);return}if(a=g||"",g=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var F in E)g.set(F,E[F]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const z of E.keys())g.set(z,E.get(z));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(g.keys()).find(z=>z.toLowerCase()=="content-type"),F=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Dc,d,void 0))||E||F||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,ne]of g)this.g.setRequestHeader(z,ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ln(this),this.u=!0,this.g.send(a),this.u=!1}catch(z){cs(this,z)}};function cs(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,ma(a),Co(a)}function ma(a){a.A||(a.A=!0,Ye(a,"complete"),Ye(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ye(this,"complete"),Ye(this,"abort"),Co(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Co(this,!0)),ot.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ro(this):this.bb())},t.bb=function(){Ro(this)};function Ro(a){if(a.h&&typeof o<"u"&&(!a.v[1]||jr(a)!=4||a.Z()!=2)){if(a.u&&jr(a)==4)Nt(a.Ea,0,a);else if(Ye(a,"readystatechange"),jr(a)==4){a.h=!1;try{const ne=a.Z();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var g;if(!(g=d)){var E;if(E=ne===0){var F=String(a.D).match(_o)[1]||null;!F&&l.self&&l.self.location&&(F=l.self.location.protocol.slice(0,-1)),E=!pa.test(F?F.toLowerCase():"")}g=E}if(g)Ye(a,"complete"),Ye(a,"success");else{a.m=6;try{var z=2<jr(a)?a.g.statusText:""}catch{z=""}a.l=z+" ["+a.Z()+"]",ma(a)}}finally{Co(a)}}}}function Co(a,d){if(a.g){Ln(a);const g=a.g,E=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||Ye(a,"ready");try{g.onreadystatechange=E}catch{}}}function Ln(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function jr(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<jr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),kn(d)}};function Ol(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Lf(a){const d={};a=(a.g&&2<=jr(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<a.length;E++){if(_(a[E]))continue;var g=N(a[E]);const F=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const z=d[F]||[];d[F]=z,z.push(g)}v(d,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function di(a,d,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||d}function bc(a){this.Aa=0,this.i=[],this.j=new S,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=di("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=di("baseRetryDelayMs",5e3,a),this.cb=di("retryDelaySeedMs",1e4,a),this.Wa=di("forwardChannelMaxRetries",2,a),this.wa=di("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new tt(a&&a.concurrentRequestLimit),this.Da=new bf,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=bc.prototype,t.la=8,t.G=1,t.connect=function(a,d,g,E){bt(0),this.W=a,this.H=d||{},g&&E!==void 0&&(this.H.OSID=g,this.H.OAID=E),this.F=this.X,this.I=Vc(this,null,this.W),Ls(this)};function Fr(a){if(bs(a),a.G==3){var d=a.U++,g=cr(a.I);if(nt(g,"SID",a.K),nt(g,"RID",d),nt(g,"TYPE","terminate"),fi(a,g),d=new ve(a,a.j,d),d.L=2,d.v=ha(cr(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=d.v,g=!0),g||(d.g=Mc(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Rt(d)}Oc(a)}function hi(a){a.g&&(ds(a),a.g.cancel(),a.g=null)}function bs(a){hi(a),a.u&&(l.clearTimeout(a.u),a.u=null),xo(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Ls(a){if(!bn(a.h)&&!a.s){a.s=!0;var d=a.Ga;gt||ye(),G||(gt(),G=!0),ue.add(d,a),a.B=0}}function Of(a,d){return is(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=O(y(a.Ga,a,d),Ml(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const F=new ve(this,this.j,a);let z=this.o;if(this.S&&(z?(z=m(z),I(z,this.S)):z=this.S),this.m!==null||this.O||(F.H=z,z=null),this.P)e:{for(var d=0,g=0;g<this.i.length;g++){t:{var E=this.i[g];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(d+=E,4096<d){d=g;break e}if(d===4096||g===this.i.length-1){d=g+1;break e}}d=1e3}else d=1e3;d=ga(this,F,d),g=cr(this.I),nt(g,"RID",a),nt(g,"CVER",22),this.D&&nt(g,"X-HTTP-Session-Id",this.D),fi(this,g),z&&(this.O?d="headers="+encodeURIComponent(String(Ao(z)))+"&"+d:this.m&&Ds(g,this.m,z)),ur(this.h,F),this.Ua&&nt(g,"TYPE","init"),this.P?(nt(g,"$req",d),nt(g,"SID","null"),F.T=!0,He(F,g,null)):He(F,g,d),this.G=2}}else this.G==3&&(a?Ur(this,a):this.i.length==0||bn(this.h)||Ur(this))};function Ur(a,d){var g;d?g=d.l:g=a.U++;const E=cr(a.I);nt(E,"SID",a.K),nt(E,"RID",g),nt(E,"AID",a.T),fi(a,E),a.m&&a.o&&Ds(E,a.m,a.o),g=new ve(a,a.j,g,a.B+1),a.m===null&&(g.H=a.o),d&&(a.i=d.D.concat(a.i)),d=ga(a,g,1e3),g.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),ur(a.h,g),He(g,E,d)}function fi(a,d){a.H&&W(a.H,function(g,E){nt(d,E,g)}),a.l&&Cc({},function(g,E){nt(d,E,g)})}function ga(a,d,g){g=Math.min(a.i.length,g);var E=a.l?y(a.l.Na,a.l,a):null;e:{var F=a.i;let z=-1;for(;;){const ne=["count="+g];z==-1?0<g?(z=F[0].g,ne.push("ofs="+z)):z=0:ne.push("ofs="+z);let at=!0;for(let sn=0;sn<g;sn++){let We=F[sn].g;const on=F[sn].map;if(We-=z,0>We)z=Math.max(0,F[sn].g-100),at=!1;else try{ui(on,ne,"req"+We+"_")}catch{E&&E(on)}}if(at){E=ne.join("&");break e}}}return a=a.i.splice(0,g),d.D=a,E}function Po(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;gt||ye(),G||(gt(),G=!0),ue.add(d,a),a.v=0}}function pi(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=O(y(a.Fa,a),Ml(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Vl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=O(y(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),hi(this),Vl(this))};function ds(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Vl(a){a.g=new ve(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=cr(a.qa);nt(d,"RID","rpc"),nt(d,"SID",a.K),nt(d,"AID",a.T),nt(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&nt(d,"TO",a.ja),nt(d,"TYPE","xmlhttp"),fi(a,d),a.m&&a.o&&Ds(d,a.m,a.o),a.L&&(a.g.I=a.L);var g=a.g;a=a.ia,g.L=1,g.v=ha(cr(d)),g.m=null,g.P=!0,pt(g,a)}t.Za=function(){this.C!=null&&(this.C=null,hi(this),pi(this),bt(19))};function xo(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Lc(a,d){var g=null;if(a.g==d){xo(a),ds(a),a.g=null;var E=2}else if(je(a.h,d))g=d.D,li(a.h,d),E=1;else return;if(a.G!=0){if(d.o)if(E==1){g=d.m?d.m.length:0,d=Date.now()-d.F;var F=a.B;E=Mr(),Ye(E,new b(E,g)),Ls(a)}else Po(a);else if(F=d.s,F==3||F==0&&0<d.X||!(E==1&&Of(a,d)||E==2&&pi(a)))switch(g&&0<g.length&&(d=a.h,d.i=d.i.concat(g)),F){case 1:Os(a,5);break;case 4:Os(a,10);break;case 3:Os(a,6);break;default:Os(a,2)}}}function Ml(a,d){let g=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(g*=2),g*d}function Os(a,d){if(a.j.info("Error code "+d),d==2){var g=y(a.fb,a),E=a.Xa;const F=!E;E=new xs(E||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||wo(E,"https"),ha(E),F?Nf(E.toString(),g):Df(E.toString(),g)}else bt(2);a.G=0,a.l&&a.l.sa(d),Oc(a),bs(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Oc(a){if(a.G=0,a.ka=[],a.l){const d=yo(a.h);(d.length!=0||a.i.length!=0)&&(V(a.ka,d),V(a.ka,a.i),a.h.i.length=0,D(a.i),a.i.length=0),a.l.ra()}}function Vc(a,d,g){var E=g instanceof xs?cr(g):new xs(g);if(E.g!="")d&&(E.g=d+"."+E.g),Ll(E,E.s);else{var F=l.location;E=F.protocol,d=d?d+"."+F.hostname:F.hostname,F=+F.port;var z=new xs(null);E&&wo(z,E),d&&(z.g=d),F&&Ll(z,F),g&&(z.l=g),E=z}return g=a.D,d=a.ya,g&&d&&nt(E,g,d),nt(E,"VER",a.la),fi(a,E),E}function Mc(a,d,g){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new ot(new us({eb:g})):new ot(a.pa),d.Ha(a.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jc(){}t=jc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ya(){}ya.prototype.g=function(a,d){return new $n(a,d)};function $n(a,d){Pe.call(this),this.g=new bc(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!_(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!_(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new gi(this)}R($n,Pe),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){Fr(this.g)},$n.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.u&&(g={},g.__data__=Ir(a),a=g);d.i.push(new Ce(d.Ya++,a)),d.G==3&&Ls(d)},$n.prototype.N=function(){this.g.l=null,delete this.j,Fr(this.g),delete this.g,$n.aa.N.call(this)};function Fc(a){Qn.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const g in d){a=g;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}R(Fc,Qn);function mi(){Ar.call(this),this.status=1}R(mi,Ar);function gi(a){this.g=a}R(gi,jc),gi.prototype.ua=function(){Ye(this.g,"a")},gi.prototype.ta=function(a){Ye(this.g,new Fc(a))},gi.prototype.sa=function(a){Ye(this.g,new mi)},gi.prototype.ra=function(){Ye(this.g,"b")},ya.prototype.createWebChannel=ya.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,sI=function(){return new ya},rI=function(){return Mr()},nI=Dn,Nm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ie.NO_ERROR=0,ie.TIMEOUT=8,ie.HTTP_ERROR=6,Ld=ie,se.COMPLETE="complete",tI=se,Qt.EventType=Tt,Tt.OPEN="a",Tt.CLOSE="b",Tt.ERROR="c",Tt.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,au=Qt,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,eI=ot}).apply(typeof ud<"u"?ud:typeof self<"u"?self:typeof window<"u"?window:{});const ww="@firebase/firestore",Ew="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};jn.UNAUTHENTICATED=new jn(null),jn.GOOGLE_CREDENTIALS=new jn("google-credentials-uid"),jn.FIRST_PARTY=new jn("first-party-uid"),jn.MOCK_USER=new jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pl="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=new Gg("@firebase/firestore");function Ia(){return na.logLevel}function ce(t,...e){if(na.logLevel<=$e.DEBUG){const n=e.map(oy);na.debug(`Firestore (${Pl}): ${t}`,...n)}}function ti(t,...e){if(na.logLevel<=$e.ERROR){const n=e.map(oy);na.error(`Firestore (${Pl}): ${t}`,...n)}}function to(t,...e){if(na.logLevel<=$e.WARN){const n=e.map(oy);na.warn(`Firestore (${Pl}): ${t}`,...n)}}function oy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,iI(t,r,n)}function iI(t,e,n){let r=`FIRESTORE (${Pl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ti(r),new Error(r)}function Ge(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||iI(e,s,r)}function xe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends ai{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(jn.UNAUTHENTICATED))}shutdown(){}}class ib{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class ob{constructor(e){this.t=e,this.currentUser=jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ge(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Ts;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ts,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ts)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string",31837,{l:r}),new oI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string",2055,{h:e}),new jn(e)}}class ab{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=jn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class lb{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new ab(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Tw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ub{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ge(this.o===void 0,3512);const r=i=>{i.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Tw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ge(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Tw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=cb(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Oe(t,e){return t<e?-1:t>e?1:0}function Dm(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Oe(r,s);{const i=aI(),o=db(i.encode(Sw(t,n)),i.encode(Sw(e,n)));return o!==0?o:Oe(r,s)}}n+=r>65535?2:1}return Oe(t.length,e.length)}function Sw(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function db(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Oe(t[n],e[n]);return Oe(t.length,e.length)}function ml(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="__name__";class gs{constructor(e,n,r){n===void 0?n=0:n>e.length&&Te(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Te(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return gs.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof gs?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=gs.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Oe(e.length,n.length)}static compareSegments(e,n){const r=gs.isNumericId(e),s=gs.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?gs.extractNumericId(e).compare(gs.extractNumericId(n)):Dm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Yi.fromString(e.substring(4,e.length-2))}}class ht extends gs{construct(e,n,r){return new ht(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ht(n)}static emptyPath(){return new ht([])}}const hb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class In extends gs{construct(e,n,r){return new In(e,n,r)}static isValidIdentifier(e){return hb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),In.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Iw}static keyField(){return new In([Iw])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new oe(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new oe(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new oe(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new oe(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new In(n)}static emptyPath(){return new In([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(ht.fromString(e))}static fromName(e){return new we(ht.fromString(e).popFirst(5))}static empty(){return new we(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ht.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new ht(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t,e,n){if(!n)throw new oe(H.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function fb(t,e,n,r){if(e===!0&&r===!0)throw new oe(H.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Aw(t){if(!we.isDocumentKey(t))throw new oe(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rw(t){if(we.isDocumentKey(t))throw new oe(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function uI(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function uf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Te(12329,{type:typeof t})}function es(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=uf(t);throw new oe(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function pb(t,e){if(e<=0)throw new oe(H.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(t,e){const n={typeString:t};return e&&(n.value=e),n}function yc(t,e){if(!uI(t))throw new oe(H.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new oe(H.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw=-62135596800,Pw=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Pw);return new vt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Cw)throw new oe(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Pw}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yc(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Cw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:tn("string",vt._jsonSchemaVersion),seconds:tn("number"),nanoseconds:tn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new vt(0,0))}static max(){return new Ae(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu=-1;function mb(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Ae.fromTimestamp(r===1e9?new vt(n+1,0):new vt(n,r));return new no(s,we.empty(),e)}function gb(t){return new no(t.readTime,t.key,Xu)}class no{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new no(Ae.min(),we.empty(),Xu)}static max(){return new no(Ae.max(),we.empty(),Xu)}}function yb(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=we.comparator(t.documentKey,e.documentKey),n!==0?n:Oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _b{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xl(t){if(t.code!==H.FAILED_PRECONDITION||t.message!==vb)throw t;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new K((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof K?n:K.resolve(n)}catch(n){return K.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):K.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):K.reject(n)}static resolve(e){return new K((n,r)=>{n(e)})}static reject(e){return new K((n,r)=>{r(e)})}static waitFor(e){return new K((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=K.resolve(!1);for(const r of e)n=n.next(s=>s?K.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new K((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(h=>{o[c]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new K((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function wb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function kl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}cf.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=-1;function vc(t){return t==null}function Sh(t){return t===0&&1/t==-1/0}function Eb(t){return typeof t=="number"&&Number.isInteger(t)&&!Sh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="";function Tb(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=xw(e)),e=Sb(t.get(n),e);return xw(e)}function Sb(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case cI:n+="";break;default:n+=i}}return n}function xw(t){return t+cI+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function po(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function dI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){this.comparator=e,this.root=n||Sn.EMPTY}insert(e,n){return new kt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cd(this.root,e,this.comparator,!1)}getReverseIterator(){return new cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cd(this.root,e,this.comparator,!0)}}class cd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Sn.RED,this.left=s??Sn.EMPTY,this.right=i??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Sn(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Sn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Sn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.comparator=e,this.data=new kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Nw(this.data.getIterator())}getIteratorFrom(e){return new Nw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof dn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new dn(this.comparator);return n.data=e,n}}class Nw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.fields=e,e.sort(In.comparator)}static empty(){return new gr([])}unionWith(e){let n=new dn(In.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ml(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new hI("Invalid base64 string: "+i):i}}(e);return new Cn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Cn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const Ib=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){if(Ge(!!t,39018),typeof t=="string"){let e=0;const n=Ib.exec(t);if(Ge(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Bt(t.seconds),nanos:Bt(t.nanos)}}function Bt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function so(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="server_timestamp",pI="__type__",mI="__previous_value__",gI="__local_write_time__";function uy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[pI])===null||n===void 0?void 0:n.stringValue)===fI}function df(t){const e=t.mapValue.fields[mI];return uy(e)?df(e):e}function Zu(t){const e=ro(t.mapValue.fields[gI].timestampValue);return new vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,n,r,s,i,o,l,u,c,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=h}}const Ih="(default)";class ec{constructor(e,n){this.projectId=e,this.database=n||Ih}static empty(){return new ec("","")}get isDefaultDatabase(){return this.database===Ih}isEqual(e){return e instanceof ec&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="__type__",Rb="__max__",dd={mapValue:{}},vI="__vector__",Ah="value";function io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uy(t)?4:Pb(t)?9007199254740991:Cb(t)?10:11:Te(28295,{value:t})}function Rs(t,e){if(t===e)return!0;const n=io(t);if(n!==io(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zu(t).isEqual(Zu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ro(s.timestampValue),l=ro(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return so(s.bytesValue).isEqual(so(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Bt(s.geoPointValue.latitude)===Bt(i.geoPointValue.latitude)&&Bt(s.geoPointValue.longitude)===Bt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Bt(s.integerValue)===Bt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Bt(s.doubleValue),l=Bt(i.doubleValue);return o===l?Sh(o)===Sh(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ml(t.arrayValue.values||[],e.arrayValue.values||[],Rs);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(kw(o)!==kw(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Rs(o[u],l[u])))return!1;return!0}(t,e);default:return Te(52216,{left:t})}}function tc(t,e){return(t.values||[]).find(n=>Rs(n,e))!==void 0}function gl(t,e){if(t===e)return 0;const n=io(t),r=io(e);if(n!==r)return Oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Oe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Bt(i.integerValue||i.doubleValue),u=Bt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Dw(t.timestampValue,e.timestampValue);case 4:return Dw(Zu(t),Zu(e));case 5:return Dm(t.stringValue,e.stringValue);case 6:return function(i,o){const l=so(i),u=so(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const h=Oe(l[c],u[c]);if(h!==0)return h}return Oe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Oe(Bt(i.latitude),Bt(o.latitude));return l!==0?l:Oe(Bt(i.longitude),Bt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return bw(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,c,h;const f=i.fields||{},y=o.fields||{},T=(l=f[Ah])===null||l===void 0?void 0:l.arrayValue,R=(u=y[Ah])===null||u===void 0?void 0:u.arrayValue,D=Oe(((c=T==null?void 0:T.values)===null||c===void 0?void 0:c.length)||0,((h=R==null?void 0:R.values)===null||h===void 0?void 0:h.length)||0);return D!==0?D:bw(T,R)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===dd.mapValue&&o===dd.mapValue)return 0;if(i===dd.mapValue)return 1;if(o===dd.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),c=o.fields||{},h=Object.keys(c);u.sort(),h.sort();for(let f=0;f<u.length&&f<h.length;++f){const y=Dm(u[f],h[f]);if(y!==0)return y;const T=gl(l[u[f]],c[h[f]]);if(T!==0)return T}return Oe(u.length,h.length)}(t.mapValue,e.mapValue);default:throw Te(23264,{le:n})}}function Dw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Oe(t,e);const n=ro(t),r=ro(e),s=Oe(n.seconds,r.seconds);return s!==0?s:Oe(n.nanos,r.nanos)}function bw(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=gl(n[s],r[s]);if(i)return i}return Oe(n.length,r.length)}function yl(t){return bm(t)}function bm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ro(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return so(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return we.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=bm(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${bm(n.fields[o])}`;return s+"}"}(t.mapValue):Te(61005,{value:t})}function Od(t){switch(io(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=df(t);return e?16+Od(e):16;case 5:return 2*t.stringValue.length;case 6:return so(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Od(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return po(r.fields,(i,o)=>{s+=i.length+Od(o)}),s}(t.mapValue);default:throw Te(13486,{value:t})}}function Lw(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Lm(t){return!!t&&"integerValue"in t}function cy(t){return!!t&&"arrayValue"in t}function Ow(t){return!!t&&"nullValue"in t}function Vw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vd(t){return!!t&&"mapValue"in t}function Cb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[yI])===null||n===void 0?void 0:n.stringValue)===vI}function Su(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return po(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Su(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Su(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Pb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Rb}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.value=e}static empty(){return new qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Su(n)}setAll(e){let n=In.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Su(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Vd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Rs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Vd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){po(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new qn(Su(this.value))}}function _I(t){const e=[];return po(t.fields,(n,r)=>{const s=new In([n]);if(Vd(r)){const i=_I(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new gr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new yn(e,0,Ae.min(),Ae.min(),Ae.min(),qn.empty(),0)}static newFoundDocument(e,n,r,s){return new yn(e,1,n,Ae.min(),r,s,0)}static newNoDocument(e,n){return new yn(e,2,n,Ae.min(),Ae.min(),qn.empty(),0)}static newUnknownDocument(e,n){return new yn(e,3,n,Ae.min(),Ae.min(),qn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n){this.position=e,this.inclusive=n}}function Mw(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=we.comparator(we.fromName(o.referenceValue),n.key):r=gl(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function jw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Rs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,n="asc"){this.field=e,this.dir=n}}function xb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{}class en extends wI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Nb(e,n,r):n==="array-contains"?new Lb(e,r):n==="in"?new Ob(e,r):n==="not-in"?new Vb(e,r):n==="array-contains-any"?new Mb(e,r):new en(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Db(e,r):new bb(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(gl(n,this.value)):n!==null&&io(this.value)===io(n)&&this.matchesComparison(gl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends wI{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new ts(e,n)}matches(e){return EI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function EI(t){return t.op==="and"}function TI(t){return kb(t)&&EI(t)}function kb(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function Om(t){if(t instanceof en)return t.field.canonicalString()+t.op.toString()+yl(t.value);if(TI(t))return t.filters.map(e=>Om(e)).join(",");{const e=t.filters.map(n=>Om(n)).join(",");return`${t.op}(${e})`}}function SI(t,e){return t instanceof en?function(r,s){return s instanceof en&&r.op===s.op&&r.field.isEqual(s.field)&&Rs(r.value,s.value)}(t,e):t instanceof ts?function(r,s){return s instanceof ts&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&SI(o,s.filters[l]),!0):!1}(t,e):void Te(19439)}function II(t){return t instanceof en?function(n){return`${n.field.canonicalString()} ${n.op} ${yl(n.value)}`}(t):t instanceof ts?function(n){return n.op.toString()+" {"+n.getFilters().map(II).join(" ,")+"}"}(t):"Filter"}class Nb extends en{constructor(e,n,r){super(e,n,r),this.key=we.fromName(r.referenceValue)}matches(e){const n=we.comparator(e.key,this.key);return this.matchesComparison(n)}}class Db extends en{constructor(e,n){super(e,"in",n),this.keys=AI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class bb extends en{constructor(e,n){super(e,"not-in",n),this.keys=AI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function AI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>we.fromName(r.referenceValue))}class Lb extends en{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return cy(n)&&tc(n.arrayValue,this.value)}}class Ob extends en{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&tc(this.value.arrayValue,n)}}class Vb extends en{constructor(e,n){super(e,"not-in",n)}matches(e){if(tc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!tc(this.value.arrayValue,n)}}class Mb extends en{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!cy(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>tc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Pe=null}}function Fw(t,e=null,n=[],r=[],s=null,i=null,o=null){return new jb(t,e,n,r,s,i,o)}function dy(t){const e=xe(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Om(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),vc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>yl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>yl(r)).join(",")),e.Pe=n}return e.Pe}function hy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!xb(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!SI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!jw(t.startAt,e.startAt)&&jw(t.endAt,e.endAt)}function Vm(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Fb(t,e,n,r,s,i,o,l){return new Nl(t,e,n,r,s,i,o,l)}function fy(t){return new Nl(t)}function Uw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function RI(t){return t.collectionGroup!==null}function Iu(t){const e=xe(t);if(e.Te===null){e.Te=[];const n=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new dn(In.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Te.push(new nc(i,r))}),n.has(In.keyField().canonicalString())||e.Te.push(new nc(In.keyField(),r))}return e.Te}function Ss(t){const e=xe(t);return e.Ie||(e.Ie=Ub(e,Iu(t))),e.Ie}function Ub(t,e){if(t.limitType==="F")return Fw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new nc(s.field,i)});const n=t.endAt?new Rh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Rh(t.startAt.position,t.startAt.inclusive):null;return Fw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Mm(t,e){const n=t.filters.concat([e]);return new Nl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ch(t,e,n){return new Nl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hf(t,e){return hy(Ss(t),Ss(e))&&t.limitType===e.limitType}function CI(t){return`${dy(Ss(t))}|lt:${t.limitType}`}function Aa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>II(s)).join(", ")}]`),vc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>yl(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>yl(s)).join(",")),`Target(${r})`}(Ss(t))}; limitType=${t.limitType})`}function ff(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):we.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Iu(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const c=Mw(o,l,u);return o.inclusive?c<=0:c<0}(r.startAt,Iu(r),s)||r.endAt&&!function(o,l,u){const c=Mw(o,l,u);return o.inclusive?c>=0:c>0}(r.endAt,Iu(r),s))}(t,e)}function Bb(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function PI(t){return(e,n)=>{let r=!1;for(const s of Iu(t)){const i=$b(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function $b(t,e,n){const r=t.field.isKeyField()?we.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),c=l.data.field(i);return u!==null&&c!==null?gl(u,c):Te(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Te(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){po(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return dI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=new kt(we.comparator);function ni(){return zb}const xI=new kt(we.comparator);function lu(...t){let e=xI;for(const n of t)e=e.insert(n.key,n);return e}function kI(t){let e=xI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function zo(){return Au()}function NI(){return Au()}function Au(){return new ua(t=>t.toString(),(t,e)=>t.isEqual(e))}const qb=new kt(we.comparator),Hb=new dn(we.comparator);function ze(...t){let e=Hb;for(const n of t)e=e.add(n);return e}const Wb=new dn(Oe);function Kb(){return Wb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sh(e)?"-0":e}}function DI(t){return{integerValue:""+t}}function Gb(t,e){return Eb(e)?DI(e):py(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this._=void 0}}function Qb(t,e,n){return t instanceof rc?function(s,i){const o={fields:{[pI]:{stringValue:fI},[gI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&uy(i)&&(i=df(i)),i&&(o.fields[mI]=i),{mapValue:o}}(n,e):t instanceof sc?LI(t,e):t instanceof ic?OI(t,e):function(s,i){const o=bI(s,i),l=Bw(o)+Bw(s.Ee);return Lm(o)&&Lm(s.Ee)?DI(l):py(s.serializer,l)}(t,e)}function Yb(t,e,n){return t instanceof sc?LI(t,e):t instanceof ic?OI(t,e):n}function bI(t,e){return t instanceof Ph?function(r){return Lm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class rc extends pf{}class sc extends pf{constructor(e){super(),this.elements=e}}function LI(t,e){const n=VI(e);for(const r of t.elements)n.some(s=>Rs(s,r))||n.push(r);return{arrayValue:{values:n}}}class ic extends pf{constructor(e){super(),this.elements=e}}function OI(t,e){let n=VI(e);for(const r of t.elements)n=n.filter(s=>!Rs(s,r));return{arrayValue:{values:n}}}class Ph extends pf{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function Bw(t){return Bt(t.integerValue||t.doubleValue)}function VI(t){return cy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e,n){this.field=e,this.transform=n}}function Xb(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof sc&&s instanceof sc||r instanceof ic&&s instanceof ic?ml(r.elements,s.elements,Rs):r instanceof Ph&&s instanceof Ph?Rs(r.Ee,s.Ee):r instanceof rc&&s instanceof rc}(t.transform,e.transform)}class Zb{constructor(e,n){this.version=e,this.transformResults=n}}class vn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new vn}static exists(e){return new vn(void 0,e)}static updateTime(e){return new vn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Md(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mf{}function MI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new gf(t.key,vn.none()):new _c(t.key,t.data,vn.none());{const n=t.data,r=qn.empty();let s=new dn(In.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new mo(t.key,r,new gr(s.toArray()),vn.none())}}function e2(t,e,n){t instanceof _c?function(s,i,o){const l=s.value.clone(),u=zw(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof mo?function(s,i,o){if(!Md(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=zw(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(jI(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ru(t,e,n,r){return t instanceof _c?function(i,o,l,u){if(!Md(i.precondition,o))return l;const c=i.value.clone(),h=qw(i.fieldTransforms,u,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof mo?function(i,o,l,u){if(!Md(i.precondition,o))return l;const c=qw(i.fieldTransforms,u,o),h=o.data;return h.setAll(jI(i)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,l){return Md(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function t2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=bI(r.transform,s||null);i!=null&&(n===null&&(n=qn.empty()),n.set(r.field,i))}return n||null}function $w(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ml(r,s,(i,o)=>Xb(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _c extends mf{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class mo extends mf{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function jI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function zw(t,e,n){const r=new Map;Ge(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,Yb(o,l,n[s]))}return r}function qw(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Qb(i,o,e))}return r}class gf extends mf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FI extends mf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&e2(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ru(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ru(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=NI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=MI(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(Ae.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ze())}isEqual(e){return this.batchId===e.batchId&&ml(this.mutations,e.mutations,(n,r)=>$w(n,r))&&ml(this.baseMutations,e.baseMutations,(n,r)=>$w(n,r))}}class my{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ge(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return qb}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new my(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,Ke;function UI(t){switch(t){case H.OK:return Te(64938);case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0;default:return Te(15467,{code:t})}}function BI(t){if(t===void 0)return ti("GRPC error has no .code"),H.UNKNOWN;switch(t){case Jt.OK:return H.OK;case Jt.CANCELLED:return H.CANCELLED;case Jt.UNKNOWN:return H.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return H.INTERNAL;case Jt.UNAVAILABLE:return H.UNAVAILABLE;case Jt.UNAUTHENTICATED:return H.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case Jt.NOT_FOUND:return H.NOT_FOUND;case Jt.ALREADY_EXISTS:return H.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return H.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case Jt.ABORTED:return H.ABORTED;case Jt.OUT_OF_RANGE:return H.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return H.UNIMPLEMENTED;case Jt.DATA_LOSS:return H.DATA_LOSS;default:return Te(39323,{code:t})}}(Ke=Jt||(Jt={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=new Yi([4294967295,4294967295],0);function Hw(t){const e=aI().encode(t),n=new ZS;return n.update(e),new Uint8Array(n.digest())}function Ww(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Yi([n,r],0),new Yi([s,i],0)]}class gy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new uu(`Invalid padding: ${n}`);if(r<0)throw new uu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new uu(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new uu(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=Yi.fromNumber(this.fe)}pe(e,n,r){let s=e.add(n.multiply(Yi.fromNumber(r)));return s.compare(i2)===1&&(s=new Yi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=Hw(e),[r,s]=Ww(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);if(!this.ye(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new gy(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.fe===0)return;const n=Hw(e),[r,s]=Ww(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class uu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,wc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new yf(Ae.min(),s,new kt(Oe),ni(),ze())}}class wc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wc(r,n,ze(),ze(),ze())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=s}}class $I{constructor(e,n){this.targetId=e,this.De=n}}class zI{constructor(e,n,r=Cn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Kw{constructor(){this.ve=0,this.Ce=Gw(),this.Fe=Cn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ze(),n=ze(),r=ze();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Te(38017,{changeType:i})}}),new wc(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=Gw()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Ge(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class o2{constructor(e){this.We=e,this.Ge=new Map,this.ze=ni(),this.je=hd(),this.Je=hd(),this.He=new kt(Oe)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,s)=>{this.nt(s)&&n(s)})}it(e){const n=e.targetId,r=e.De.count,s=this.st(n);if(s){const i=s.target;if(Vm(i))if(r===0){const o=new we(i.path);this.Xe(n,o,yn.newNoDocument(o,Ae.min()))}else Ge(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const l=this._t(e),u=l?this.ut(l,e,o):1;if(u!==0){this.rt(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,c)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=so(r).toUint8Array()}catch(u){if(u instanceof hI)return to("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new gy(o,s,i)}catch(u){return to(u instanceof uu?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.fe===0?null:l}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.We.lt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Xe(n,i,null),s++)}),s}Pt(e){const n=new Map;this.Ge.forEach((i,o)=>{const l=this.st(o);if(l){if(i.current&&Vm(l.target)){const u=new we(l.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,yn.newNoDocument(u,e))}i.Ne&&(n.set(o,i.Le()),i.ke())}});let r=ze();this.Je.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const c=this.st(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ze.forEach((i,o)=>o.setReadTime(e));const s=new yf(e,n,this.He,this.ze,r);return this.ze=ni(),this.je=hd(),this.Je=hd(),this.He=new kt(Oe),s}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,n)?s.qe(n,1):s.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new Kw,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new dn(Oe),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new dn(Oe),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||ce("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Kw),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function hd(){return new kt(we.comparator)}function Gw(){return new kt(we.comparator)}const a2={asc:"ASCENDING",desc:"DESCENDING"},l2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},u2={and:"AND",or:"OR"};class c2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function jm(t,e){return t.useProto3Json||vc(e)?e:{value:e}}function xh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function d2(t,e){return xh(t,e.toTimestamp())}function vr(t){return Ge(!!t,49232),Ae.fromTimestamp(function(n){const r=ro(n);return new vt(r.seconds,r.nanos)}(t))}function yy(t,e){return Fm(t,e).canonicalString()}function Fm(t,e){const n=function(s){return new ht(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function HI(t){const e=ht.fromString(t);return Ge(JI(e),10190,{key:e.toString()}),e}function kh(t,e){return yy(t.databaseId,e.path)}function Cu(t,e){const n=HI(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new we(KI(n))}function WI(t,e){return yy(t.databaseId,e)}function h2(t){const e=HI(t);return e.length===4?ht.emptyPath():KI(e)}function Um(t){return new ht(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KI(t){return Ge(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Qw(t,e,n){return{name:kh(t,e),fields:n.value.mapValue.fields}}function f2(t,e){return"found"in e?function(r,s){Ge(!!s.found,43571),s.found.name,s.found.updateTime;const i=Cu(r,s.found.name),o=vr(s.found.updateTime),l=s.found.createTime?vr(s.found.createTime):Ae.min(),u=new qn({mapValue:{fields:s.found.fields}});return yn.newFoundDocument(i,o,l,u)}(t,e):"missing"in e?function(r,s){Ge(!!s.missing,3894),Ge(!!s.readTime,22933);const i=Cu(r,s.missing),o=vr(s.readTime);return yn.newNoDocument(i,o)}(t,e):Te(7234,{result:e})}function p2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Te(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,h){return c.useProto3Json?(Ge(h===void 0||typeof h=="string",58123),Cn.fromBase64String(h||"")):(Ge(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Cn.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const h=c.code===void 0?H.UNKNOWN:BI(c.code);return new oe(h,c.message||"")}(o);n=new zI(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Cu(t,r.document.name),i=vr(r.document.updateTime),o=r.document.createTime?vr(r.document.createTime):Ae.min(),l=new qn({mapValue:{fields:r.document.fields}}),u=yn.newFoundDocument(s,i,o,l),c=r.targetIds||[],h=r.removedTargetIds||[];n=new jd(c,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Cu(t,r.document),i=r.readTime?vr(r.readTime):Ae.min(),o=yn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new jd([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Cu(t,r.document),i=r.removedTargetIds||[];n=new jd([],i,s,null)}else{if(!("filter"in e))return Te(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new s2(s,i),l=r.targetId;n=new $I(l,o)}}return n}function GI(t,e){let n;if(e instanceof _c)n={update:Qw(t,e.key,e.value)};else if(e instanceof gf)n={delete:kh(t,e.key)};else if(e instanceof mo)n={update:Qw(t,e.key,e.data),updateMask:S2(e.fieldMask)};else{if(!(e instanceof FI))return Te(16599,{Rt:e.type});n={verify:kh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof rc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof sc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ic)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ph)return{fieldPath:o.field.canonicalString(),increment:l.Ee};throw Te(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:d2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Te(27497)}(t,e.precondition)),n}function m2(t,e){return t&&t.length>0?(Ge(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?vr(s.updateTime):vr(i);return o.isEqual(Ae.min())&&(o=vr(i)),new Zb(o,s.transformResults||[])}(n,e))):[]}function g2(t,e){return{documents:[WI(t,e.path)]}}function y2(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=WI(t,s);const i=function(c){if(c.length!==0)return YI(ts.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(h=>function(y){return{field:Ra(y.field),direction:w2(y.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=jm(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{Vt:n,parent:s}}function v2(t){let e=h2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ge(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const y=QI(f);return y instanceof ts&&TI(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(y=>function(R){return new nc(Ca(R.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(f){let y;return y=typeof f=="object"?f.value:f,vc(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(f){const y=!!f.before,T=f.values||[];return new Rh(T,y)}(n.startAt));let c=null;return n.endAt&&(c=function(f){const y=!f.before,T=f.values||[];return new Rh(T,y)}(n.endAt)),Fb(e,s,o,i,l,"F",u,c)}function _2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function QI(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ca(n.unaryFilter.field);return en.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ca(n.unaryFilter.field);return en.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ca(n.unaryFilter.field);return en.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ca(n.unaryFilter.field);return en.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(t):t.fieldFilter!==void 0?function(n){return en.create(Ca(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ts.create(n.compositeFilter.filters.map(r=>QI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(n.compositeFilter.op))}(t):Te(30097,{filter:t})}function w2(t){return a2[t]}function E2(t){return l2[t]}function T2(t){return u2[t]}function Ra(t){return{fieldPath:t.canonicalString()}}function Ca(t){return In.fromServerFormat(t.fieldPath)}function YI(t){return t instanceof en?function(n){if(n.op==="=="){if(Vw(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NAN"}};if(Ow(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Vw(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NOT_NAN"}};if(Ow(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ra(n.field),op:E2(n.op),value:n.value}}}(t):t instanceof ts?function(n){const r=n.getFilters().map(s=>YI(s));return r.length===1?r[0]:{compositeFilter:{op:T2(n.op),filters:r}}}(t):Te(54877,{filter:t})}function S2(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function JI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n,r,s,i=Ae.min(),o=Ae.min(),l=Cn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Vi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e){this.gt=e}}function A2(t){const e=v2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ch(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(){this.Dn=new C2}addToCollectionParentIndex(e,n){return this.Dn.add(n),K.resolve()}getCollectionParents(e,n){return K.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return K.resolve()}deleteFieldIndex(e,n){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,n){return K.resolve()}getDocumentsMatchingTarget(e,n){return K.resolve(null)}getIndexType(e,n){return K.resolve(0)}getFieldIndexes(e,n){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,n){return K.resolve(no.min())}getMinOffsetFromCollectionGroup(e,n){return K.resolve(no.min())}updateCollectionGroup(e,n,r){return K.resolve()}updateIndexEntries(e,n){return K.resolve()}}class C2{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new dn(ht.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new dn(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XI=41943040;class Zn{static withCacheSize(e){return new Zn(e,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn.DEFAULT_COLLECTION_PERCENTILE=10,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zn.DEFAULT=new Zn(XI,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zn.DISABLED=new Zn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new vl(0)}static ur(){return new vl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="LruGarbageCollector",P2=1048576;function Xw([t,e],[n,r]){const s=Oe(t,n);return s===0?Oe(e,r):s}class x2{constructor(e){this.Tr=e,this.buffer=new dn(Xw),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Xw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class k2{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ce(Jw,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){kl(n)?ce(Jw,"Ignoring IndexedDB error during garbage collection: ",n):await xl(n)}await this.Rr(3e5)})}}class N2{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return K.resolve(cf.ue);const r=new x2(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),K.resolve(Yw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yw):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,s,i,o,l,u,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,l=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),Ia()<=$e.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(c-u)+`ms
Total Duration: ${c-h}ms`),K.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function D2(t,e){return new N2(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(){this.changes=new ua(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?K.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ru(r.mutation,s,gr.empty(),vt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ze()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ze()){const s=zo();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=lu();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=zo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ze()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=ni();const o=Au(),l=function(){return Au()}();return n.forEach((u,c)=>{const h=r.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof mo)?i=i.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Ru(h.mutation,c,h.mutation.getFieldMask(),vt.now())):o.set(c.key,gr.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var f;return l.set(c,new L2(h,(f=o.get(c))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Au();let s=new kt((o,l)=>o-l),i=ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let h=r.get(u)||gr.empty();h=l.applyToLocalView(c,h),r.set(u,h);const f=(s.get(l.batchId)||ze()).add(u);s=s.insert(l.batchId,f)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,h=u.value,f=NI();h.forEach(y=>{if(!i.has(y)){const T=MI(n.get(y),r.get(y));T!==null&&f.set(y,T),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return K.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return we.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):K.resolve(zo());let l=Xu,u=i;return o.next(c=>K.forEach(c,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?K.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{u=u.insert(h,y)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,ze())).next(h=>({batchId:l,changes:kI(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new we(n)).next(r=>{let s=lu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=lu();return this.indexManager.getCollectionParents(e,i).next(l=>K.forEach(l,u=>{const c=function(f,y){return new Nl(y,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(h=>{h.forEach((f,y)=>{o=o.insert(f,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,yn.newInvalidDocument(h)))});let l=lu();return o.forEach((u,c)=>{const h=i.get(u);h!==void 0&&Ru(h.mutation,c,gr.empty(),vt.now()),ff(n,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return K.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(s){return{id:s.id,version:s.version,createTime:vr(s.createTime)}}(n)),K.resolve()}getNamedQuery(e,n){return K.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(s){return{name:s.name,query:A2(s.bundledQuery),readTime:vr(s.readTime)}}(n)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(){this.overlays=new kt(we.comparator),this.kr=new Map}getOverlay(e,n){return K.resolve(this.overlays.get(n))}getOverlays(e,n){const r=zo();return K.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.wt(e,n,i)}),K.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(r)),K.resolve()}getOverlaysForCollection(e,n,r){const s=zo(),i=n.length+1,o=new we(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return K.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new kt((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let h=i.get(c.largestBatchId);h===null&&(h=zo(),i=i.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const l=zo(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,h)=>l.set(c,h)),!(l.size()>=s)););return K.resolve(l)}wt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new r2(n,r));let i=this.kr.get(n);i===void 0&&(i=ze(),this.kr.set(n,i)),this.kr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(){this.qr=new dn(mn.Qr),this.$r=new dn(mn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new mn(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new mn(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new we(new ht([])),r=new mn(n,e),s=new mn(n,e+1),i=[];return this.$r.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new we(new ht([])),r=new mn(n,e),s=new mn(n,e+1);let i=ze();return this.$r.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new mn(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class mn{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return we.comparator(e.key,n.key)||Oe(e.Hr,n.Hr)}static Ur(e,n){return Oe(e.Hr,n.Hr)||we.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new dn(mn.Qr)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new n2(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Yr=this.Yr.add(new mn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,n){return K.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return K.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?ly:this.er-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new mn(n,0),s=new mn(n,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([r,s],o=>{const l=this.Zr(o.Hr);i.push(l)}),K.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new dn(Oe);return n.forEach(s=>{const i=new mn(s,0),o=new mn(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,o],l=>{r=r.add(l.Hr)})}),K.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;we.isDocumentKey(i)||(i=i.child(""));const o=new mn(new we(i),0);let l=new dn(Oe);return this.Yr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(l=l.add(u.Hr)),!0)},o),K.resolve(this.ei(l))}ei(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ge(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return K.forEach(n.mutations,s=>{const i=new mn(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new mn(n,0),s=this.Yr.firstAfterOrEqual(r);return K.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e){this.ni=e,this.docs=function(){return new kt(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return K.resolve(r?r.document.mutableCopy():yn.newInvalidDocument(n))}getEntries(e,n){let r=ni();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():yn.newInvalidDocument(s))}),K.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ni();const o=n.path,l=new we(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:h}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||yb(gb(h),r)<=0||(s.has(h.key)||ff(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return K.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Te(9500)}ri(e,n){return K.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new B2(this)}getSize(e){return K.resolve(this.size)}}class B2 extends b2{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),K.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e){this.persistence=e,this.ii=new ua(n=>dy(n),hy),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.si=0,this.oi=new vy,this.targetCount=0,this._i=vl.ar()}forEachTarget(e,n){return this.ii.forEach((r,s)=>n(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),K.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new vl(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,K.resolve()}updateTargetData(e,n){return this.hr(n),K.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ii.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),K.waitFor(i).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return K.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),K.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),K.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),K.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return K.resolve(r)}containsKey(e,n){return K.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n){this.ai={},this.overlays={},this.ui=new cf(0),this.ci=!1,this.ci=!0,this.li=new j2,this.referenceDelegate=e(this),this.hi=new $2(this),this.indexManager=new R2,this.remoteDocumentCache=function(s){return new U2(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new I2(n),this.Ti=new V2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new M2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new F2(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){ce("MemoryPersistence","Starting transaction:",e);const s=new z2(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return K.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class z2 extends _b{constructor(e){super(),this.currentSequenceNumber=e}}class _y{constructor(e){this.persistence=e,this.Ai=new vy,this.Ri=null}static Vi(e){return new _y(e)}get mi(){if(this.Ri)return this.Ri;throw Te(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),K.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),K.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.mi,r=>{const s=we.fromPath(r);return this.fi(e,s).next(i=>{i||n.removeEntry(s,Ae.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return K.or([()=>K.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class Nh{constructor(e,n){this.persistence=e,this.gi=new ua(r=>Tb(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=D2(this,n)}static Vi(e,n){return new Nh(e,n)}Ii(){}di(e){return K.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return K.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(i=>i?K.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,o=>this.Sr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,Ae.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),K.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),K.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),K.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),K.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Od(e.data.value)),n}Sr(e,n,r){return K.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.gi.get(n);return K.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=s}static Es(e,n){let r=ze(),s=ze();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new wy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return Rx()?8:wb(Bn())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ps(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ys(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new q2;return this.ws(e,n,o).next(l=>{if(i.result=l,this.Rs)return this.Ss(e,n,o,l.size)})}).next(()=>i.result)}Ss(e,n,r,s){return r.documentReadCount<this.Vs?(Ia()<=$e.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Aa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),K.resolve()):(Ia()<=$e.DEBUG&&ce("QueryEngine","Query:",Aa(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Ia()<=$e.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Aa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ss(n))):K.resolve())}ps(e,n){if(Uw(n))return K.resolve(null);let r=Ss(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ch(n,null,"F"),r=Ss(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ze(...i);return this.gs.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.bs(n,l);return this.Ds(n,c,o,u.readTime)?this.ps(e,Ch(n,null,"F")):this.vs(e,c,n,u)}))})))}ys(e,n,r,s){return Uw(n)||s.isEqual(Ae.min())?K.resolve(null):this.gs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ds(n,o,r,s)?K.resolve(null):(Ia()<=$e.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Aa(n)),this.vs(e,o,n,mb(s,Xu)).next(l=>l))})}bs(e,n){let r=new dn(PI(e));return n.forEach((s,i)=>{ff(e,i)&&(r=r.add(i))}),r}Ds(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,n,r){return Ia()<=$e.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Aa(n)),this.gs.getDocumentsMatchingQuery(e,n,no.min(),r)}vs(e,n,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey="LocalStore",W2=3e8;class K2{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.Fs=new kt(Oe),this.Ms=new ua(i=>dy(i),hy),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new O2(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function G2(t,e,n,r){return new K2(t,e,n,r)}async function eA(t,e){const n=xe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ze();for(const c of s){o.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}for(const c of i){l.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(c=>({Bs:c,removedBatchIds:o,addedBatchIds:l}))})})}function Q2(t,e){const n=xe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(l,u,c,h){const f=c.batch,y=f.keys();let T=K.resolve();return y.forEach(R=>{T=T.next(()=>h.getEntry(u,R)).next(D=>{const V=c.docVersions.get(R);Ge(V!==null,48541),D.version.compareTo(V)<0&&(f.applyToRemoteDocument(D,c),D.isValidDocument()&&(D.setReadTime(c.commitVersion),h.addEntry(D)))})}),T.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ze();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function tA(t){const e=xe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function Y2(t,e){const n=xe(t),r=e.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const l=[];e.targetChanges.forEach((h,f)=>{const y=s.get(f);if(!y)return;l.push(n.hi.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.hi.addMatchingKeys(i,h.addedDocuments,f)));let T=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?T=T.withResumeToken(Cn.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):h.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(h.resumeToken,r)),s=s.insert(f,T),function(D,V,P){return D.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=W2?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(y,T,h)&&l.push(n.hi.updateTargetData(i,T))});let u=ni(),c=ze();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(J2(i,o,e.documentUpdates).next(h=>{u=h.Ls,c=h.ks})),!r.isEqual(Ae.min())){const h=n.hi.getLastRemoteSnapshotVersion(i).next(f=>n.hi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return K.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.Fs=s,i))}function J2(t,e,n){let r=ze(),s=ze();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ni();return n.forEach((l,u)=>{const c=i.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(Ae.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):ce(Ey,"Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{Ls:o,ks:s}})}function X2(t,e){const n=xe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ly),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Z2(t,e){const n=xe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.hi.getTargetData(r,e).next(i=>i?(s=i,K.resolve(s)):n.hi.allocateTargetId(r).next(o=>(s=new Vi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function Bm(t,e,n){const r=xe(t),s=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!kl(o))throw o;ce(Ey,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function Zw(t,e,n){const r=xe(t);let s=Ae.min(),i=ze();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,h){const f=xe(u),y=f.Ms.get(h);return y!==void 0?K.resolve(f.Fs.get(y)):f.hi.getTargetData(c,h)}(r,o,Ss(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:Ae.min(),n?i:ze())).next(l=>(eL(r,Bb(e),l),{documents:l,qs:i})))}function eL(t,e,n){let r=t.xs.get(e)||Ae.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.xs.set(e,r)}class e0{constructor(){this.activeTargetIds=Kb()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tL{constructor(){this.Fo=new e0,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new e0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0="ConnectivityMonitor";class n0{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ce(t0,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ce(t0,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fd=null;function $m(){return fd===null?fd=function(){return 268435456+Math.round(2147483648*Math.random())}():fd++,"0x"+fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p="RestConnection",rL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sL{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===Ih?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=$m(),l=this.Go(e,n.toUriEncodedString());ce(_p,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,s,i);const{host:c}=new URL(l),h=Il(c);return this.jo(e,l,u,r,h).then(f=>(ce(_p,`Received RPC '${e}' ${o}: `,f),f),f=>{throw to(_p,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",r),f})}Jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Go(e,n){const r=rL[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn="WebChannelConnection";class oL extends sL{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,s,i){const o=$m();return new Promise((l,u)=>{const c=new eI;c.setWithCredentials(!0),c.listenOnce(tI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ld.NO_ERROR:const f=c.getResponseJson();ce(Mn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case Ld.TIMEOUT:ce(Mn,`RPC '${e}' ${o} timed out`),u(new oe(H.DEADLINE_EXCEEDED,"Request time out"));break;case Ld.HTTP_ERROR:const y=c.getStatus();if(ce(Mn,`RPC '${e}' ${o} failed with status:`,y,"response text:",c.getResponseText()),y>0){let T=c.getResponseJson();Array.isArray(T)&&(T=T[0]);const R=T==null?void 0:T.error;if(R&&R.status&&R.message){const D=function(P){const _=P.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(_)>=0?_:H.UNKNOWN}(R.status);u(new oe(D,R.message))}else u(new oe(H.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new oe(H.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{c_:e,streamId:o,l_:c.getLastErrorCode(),h_:c.getLastError()})}}finally{ce(Mn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);ce(Mn,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",h,r,15)})}P_(e,n,r){const s=$m(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sI(),l=rI(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");ce(Mn,`Creating RPC '${e}' stream ${s}: ${h}`,u);const f=o.createWebChannel(h,u);this.T_(f);let y=!1,T=!1;const R=new iL({Ho:V=>{T?ce(Mn,`Not sending because RPC '${e}' stream ${s} is closed:`,V):(y||(ce(Mn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),y=!0),ce(Mn,`RPC '${e}' stream ${s} sending:`,V),f.send(V))},Yo:()=>f.close()}),D=(V,P,_)=>{V.listen(P,x=>{try{_(x)}catch(j){setTimeout(()=>{throw j},0)}})};return D(f,au.EventType.OPEN,()=>{T||(ce(Mn,`RPC '${e}' stream ${s} transport opened.`),R.s_())}),D(f,au.EventType.CLOSE,()=>{T||(T=!0,ce(Mn,`RPC '${e}' stream ${s} transport closed`),R.__(),this.I_(f))}),D(f,au.EventType.ERROR,V=>{T||(T=!0,to(Mn,`RPC '${e}' stream ${s} transport errored. Name:`,V.name,"Message:",V.message),R.__(new oe(H.UNAVAILABLE,"The operation could not be completed")))}),D(f,au.EventType.MESSAGE,V=>{var P;if(!T){const _=V.data[0];Ge(!!_,16349);const x=_,j=(x==null?void 0:x.error)||((P=x[0])===null||P===void 0?void 0:P.error);if(j){ce(Mn,`RPC '${e}' stream ${s} received error:`,j);const q=j.status;let W=function(A){const I=Jt[A];if(I!==void 0)return BI(I)}(q),v=j.message;W===void 0&&(W=H.INTERNAL,v="Unknown error status: "+q+" with message "+j.message),T=!0,R.__(new oe(W,v)),f.close()}else ce(Mn,`RPC '${e}' stream ${s} received:`,_),R.a_(_)}}),D(l,nI.STAT_EVENT,V=>{V.stat===Nm.PROXY?ce(Mn,`RPC '${e}' stream ${s} detected buffering proxy`):V.stat===Nm.NOPROXY&&ce(Mn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.o_()},0),R}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function wp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t){return new c2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,n-r);s>0&&ce("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0="PersistentStream";class nA{constructor(e,n,r,s,i,o,l,u){this.Fi=e,this.w_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Ty(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===H.RESOURCE_EXHAUSTED?(ti(n.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===n&&this.W_(r,s)},r=>{e(()=>{const s=new oe(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return ce(r0,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(ce(r0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class aL extends nA{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=p2(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ae.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ae.min():o.readTime?vr(o.readTime):Ae.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=Um(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=Vm(u)?{documents:g2(i,u)}:{query:y2(i,u).Vt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=qI(i,o.resumeToken);const c=jm(i,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(Ae.min())>0){l.readTime=xh(i,o.snapshotVersion.toTimestamp());const c=jm(i,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const r=_2(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=Um(this.serializer),n.removeTarget=e,this.k_(n)}}class lL extends nA{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return Ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=m2(e.writeResults,e.commitTime),r=vr(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=Um(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>GI(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{}class cL extends uL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new oe(H.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Fm(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new oe(H.UNKNOWN,i.toString())})}Jo(e,n,r,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Jo(e,Fm(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(H.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class dL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ti(n),this._a=!1):ce("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="RemoteStore";class hL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{ca(this)&&(ce(ra,"Restarting streams for network reachability change."),await async function(u){const c=xe(u);c.Ia.add(4),await Ec(c),c.Aa.set("Unknown"),c.Ia.delete(4),await _f(c)}(this))})}),this.Aa=new dL(r,s)}}async function _f(t){if(ca(t))for(const e of t.da)await e(!0)}async function Ec(t){for(const e of t.da)await e(!1)}function rA(t,e){const n=xe(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Ry(n)?Ay(n):Dl(n).x_()&&Iy(n,e))}function Sy(t,e){const n=xe(t),r=Dl(n);n.Ta.delete(e),r.x_()&&sA(n,e),n.Ta.size===0&&(r.x_()?r.B_():ca(n)&&n.Aa.set("Unknown"))}function Iy(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Dl(t).H_(e)}function sA(t,e){t.Ra.$e(e),Dl(t).Y_(e)}function Ay(t){t.Ra=new o2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Dl(t).start(),t.Aa.aa()}function Ry(t){return ca(t)&&!Dl(t).M_()&&t.Ta.size>0}function ca(t){return xe(t).Ia.size===0}function iA(t){t.Ra=void 0}async function fL(t){t.Aa.set("Online")}async function pL(t){t.Ta.forEach((e,n)=>{Iy(t,e)})}async function mL(t,e){iA(t),Ry(t)?(t.Aa.la(e),Ay(t)):t.Aa.set("Unknown")}async function gL(t,e,n){if(t.Aa.set("Online"),e instanceof zI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ta.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ta.delete(l),s.Ra.removeTarget(l))}(t,e)}catch(r){ce(ra,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Dh(t,r)}else if(e instanceof jd?t.Ra.Ye(e):e instanceof $I?t.Ra.it(e):t.Ra.et(e),!n.isEqual(Ae.min()))try{const r=await tA(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Ra.Pt(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.Ta.get(c);h&&i.Ta.set(c,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const h=i.Ta.get(u);if(!h)return;i.Ta.set(u,h.withResumeToken(Cn.EMPTY_BYTE_STRING,h.snapshotVersion)),sA(i,u);const f=new Vi(h.target,u,c,h.sequenceNumber);Iy(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ce(ra,"Failed to raise snapshot:",r),await Dh(t,r)}}async function Dh(t,e,n){if(!kl(e))throw e;t.Ia.add(1),await Ec(t),t.Aa.set("Offline"),n||(n=()=>tA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ce(ra,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await _f(t)})}function oA(t,e){return e().catch(n=>Dh(t,n,e))}async function wf(t){const e=xe(t),n=oo(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:ly;for(;yL(e);)try{const s=await X2(e.localStore,r);if(s===null){e.Pa.length===0&&n.B_();break}r=s.batchId,vL(e,s)}catch(s){await Dh(e,s)}aA(e)&&lA(e)}function yL(t){return ca(t)&&t.Pa.length<10}function vL(t,e){t.Pa.push(e);const n=oo(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function aA(t){return ca(t)&&!oo(t).M_()&&t.Pa.length>0}function lA(t){oo(t).start()}async function _L(t){oo(t).na()}async function wL(t){const e=oo(t);for(const n of t.Pa)e.X_(n.mutations)}async function EL(t,e,n){const r=t.Pa.shift(),s=my.from(r,e,n);await oA(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await wf(t)}async function TL(t,e){e&&oo(t).Z_&&await async function(r,s){if(function(o){return UI(o)&&o!==H.ABORTED}(s.code)){const i=r.Pa.shift();oo(r).N_(),await oA(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await wf(r)}}(t,e),aA(t)&&lA(t)}async function s0(t,e){const n=xe(t);n.asyncQueue.verifyOperationInProgress(),ce(ra,"RemoteStore received new credentials");const r=ca(n);n.Ia.add(3),await Ec(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await _f(n)}async function SL(t,e){const n=xe(t);e?(n.Ia.delete(2),await _f(n)):e||(n.Ia.add(2),await Ec(n),n.Aa.set("Unknown"))}function Dl(t){return t.Va||(t.Va=function(n,r,s){const i=xe(n);return i.ia(),new aL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:fL.bind(null,t),e_:pL.bind(null,t),n_:mL.bind(null,t),J_:gL.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Ry(t)?Ay(t):t.Aa.set("Unknown")):(await t.Va.stop(),iA(t))})),t.Va}function oo(t){return t.ma||(t.ma=function(n,r,s){const i=xe(n);return i.ia(),new lL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:_L.bind(null,t),n_:TL.bind(null,t),ea:wL.bind(null,t),ta:EL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await wf(t)):(await t.ma.stop(),t.Pa.length>0&&(ce(ra,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ts,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Cy(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Py(t,e){if(ti("AsyncQueue",`${e}: ${t}`),kl(t))return new oe(H.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{static emptySet(e){return new Za(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||we.comparator(n.key,r.key):(n,r)=>we.comparator(n.key,r.key),this.keyedMap=lu(),this.sortedSet=new kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Za)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Za;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.fa=new kt(we.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):Te(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class _l{constructor(e,n,r,s,i,o,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new _l(e,n,Za.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class AL{constructor(){this.queries=o0(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const s=xe(n),i=s.queries;s.queries=o0(),i.forEach((o,l)=>{for(const u of l.wa)u.onError(r)})})(this,new oe(H.ABORTED,"Firestore shutting down"))}}function o0(){return new ua(t=>CI(t),hf)}async function uA(t,e){const n=xe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.ba()&&(r=2):(i=new IL,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Py(o,`Initialization of query '${Aa(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&xy(n)}async function cA(t,e){const n=xe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.wa.indexOf(e);o>=0&&(i.wa.splice(o,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function RL(t,e){const n=xe(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.wa)l.Ca(s)&&(r=!0);o.ya=s}}r&&xy(n)}function CL(t,e,n){const r=xe(t),s=r.queries.get(e);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(e)}function xy(t){t.Da.forEach(e=>{e.next()})}var zm,a0;(a0=zm||(zm={})).Fa="default",a0.Cache="cache";class dA{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new _l(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=_l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==zm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(e){this.key=e}}class fA{constructor(e){this.key=e}}class PL{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ze(),this.mutatedKeys=ze(),this.Xa=PI(e),this.eu=new Za(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new i0,s=n?n.eu:this.eu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const y=s.get(h),T=ff(this.query,f)?f:null,R=!!y&&this.mutatedKeys.has(y.key),D=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let V=!1;y&&T?y.data.isEqual(T.data)?R!==D&&(r.track({type:3,doc:T}),V=!0):this.iu(y,T)||(r.track({type:2,doc:T}),V=!0,(u&&this.Xa(T,u)>0||c&&this.Xa(T,c)<0)&&(l=!0)):!y&&T?(r.track({type:0,doc:T}),V=!0):y&&!T&&(r.track({type:1,doc:y}),V=!0,(u||c)&&(l=!0)),V&&(T?(o=o.add(T),i=D?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:l,mutatedKeys:i}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((h,f)=>function(T,R){const D=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{At:V})}};return D(T)-D(R)}(h.type,f.type)||this.Xa(h.doc,f.doc)),this.su(r),s=s!=null&&s;const l=n&&!s?this.ou():[],u=this.Za.size===0&&this.current&&!s?1:0,c=u!==this.Ya;return this.Ya=u,o.length!==0||c?{snapshot:new _l(this.query,e.eu,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:l}:{_u:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new i0,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ze(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new fA(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new hA(r))}),n}uu(e){this.Ha=e.qs,this.Za=ze();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return _l.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const ky="SyncEngine";class xL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class kL{constructor(e){this.key=e,this.lu=!1}}class NL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new ua(l=>CI(l),hf),this.Tu=new Map,this.Iu=new Set,this.du=new kt(we.comparator),this.Eu=new Map,this.Au=new vy,this.Ru={},this.Vu=new Map,this.mu=vl.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function DL(t,e,n=!0){const r=_A(t);let s;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await pA(r,e,n,!0),s}async function bL(t,e){const n=_A(t);await pA(n,e,!0,!1)}async function pA(t,e,n,r){const s=await Z2(t.localStore,Ss(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await LL(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&rA(t.remoteStore,s),l}async function LL(t,e,n,r,s){t.gu=(f,y,T)=>async function(D,V,P,_){let x=V.view.nu(P);x.Ds&&(x=await Zw(D.localStore,V.query,!1).then(({documents:v})=>V.view.nu(v,x)));const j=_&&_.targetChanges.get(V.targetId),q=_&&_.targetMismatches.get(V.targetId)!=null,W=V.view.applyChanges(x,D.isPrimaryClient,j,q);return u0(D,V.targetId,W._u),W.snapshot}(t,f,y,T);const i=await Zw(t.localStore,e,!0),o=new PL(e,i.qs),l=o.nu(i.documents),u=wc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(l,t.isPrimaryClient,u);u0(t,n,c._u);const h=new xL(e,n,o);return t.Pu.set(e,h),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),c.snapshot}async function OL(t,e,n){const r=xe(t),s=r.Pu.get(e),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(o=>!hf(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Bm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Sy(r.remoteStore,s.targetId),qm(r,s.targetId)}).catch(xl)):(qm(r,s.targetId),await Bm(r.localStore,s.targetId,!0))}async function VL(t,e){const n=xe(t),r=n.Pu.get(e),s=n.Tu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Sy(n.remoteStore,r.targetId))}async function ML(t,e,n){const r=qL(t);try{const s=await function(o,l){const u=xe(o),c=vt.now(),h=l.reduce((T,R)=>T.add(R.key),ze());let f,y;return u.persistence.runTransaction("Locally write mutations","readwrite",T=>{let R=ni(),D=ze();return u.Os.getEntries(T,h).next(V=>{R=V,R.forEach((P,_)=>{_.isValidDocument()||(D=D.add(P))})}).next(()=>u.localDocuments.getOverlayedDocuments(T,R)).next(V=>{f=V;const P=[];for(const _ of l){const x=t2(_,f.get(_.key).overlayedDocument);x!=null&&P.push(new mo(_.key,x,_I(x.value.mapValue),vn.exists(!0)))}return u.mutationQueue.addMutationBatch(T,c,P,l)}).next(V=>{y=V;const P=V.applyToLocalDocumentSet(f,D);return u.documentOverlayCache.saveOverlays(T,V.batchId,P)})}).then(()=>({batchId:y.batchId,changes:kI(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let c=o.Ru[o.currentUser.toKey()];c||(c=new kt(Oe)),c=c.insert(l,u),o.Ru[o.currentUser.toKey()]=c}(r,s.batchId,n),await Tc(r,s.changes),await wf(r.remoteStore)}catch(s){const i=Py(s,"Failed to persist write");n.reject(i)}}async function mA(t,e){const n=xe(t);try{const r=await Y2(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Eu.get(i);o&&(Ge(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.lu=!0:s.modifiedDocuments.size>0?Ge(o.lu,14607):s.removedDocuments.size>0&&(Ge(o.lu,42227),o.lu=!1))}),await Tc(n,r,e)}catch(r){await xl(r)}}function l0(t,e,n){const r=xe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Pu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=xe(o);u.onlineState=l;let c=!1;u.queries.forEach((h,f)=>{for(const y of f.wa)y.va(l)&&(c=!0)}),c&&xy(u)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function jL(t,e,n){const r=xe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let o=new kt(we.comparator);o=o.insert(i,yn.newNoDocument(i,Ae.min()));const l=ze().add(i),u=new yf(Ae.min(),new Map,new kt(Oe),o,l);await mA(r,u),r.du=r.du.remove(i),r.Eu.delete(e),Ny(r)}else await Bm(r.localStore,e,!1).then(()=>qm(r,e,n)).catch(xl)}async function FL(t,e){const n=xe(t),r=e.batch.batchId;try{const s=await Q2(n.localStore,e);yA(n,r,null),gA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Tc(n,s)}catch(s){await xl(s)}}async function UL(t,e,n){const r=xe(t);try{const s=await function(o,l){const u=xe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return u.mutationQueue.lookupMutationBatch(c,l).next(f=>(Ge(f!==null,37113),h=f.keys(),u.mutationQueue.removeMutationBatch(c,f))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>u.localDocuments.getDocuments(c,h))})}(r.localStore,e);yA(r,e,n),gA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Tc(r,s)}catch(s){await xl(s)}}function gA(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function yA(t,e,n){const r=xe(t);let s=r.Ru[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function qm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||vA(t,r)})}function vA(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Sy(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),Ny(t))}function u0(t,e,n){for(const r of n)r instanceof hA?(t.Au.addReference(r.key,e),BL(t,r)):r instanceof fA?(ce(ky,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||vA(t,r.key)):Te(19791,{yu:r})}function BL(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(ce(ky,"New document in limbo: "+n),t.Iu.add(r),Ny(t))}function Ny(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new we(ht.fromString(e)),r=t.mu.next();t.Eu.set(r,new kL(n)),t.du=t.du.insert(n,r),rA(t.remoteStore,new Vi(Ss(fy(n.path)),r,"TargetPurposeLimboResolution",cf.ue))}}async function Tc(t,e,n){const r=xe(t),s=[],i=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((l,u)=>{o.push(r.gu(u,e,n).then(c=>{var h;if((c||n)&&r.isPrimaryClient){const f=c?!c.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(c){s.push(c);const f=wy.Es(u.targetId,c);i.push(f)}}))}),await Promise.all(o),r.hu.J_(s),await async function(u,c){const h=xe(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>K.forEach(c,y=>K.forEach(y.Is,T=>h.persistence.referenceDelegate.addReference(f,y.targetId,T)).next(()=>K.forEach(y.ds,T=>h.persistence.referenceDelegate.removeReference(f,y.targetId,T)))))}catch(f){if(!kl(f))throw f;ce(Ey,"Failed to update sequence numbers: "+f)}for(const f of c){const y=f.targetId;if(!f.fromCache){const T=h.Fs.get(y),R=T.snapshotVersion,D=T.withLastLimboFreeSnapshotVersion(R);h.Fs=h.Fs.insert(y,D)}}}(r.localStore,i))}async function $L(t,e){const n=xe(t);if(!n.currentUser.isEqual(e)){ce(ky,"User change. New user:",e.toKey());const r=await eA(n.localStore,e);n.currentUser=e,function(i,o){i.Vu.forEach(l=>{l.forEach(u=>{u.reject(new oe(H.CANCELLED,o))})}),i.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Tc(n,r.Bs)}}function zL(t,e){const n=xe(t),r=n.Eu.get(e);if(r&&r.lu)return ze().add(r.key);{let s=ze();const i=n.Tu.get(e);if(!i)return s;for(const o of i){const l=n.Pu.get(o);s=s.unionWith(l.view.tu)}return s}}function _A(t){const e=xe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=mA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jL.bind(null,e),e.hu.J_=RL.bind(null,e.eventManager),e.hu.pu=CL.bind(null,e.eventManager),e}function qL(t){const e=xe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=FL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=UL.bind(null,e),e}class bh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vf(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return G2(this.persistence,new H2,e.initialUser,this.serializer)}Du(e){return new ZI(_y.Vi,this.serializer)}bu(e){return new tL}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bh.provider={build:()=>new bh};class HL extends bh{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){Ge(this.persistence.referenceDelegate instanceof Nh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new k2(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?Zn.withCacheSize(this.cacheSizeBytes):Zn.DEFAULT;return new ZI(r=>Nh.Vi(r,n),this.serializer)}}class Hm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>l0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$L.bind(null,this.syncEngine),await SL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AL}()}createDatastore(e){const n=vf(e.databaseInfo.databaseId),r=function(i){return new oL(i)}(e.databaseInfo);return function(i,o,l,u){return new cL(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new hL(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>l0(this.syncEngine,n,0),function(){return n0.C()?new n0:new nL}())}createSyncEngine(e,n){return function(s,i,o,l,u,c,h){const f=new NL(s,i,o,l,u,c);return h&&(f.fu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=xe(s);ce(ra,"RemoteStore shutting down."),i.Ia.add(5),await Ec(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Hm.provider={build:()=>new Hm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ti("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new oe(H.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=xe(s),l={documents:i.map(f=>kh(o.serializer,f))},u=await o.Jo("BatchGetDocuments",o.serializer.databaseId,ht.emptyPath(),l,i.length),c=new Map;u.forEach(f=>{const y=f2(o.serializer,f);c.set(y.key.toString(),y)});const h=[];return i.forEach(f=>{const y=c.get(f.toString());Ge(!!y,55234,{key:f}),h.push(y)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new gf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=we.fromPath(r);this.mutations.push(new FI(s,this.precondition(s)))}),await async function(r,s){const i=xe(r),o={writes:s.map(l=>GI(i.serializer,l))};await i.Wo("Commit",i.serializer.databaseId,ht.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Te(50498,{Wu:e.constructor.name});n=Ae.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new oe(H.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ae.min())?vn.exists(!1):vn.updateTime(n):vn.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ae.min()))throw new oe(H.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vn.updateTime(n)}return vn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Gu=r.maxAttempts,this.F_=new Ty(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new WL(this.datastore),n=this.Ju(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Hu(s)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{const n=this.updateFunction(e);return!vc(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!UI(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao="FirestoreClient";class GL{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=jn.UNAUTHENTICATED,this.clientId=ay.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ce(ao,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ce(ao,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ts;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Py(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ep(t,e){t.asyncQueue.verifyOperationInProgress(),ce(ao,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await eA(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{to("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{ce("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{to("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function c0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await QL(t);ce(ao,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>s0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>s0(e.remoteStore,s)),t._onlineComponents=e}async function QL(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ce(ao,"Using user provided OfflineComponentProvider");try{await Ep(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;to("Error using user provided cache. Falling back to memory cache: "+n),await Ep(t,new bh)}}else ce(ao,"Using default OfflineComponentProvider"),await Ep(t,new HL(void 0));return t._offlineComponents}async function Dy(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ce(ao,"Using user provided OnlineComponentProvider"),await c0(t,t._uninitializedComponentsProvider._online)):(ce(ao,"Using default OnlineComponentProvider"),await c0(t,new Hm))),t._onlineComponents}function YL(t){return Dy(t).then(e=>e.syncEngine)}function JL(t){return Dy(t).then(e=>e.datastore)}async function EA(t){const e=await Dy(t),n=e.eventManager;return n.onListen=DL.bind(null,e.syncEngine),n.onUnlisten=OL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=bL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=VL.bind(null,e.syncEngine),n}function XL(t,e,n={}){const r=new Ts;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const h=new wA({next:y=>{h.Ou(),o.enqueueAndForget(()=>cA(i,f));const T=y.docs.has(l);!T&&y.fromCache?c.reject(new oe(H.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&y.fromCache&&u&&u.source==="server"?c.reject(new oe(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(y)},error:y=>c.reject(y)}),f=new dA(fy(l.path),h,{includeMetadataChanges:!0,ka:!0});return uA(i,f)}(await EA(t),t.asyncQueue,e,n,r)),r.promise}function ZL(t,e,n={}){const r=new Ts;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const h=new wA({next:y=>{h.Ou(),o.enqueueAndForget(()=>cA(i,f)),y.fromCache&&u.source==="server"?c.reject(new oe(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(y)},error:y=>c.reject(y)}),f=new dA(l,h,{includeMetadataChanges:!0,ka:!0});return uA(i,f)}(await EA(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA="firestore.googleapis.com",h0=!0;class f0{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=SA,this.ssl=h0}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:h0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<P2)throw new oe(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new oe(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new oe(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new oe(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new f0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new f0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new sb;switch(r.type){case"firstParty":return new lb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=d0.get(n);r&&(ce("ComponentProvider","Removing Datastore"),d0.delete(n),r.terminate())}(this),Promise.resolve()}}function eO(t,e,n,r={}){var s;t=es(t,Ef);const i=Il(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;i&&(dS(`https://${u}`),hS("Firestore",!0)),o.host!==SA&&o.host!==u&&to("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:u,ssl:i,emulatorOptions:r});if(!Zo(c,l)&&(t._setSettings(c),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=jn.MOCK_USER;else{h=yx(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new oe(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new jn(y)}t._authCredentials=new ib(new oI(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new go(this.firestore,e,this._query)}}class Vt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vt(this.firestore,e,this._key)}toJSON(){return{type:Vt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(yc(n,Vt._jsonSchema))return new Vt(e,r||null,new we(ht.fromString(n.referencePath)))}}Vt._jsonSchemaVersion="firestore/documentReference/1.0",Vt._jsonSchema={type:tn("string",Vt._jsonSchemaVersion),referencePath:tn("string")};class Ji extends go{constructor(e,n,r){super(e,n,fy(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vt(this.firestore,null,new we(e))}withConverter(e){return new Ji(this.firestore,e,this._path)}}function el(t,e,...n){if(t=Mt(t),lI("collection","path",e),t instanceof Ef){const r=ht.fromString(e,...n);return Rw(r),new Ji(t,null,r)}{if(!(t instanceof Vt||t instanceof Ji))throw new oe(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ht.fromString(e,...n));return Rw(r),new Ji(t.firestore,null,r)}}function $t(t,e,...n){if(t=Mt(t),arguments.length===1&&(e=ay.newId()),lI("doc","path",e),t instanceof Ef){const r=ht.fromString(e,...n);return Aw(r),new Vt(t,null,new we(r))}{if(!(t instanceof Vt||t instanceof Ji))throw new oe(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ht.fromString(e,...n));return Aw(r),new Vt(t.firestore,t instanceof Ji?t.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="AsyncQueue";class m0{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Ty(this,"async_queue_retry"),this.oc=()=>{const r=wp();r&&ce(p0,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=wp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=wp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new Ts;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!kl(e))throw e;ce(p0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ti("INTERNAL UNHANDLED ERROR: ",g0(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const s=Cy.createAndSchedule(this,e,n,r,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&Te(47125,{hc:g0(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function g0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class da extends Ef{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new m0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new m0(e),this._firestoreClient=void 0,await e}}}function Or(t,e){const n=typeof t=="object"?t:gS(),r=typeof t=="string"?t:Ih,s=Yg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=mx("firestore");i&&eO(s,...i)}return s}function Sc(t){if(t._terminated)throw new oe(H.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tO(t),t._firestoreClient}function tO(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,c,h){return new Ab(l,u,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,TA(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new GL(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pr(Cn.fromBase64String(e))}catch(n){throw new oe(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new pr(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yc(e,pr._jsonSchema))return pr.fromBase64String(e.bytes)}}pr._jsonSchemaVersion="firestore/bytes/1.0",pr._jsonSchema={type:tn("string",pr._jsonSchemaVersion),bytes:tn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new In(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Is._jsonSchemaVersion}}static fromJSON(e){if(yc(e,Is._jsonSchema))return new Is(e.latitude,e.longitude)}}Is._jsonSchemaVersion="firestore/geoPoint/1.0",Is._jsonSchema={type:tn("string",Is._jsonSchemaVersion),latitude:tn("number"),longitude:tn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:As._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yc(e,As._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new As(e.vectorValues);throw new oe(H.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}As._jsonSchemaVersion="firestore/vectorValue/1.0",As._jsonSchema={type:tn("string",As._jsonSchemaVersion),vectorValues:tn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=/^__.*__$/;class rO{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new mo(e,this.data,this.fieldMask,n,this.fieldTransforms):new _c(e,this.data,n,this.fieldTransforms)}}class IA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new mo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function AA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ec:t})}}class by{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new by(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Lh(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(AA(this.Ec)&&nO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class sO{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||vf(e)}Dc(e,n,r,s=!1){return new by({Ec:e,methodName:n,bc:r,path:In.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ic(t){const e=t._freezeSettings(),n=vf(t._databaseId);return new sO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ly(t,e,n,r,s,i={}){const o=t.Dc(i.merge||i.mergeFields?2:0,e,n,s);jy("Data must be an object, but it was:",o,r);const l=RA(r,o);let u,c;if(i.merge)u=new gr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const y=Wm(e,f,n);if(!o.contains(y))throw new oe(H.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);PA(h,y)||h.push(y)}u=new gr(h),c=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,c=o.fieldTransforms;return new rO(new qn(l),u,c)}class Sf extends Tf{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sf}}class Oy extends Tf{_toFieldTransform(e){return new Jb(e.path,new rc)}isEqual(e){return e instanceof Oy}}function Vy(t,e,n,r){const s=t.Dc(1,e,n);jy("Data must be an object, but it was:",s,r);const i=[],o=qn.empty();po(r,(u,c)=>{const h=Fy(e,u,n);c=Mt(c);const f=s.gc(h);if(c instanceof Sf)i.push(h);else{const y=Ac(c,f);y!=null&&(i.push(h),o.set(h,y))}});const l=new gr(i);return new IA(o,l,s.fieldTransforms)}function My(t,e,n,r,s,i){const o=t.Dc(1,e,n),l=[Wm(e,r,n)],u=[s];if(i.length%2!=0)throw new oe(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)l.push(Wm(e,i[y])),u.push(i[y+1]);const c=[],h=qn.empty();for(let y=l.length-1;y>=0;--y)if(!PA(c,l[y])){const T=l[y];let R=u[y];R=Mt(R);const D=o.gc(T);if(R instanceof Sf)c.push(T);else{const V=Ac(R,D);V!=null&&(c.push(T),h.set(T,V))}}const f=new gr(c);return new IA(h,f,o.fieldTransforms)}function iO(t,e,n,r=!1){return Ac(n,t.Dc(r?4:3,e))}function Ac(t,e){if(CA(t=Mt(t)))return jy("Unsupported field value:",e,t),RA(t,e);if(t instanceof Tf)return function(r,s){if(!AA(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=Ac(l,s.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Gb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=vt.fromDate(r);return{timestampValue:xh(s.serializer,i)}}if(r instanceof vt){const i=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xh(s.serializer,i)}}if(r instanceof Is)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pr)return{bytesValue:qI(s.serializer,r._byteString)};if(r instanceof Vt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:yy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof As)return function(o,l){return{mapValue:{fields:{[yI]:{stringValue:vI},[Ah]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.wc("VectorValues must only contain numeric values.");return py(l.serializer,c)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${uf(r)}`)}(t,e)}function RA(t,e){const n={};return dI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):po(t,(r,s)=>{const i=Ac(s,e.Vc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function CA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof Is||t instanceof pr||t instanceof Vt||t instanceof Tf||t instanceof As)}function jy(t,e,n){if(!CA(n)||!uI(n)){const r=uf(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function Wm(t,e,n){if((e=Mt(e))instanceof bl)return e._internalPath;if(typeof e=="string")return Fy(t,e);throw Lh("Field path arguments must be of type string or ",t,!1,void 0,n)}const oO=new RegExp("[~\\*/\\[\\]]");function Fy(t,e,n){if(e.search(oO)>=0)throw Lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new bl(...e.split("."))._internalPath}catch{throw Lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Lh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new oe(H.INVALID_ARGUMENT,l+t+u)}function PA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new aO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(If("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class aO extends Oh{data(){return super.data()}}function If(t,e){return typeof e=="string"?Fy(t,e):e instanceof bl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Uy{}class By extends Uy{}function Km(t,e,...n){let r=[];e instanceof Uy&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof $y).length,l=i.filter(u=>u instanceof Af).length;if(o>1||o>0&&l>0)throw new oe(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Af extends By{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Af(e,n,r)}_apply(e){const n=this._parse(e);return NA(e._query,n),new go(e.firestore,e.converter,Mm(e._query,n))}_parse(e){const n=Ic(e.firestore);return function(i,o,l,u,c,h,f){let y;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new oe(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){_0(f,h);const R=[];for(const D of f)R.push(v0(u,i,D));y={arrayValue:{values:R}}}else y=v0(u,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||_0(f,h),y=iO(l,o,f,h==="in"||h==="not-in");return en.create(c,h,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function y0(t,e,n){const r=e,s=If("where",t);return Af._create(s,r,n)}class $y extends Uy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new $y(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ts.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)NA(o,u),o=Mm(o,u)}(e._query,n),new go(e.firestore,e.converter,Mm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zy extends By{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new zy(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new oe(H.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new oe(H.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nc(i,o)}(e._query,this._field,this._direction);return new go(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Nl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function xA(t,e="asc"){const n=e,r=If("orderBy",t);return zy._create(r,n)}class qy extends By{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new qy(e,n,r)}_apply(e){return new go(e.firestore,e.converter,Ch(e._query,this._limit,this._limitType))}}function kA(t){return pb("limit",t),qy._create("limit",t,"F")}function v0(t,e,n){if(typeof(n=Mt(n))=="string"){if(n==="")throw new oe(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!RI(e)&&n.indexOf("/")!==-1)throw new oe(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ht.fromString(n));if(!we.isDocumentKey(r))throw new oe(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Lw(t,new we(r))}if(n instanceof Vt)return Lw(t,n._key);throw new oe(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(n)}.`)}function _0(t,e){if(!Array.isArray(t)||t.length===0)throw new oe(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NA(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new oe(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class DA{convertValue(e,n="none"){switch(io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(so(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return po(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[Ah].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Bt(o.doubleValue));return new As(i)}convertGeoPoint(e){return new Is(Bt(e.latitude),Bt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=df(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Zu(e));default:return null}}convertTimestamp(e){const n=ro(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ht.fromString(e);Ge(JI(r),9688,{name:e});const s=new ec(r.get(1),r.get(3)),i=new we(r.popFirst(5));return s.isEqual(n)||ti(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class uO extends DA{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,n)}}class $a{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xi extends Oh{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(If("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(H.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Xi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Xi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xi._jsonSchema={type:tn("string",Xi._jsonSchemaVersion),bundleSource:tn("string","DocumentSnapshot"),bundleName:tn("string"),bundle:tn("string")};class Fd extends Xi{data(e={}){return super.data(e)}}class tl{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new $a(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Fd(this._firestore,this._userDataWriter,r.key,r,new $a(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Fd(s._firestore,s._userDataWriter,l.doc.key,l.doc,new $a(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Fd(s._firestore,s._userDataWriter,l.doc.key,l.doc,new $a(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,h=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:cO(l.type),doc:u,oldIndex:c,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(H.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ay.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function cO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){t=es(t,Vt);const e=es(t.firestore,da);return XL(Sc(e),t._key).then(n=>dO(e,t,n))}tl._jsonSchemaVersion="firestore/querySnapshot/1.0",tl._jsonSchema={type:tn("string",tl._jsonSchemaVersion),bundleSource:tn("string","QuerySnapshot"),bundleName:tn("string"),bundle:tn("string")};class Wy extends DA{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,n)}}function nl(t){t=es(t,go);const e=es(t.firestore,da),n=Sc(e),r=new Wy(e);return lO(t._query),ZL(n,t._query).then(s=>new tl(e,r,t,s))}function Ky(t,e,n){t=es(t,Vt);const r=es(t.firestore,da),s=Hy(t.converter,e,n);return Gy(r,[Ly(Ic(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,vn.none())])}function za(t,e,n,...r){t=es(t,Vt);const s=es(t.firestore,da),i=Ic(s);let o;return o=typeof(e=Mt(e))=="string"||e instanceof bl?My(i,"updateDoc",t._key,e,n,r):Vy(i,"updateDoc",t._key,e),Gy(s,[o.toMutation(t._key,vn.exists(!0))])}function Gy(t,e){return function(r,s){const i=new Ts;return r.asyncQueue.enqueueAndForget(async()=>ML(await YL(r),s,i)),i.promise}(Sc(t),e)}function dO(t,e,n){const r=n.docs.get(e._key),s=new Wy(t);return new Xi(t,s,e._key,r,new $a(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ic(e)}set(e,n,r){this._verifyNotCommitted();const s=Mi(e,this._firestore),i=Hy(s.converter,n,r),o=Ly(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,vn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Mi(e,this._firestore);let o;return o=typeof(n=Mt(n))=="string"||n instanceof bl?My(this._dataReader,"WriteBatch.update",i._key,n,r,s):Vy(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,vn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Mi(e,this._firestore);return this._mutations=this._mutations.concat(new gf(n._key,vn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new oe(H.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Mi(t,e){if((t=Mt(t)).firestore!==e)throw new oe(H.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ic(e)}get(e){const n=Mi(e,this._firestore),r=new uO(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Te(24041);const i=s[0];if(i.isFoundDocument())return new Oh(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Oh(this._firestore,r,n._key,null,n.converter);throw Te(18433,{doc:i})})}set(e,n,r){const s=Mi(e,this._firestore),i=Hy(s.converter,n,r),o=Ly(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=Mi(e,this._firestore);let o;return o=typeof(n=Mt(n))=="string"||n instanceof bl?My(this._dataReader,"Transaction.update",i._key,n,r,s):Vy(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Mi(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO extends pO{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Mi(e,this._firestore),r=new Wy(this._firestore);return super.get(e).then(s=>new Xi(this._firestore,r,n._key,s._document,new $a(!1,!1),n.converter))}}function gO(t,e,n){t=es(t,da);const r=Object.assign(Object.assign({},hO),n);return function(i){if(i.maxAttempts<1)throw new oe(H.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,l){const u=new Ts;return i.asyncQueue.enqueueAndForget(async()=>{const c=await JL(i);new KL(i.asyncQueue,c,l,o,u).zu()}),u.promise}(Sc(t),s=>e(new mO(t,s)),r)}function Ai(){return new Oy("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t){return Sc(t=es(t,da)),new fO(t,e=>Gy(t,e))}(function(e,n=!0){(function(s){Pl=s})(Al),fl(new ea("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new da(new ob(r.getProvider("auth-internal")),new ub(o,r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new oe(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ec(c.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Gi(ww,Ew,e),Gi(ww,Ew,"esm2017")})();var yO="firebase",vO="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gi(yO,vO,"app");const _O={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCsA_tvgGymEmVSIELEZBIZwFaDcBlw6SE",VITE_FIREBASE_APP_ID:"1:797655912645:web:fb50562a97ac96a98d60ac",VITE_FIREBASE_AUTH_DOMAIN:"rak-material-requests.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"797655912645",VITE_FIREBASE_PROJECT_ID:"rak-material-requests",VITE_FIREBASE_STORAGE_BUCKET:"rak-material-requests.firebasestorage.app"};function Ta(t){const e=_O[`VITE_${t}`];if(!e)throw new Error(`Missing environment variable: VITE_${t}`);return e}function wO(){const t={apiKey:Ta("FIREBASE_API_KEY"),authDomain:Ta("FIREBASE_AUTH_DOMAIN"),projectId:Ta("FIREBASE_PROJECT_ID"),storageBucket:Ta("FIREBASE_STORAGE_BUCKET"),messagingSenderId:Ta("FIREBASE_MESSAGING_SENDER_ID"),appId:Ta("FIREBASE_APP_ID")},e=Lk(),n=e.length?e[0]:mS(t),r=lf(n);return zN(r,qS),Or(n),{app:n}}const LA=C.createContext({user:null,role:null,loading:!0,hasConfig:!1});function EO({children:t}){const[{user:e,role:n,loading:r,hasConfig:s},i]=C.useState({user:null,role:null,loading:!0,hasConfig:!1}),o=l=>{if(!l)return null;const u=Array.isArray(l.departmentIds)?Array.from(new Set(l.departmentIds.map(h=>(h||"").trim()).filter(Boolean))):[],c=l.roles||{};return{...l,departmentIds:u,roles:c}};return C.useEffect(()=>{const{app:l}=wO();if(!l){i(f=>({...f,loading:!1,hasConfig:!1}));return}const u=lf(l),c=Or(l),h=WN(u,async f=>{if(f){const y=await sa($t(c,"roles",f.uid));i({user:f,role:y.exists()?o(y.data()):null,loading:!1,hasConfig:!0})}else i({user:null,role:null,loading:!1,hasConfig:!0})});return()=>h()},[]),p.jsx(LA.Provider,{value:{user:e,role:n,loading:r,hasConfig:s},children:t})}const ns=()=>C.useContext(LA);function TO(t){return/.+@.+\..+/.test(t)}function SO(){const[t,e]=C.useState(""),[n,r]=C.useState(""),[s,i]=C.useState(null),[o,l]=C.useState(!1),u=oi(),{user:c}=ns();C.useEffect(()=>{c&&u("/")},[c]);const h=async f=>{f.preventDefault(),i(null);const y=t.trim(),T=n;if(!y)return i("Username not found");if(!T)return i("Password is required");l(!0);try{let R=y;if(!TO(y)){const D=Or(),V=y.toLowerCase(),P=await sa($t(D,"usernames",V));if(!P.exists()){i("Username not found");return}if(R=(P.data().email||"").toString(),!R){i("Username not found");return}}await $N(lf(),R,T),u("/")}catch(R){switch((R==null?void 0:R.code)||(R==null?void 0:R.message)){case"auth/user-not-found":i("User not found");break;case"auth/wrong-password":case"auth/invalid-credential":i("Wrong password");break;case"auth/invalid-email":i("Invalid email address");break;case"auth/too-many-requests":i("Too many attempts. Try again later.");break;case"permission-denied":case"auth/permission-denied":i("Permission denied");break;default:i("Could not sign in. Please check your credentials.")}}finally{l(!1)}};return p.jsx("div",{className:"min-h-[calc(100vh-3.5rem)] flex items-center justify-center p-4",children:p.jsxs("div",{className:"card w-full max-w-md p-6",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[p.jsx("img",{src:"/logo.svg",alt:"logo",className:"h-8 w-8"}),p.jsx("h1",{className:"text-2xl font-semibold",children:"RAK Inventory Management System"})]}),p.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Sign-in only. Ask admin to provision your account."}),p.jsxs("form",{onSubmit:h,className:"space-y-3",children:[p.jsx("input",{className:"input",autoFocus:!0,type:"text",placeholder:"Email or Username",value:t,onChange:f=>e(f.target.value)}),p.jsx("input",{className:"input",type:"password",placeholder:"Password",value:n,onChange:f=>r(f.target.value)}),p.jsx("button",{type:"submit",disabled:o,className:"btn-primary w-full",children:o?"":"Sign in"})]}),s&&p.jsx("p",{className:"text-red-600 text-sm mt-3",children:s})]})})}function OA(t,e){const n=(t==null?void 0:t.fullName)&&String(t.fullName).trim();if(n)return n;if(e!=null&&e.displayName)return e.displayName;const r=(e==null?void 0:e.email)||"";return r?r.split("@")[0]:""}function IO(t){return String(t||"").trim()}function AO(t){const e=new Set;return t.forEach(n=>{const r=IO(n);r&&e.add(r)}),Array.from(e)}function w0(t){if(!t)return 0;if(typeof t=="number")return t;if(typeof t=="string"){const e=Date.parse(t);return Number.isFinite(e)?e:0}return typeof t.toMillis=="function"?t.toMillis():typeof t.seconds=="number"?t.seconds*1e3+Math.floor((t.nanoseconds||0)/1e6):0}async function VA(t,e,n=50,r){const s=Or(),i=el(s,"requests"),o=Math.max(n,200),l=[],u=new Map,c=async(f,y)=>{try{const T=y?Km(i,...f,xA("updatedAt","desc"),kA(o)):Km(i,...f);(await nl(T)).docs.forEach(D=>{u.has(D.id)||u.set(D.id,{id:D.id,...D.data()})})}catch(T){(T==null?void 0:T.code)!=="permission-denied"&&console.warn("fetchVisibleRequests query skipped",f,T)}};if(e.isAdmin||e.inStoreDept)l.push({constraints:[],ordered:!0});else{const f=AO(t),y=e.isAdmin||e.inStoreDept||e.storeOfficer||e.isDeptManager||e.isRequester;f.length&&y&&["deptIndex","lineDeptIds","departmentsInvolved","visibleDepts"].forEach(R=>{f.forEach(D=>{l.push({constraints:[y0(R,"array-contains",D)],ordered:!1})})}),r&&l.push({constraints:[y0("createdBy.uid","==",r)],ordered:!1})}return l.length?(await Promise.all(l.map(f=>c(f.constraints,f.ordered))),Array.from(u.values()).sort((f,y)=>w0(y.updatedAt)-w0(f.updatedAt)).slice(0,n)):[]}async function RO(t=25){const e=Or(),n=Km(el(e,"items"),xA("itemCode","asc"),kA(t));return(await nl(n)).docs.map(s=>({id:s.id,...s.data()}))}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),MA=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var PO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xO=C.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},u)=>C.createElement("svg",{ref:u,...PO,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:MA("lucide",s),...l},[...o.map(([c,h])=>C.createElement(c,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=(t,e)=>{const n=C.forwardRef(({className:r,...s},i)=>C.createElement(xO,{ref:i,iconNode:e,className:MA(`lucide-${CO(t)}`,r),...s}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=Gn("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=Gn("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Gn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=Gn("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=Gn("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=Gn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=Gn("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=Gn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=Gn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=Gn("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=Gn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=Gn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=Gn("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=Gn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=Gn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Tp={};async function FO(t){const e=Or(),n=await nl(el(e,t)),r={};return n.docs.forEach(s=>{r[s.id]={id:s.id,...s.data()}}),r}function rl(t){Tp[t]||(Tp[t]={data:null,promise:null});const e=Tp[t],[n,r]=C.useState(()=>e.data||{}),[s,i]=C.useState(()=>!e.data);return C.useEffect(()=>{let o=!0;return e.data?(r(e.data),i(!1),()=>{o=!1}):(e.promise||(e.promise=FO(t)),e.promise.then(l=>{e.data=l,o&&(r(l),i(!1))}).catch(()=>{o&&i(!1)}),()=>{o=!1})},[t]),{data:n,loading:s}}function UO(t){return Array.isArray(t==null?void 0:t.lines)?t.lines:[]}function Pa(t){var e;return((e=t==null?void 0:t.createdBy)==null?void 0:e.departmentId)||(t==null?void 0:t.fromDept)||""}function md(t){return Array.isArray(t==null?void 0:t.lineDeptIds)&&t.lineDeptIds.length?t.lineDeptIds:Array.isArray(t==null?void 0:t.departmentsInvolved)&&t.departmentsInvolved.length?t.departmentsInvolved:[]}function cu(t,e={}){const n=t!=null&&t.projectId?e[t.projectId]:null;return(n==null?void 0:n.nameEn)||(n==null?void 0:n.nameAr)||(n==null?void 0:n.name)||(t==null?void 0:t.projectNameEn)||(t==null?void 0:t.projectNameAr)||(t==null?void 0:t.projectName)||""}function du(t,e={}){const n=t!=null&&t.engineerId?e[t.engineerId]:null;return(n==null?void 0:n.nameEn)||(n==null?void 0:n.nameAr)||(t==null?void 0:t.engineerNameEn)||(t==null?void 0:t.engineerNameAr)||""}function BO(t,e){const n=t!=null&&t.itemId?e[t.itemId]:null;return(n==null?void 0:n.nameEn)||(n==null?void 0:n.nameAr)||(n==null?void 0:n.name)||(t==null?void 0:t.itemName)||(t==null?void 0:t.itemId)||""}function Gm(t,e={}){const{items:n={},dept:r=null,deptList:s=[],limit:i}=e,o=r?[r]:s.filter(Boolean),l=o.length?new Set(o):null,u=[];return UO(t).forEach(c=>{if(l&&!l.has(c.ownerDeptId))return;const h=BO(c,n);h&&u.push(h)}),typeof i=="number"?u.slice(0,i):u}function $O(){var q,W,v,m,A;const{user:t,role:e}=ns(),n=OA(e,t),r=oi(),s=Or(),[i,o]=C.useState(null),[l,u]=C.useState(!0),{data:c}=rl("items"),{data:h}=rl("projects"),{data:f}=rl("engineers"),y=(e==null?void 0:e.departmentIds)||[],T=!!((q=e==null?void 0:e.roles)!=null&&q.storeOfficer),R=((e==null?void 0:e.departmentIds)||[]).includes("Store"),D=!!((W=e==null?void 0:e.roles)!=null&&W.admin),V=!!((v=e==null?void 0:e.roles)!=null&&v.requester),P=!!((m=e==null?void 0:e.roles)!=null&&m.deptManager),_=!!((A=e==null?void 0:e.roles)!=null&&A.requester);C.useEffect(()=>{R&&!D&&r("/requests",{replace:!0})},[R,D]),C.useEffect(()=>{(async()=>{u(!0);try{o(await VA(y,{storeOfficer:T,inStoreDept:R,isAdmin:D,isDeptManager:P,isRequester:_},20,(t==null?void 0:t.uid)||void 0))}catch{o([])}finally{u(!1)}})()},[T,R,D,P,_,(y||[]).join(",")]);const x=C.useMemo(()=>{if(i===null)return null;const I=(t==null?void 0:t.uid)||"",N=i.filter(k=>{var ke;return String(k.status||k.stage||"").toUpperCase()!=="DRAFT"?!0:!!I&&((ke=k.createdBy)==null?void 0:ke.uid)===I}),L=k=>{const de=k.updatedAt;if(de!=null&&de.toMillis)return de.toMillis();if(de!=null&&de.seconds)return de.seconds*1e3;const ke=k.createdAt;return ke!=null&&ke.toMillis?ke.toMillis():ke!=null&&ke.seconds?ke.seconds*1e3:0};return N.sort((k,de)=>L(de)-L(k))},[i,t==null?void 0:t.uid]);async function j(I){try{if(t!=null&&t.uid){const N={};N[`readBy.${t.uid}`]=Ai(),await za($t(s,"requests",I.id),N)}}catch{}r(`/requests/new?rq=${I.id}`)}return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"hero-card",children:[p.jsxs("div",{className:"hero-title",children:["Welcome, ",n,"."]}),p.jsx("div",{className:"hero-meta",children:((e==null?void 0:e.departmentIds)||[]).join(" - ")||"-"}),(e==null?void 0:e.roles)&&p.jsx("div",{className:"hero-badges",children:Object.entries(e.roles).filter(([I,N])=>N).map(([I])=>p.jsx("span",{className:"badge-light",children:I},I))})]}),p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("div",{className:"text-base font-semibold",children:"Recent requests"}),p.jsx(mh,{to:"/requests",className:"text-sm underline",children:"Show all"})]}),l?p.jsx("div",{className:"card p-6",children:"Loading..."}):p.jsx("div",{className:"rq-strip overflow-x-auto -mx-1 sm:-mx-2 lg:-mx-3",children:p.jsxs("div",{className:"flex gap-3 p-1 sm:p-2 lg:p-3",children:[V&&p.jsx(mh,{to:"/requests/new",className:"rq-card rq-blue min-w-[208px] flex flex-col items-center justify-center text-center border-dashed hover:bg-gray-50",children:p.jsxs("div",{className:"flex items-center gap-3 text-blue-700",children:[p.jsx(UA,{className:"h-6 w-6"}),p.jsx("div",{className:"text-base font-semibold",children:"New Request"})]})}),x===null?p.jsx("div",{className:"rq-card min-w-[520px] animate-pulse"}):x.length===0?p.jsx("div",{className:"rq-card min-w-[520px] flex items-center justify-center text-gray-500",children:"No recent requests"}):x.map(I=>{var qt,jt,Ue;const N=!!I.urgent,L=y[0],k=t!=null&&t.uid?!((qt=I==null?void 0:I.readBy)!=null&&qt[t.uid]):!1,de=k?"rq-unread":N?"rq-urgent":"rq-blue",ke=I.rqCode||I.code||I.id,wt=cu(I,h),gt=du(I,f),G=I.stage||I.status||"SUBMITTED",ye=!!((jt=e==null?void 0:e.roles)!=null&&jt.storeOfficer)||((e==null?void 0:e.departmentIds)||[]).includes("Store")?G==="FULLY_APPROVED"?"Preparing":G==="STORE_PREPARING"?"Complete":"Open":"Approve",Ee=`badge-status status-${String(G).toLowerCase().replace(/\s+/g,"_")}`,Ie=k||N?"action-equal action-onblue":"action-equal action-onwhite",be=Pa(I),Ne=!L||L===be,Xe=Gm(I,{items:c,limit:20}),Qe=L?Gm(I,{items:c,dept:L,limit:20}):[],ct=Ne?Xe:Qe,Tr=ct.length?ct.join(", "):"-";return p.jsxs("button",{onClick:()=>j(I),className:`${de} rq-card min-w-[416px] text-left justify-between`,children:[p.jsxs("div",{children:[p.jsx("div",{className:"rq-title mb-1",children:ke}),p.jsx("p",{className:"rq-meta whitespace-normal break-words",children:[`${be||"-"} - ${((Ue=I.createdBy)==null?void 0:Ue.fullName)||"-"}`,wt,gt].filter(Boolean).join(" - ")}),p.jsx("div",{className:"rq-meta mt-1 clamp-2",children:Tr})]}),p.jsxs("div",{className:"rq-footer",children:[p.jsx("span",{className:Ee,children:G}),p.jsx("span",{className:Ie,children:ye})]})]},I.id)})]})}),p.jsx("div",{className:"card p-6 text-gray-500",children:"Dashboard (coming soon)"})]})}const E0=["DRAFT","SUBMITTED","DEPT_REVIEW","PARTIALLY_APPROVED","FULLY_APPROVED","STORE_PREPARING","READY","CLOSED","REJECTED","CANCELED"],T0=["FULLY_APPROVED","STORE_PREPARING","READY","CLOSED"],qo="  ";function zO(t){if(!t)return"-";const e=t!=null&&t.toDate?t.toDate():t instanceof Date?t:null;if(!e)return"-";const n=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),s=e.getFullYear();let i=e.getHours();const o=String(e.getMinutes()).padStart(2,"0"),l=i>=12?"PM":"AM";i=i%12,i===0&&(i=12);const u=String(i).padStart(2,"0");return`${n}-${r}-${s} ${u}:${o} ${l}`}function S0(t){return String(t??"").replace(/\u2022/g,qo).replace(/\uFFFD/g,qo).replace(/\s*\/\s*/g,qo).replace(/\s+/g," ").trim()}function qO(){var Cs,bt,b,O;const{role:t,user:e}=ns(),n=oi(),r=Or(),s=(t==null?void 0:t.departmentIds)||[],i=s.join(","),o=C.useMemo(()=>(s||[]).filter(S=>!!S),[i]),l=C.useMemo(()=>new Set(o),[i]),u=!!((Cs=t==null?void 0:t.roles)!=null&&Cs.storeOfficer),c=((t==null?void 0:t.departmentIds)||[]).includes("Store"),h=!!((bt=t==null?void 0:t.roles)!=null&&bt.admin),f=!!((b=t==null?void 0:t.roles)!=null&&b.deptManager),y=!!((O=t==null?void 0:t.roles)!=null&&O.requester),T=(e==null?void 0:e.uid)||"",[R,D]=C.useState([]),[V,P]=C.useState(""),[_,x]=C.useState(()=>{try{const S=localStorage.getItem("requests.filters");if(S){const M=JSON.parse(S);if(Array.isArray(M.statuses))return M.statuses.filter(B=>E0.includes(B))}}catch{}return[]}),[j,q]=C.useState(1),W=20,[v,m]=C.useState("updatedAt"),[A,I]=C.useState("desc"),[N,L]=C.useState(()=>{try{const S=localStorage.getItem("requests.filters");if(S){const M=JSON.parse(S);if(Array.isArray(M.columns))return M.columns.filter(B=>typeof B=="string")}}catch{}return["createdBy","fromDept","forDept"]}),[k,de]=C.useState(!1),[ke,wt]=C.useState(!1),[gt,G]=C.useState(!1),[ue,ye]=C.useState(""),[Se,Ee]=C.useState(""),[Ie,be]=C.useState(new Date().getFullYear()),[Ne,Xe]=C.useState(new Date().getMonth()+1),[Qe,ct]=C.useState(""),Tr=C.useRef(null),qt=C.useRef(null),jt=C.useRef(null);sS();const[Ue,Et]=C.useState(!0),[nn,Ht]=C.useState(null),[Wt,Sr]=C.useState(null),{data:Vr}=rl("items"),{data:Pn}=rl("projects"),{data:xn}=rl("engineers"),hn=C.useCallback((S,M)=>{const B=Pa(S),Q=!l.size||l.has(B);return Gm(S,{items:Vr||{},deptList:Q?[]:o,limit:M})},[l,o,Vr]),Y=S=>{I(M=>v===S&&M==="asc"?"desc":"asc"),m(S)},fe=S=>{let M="table-head-cell";return S&&(M+=" sortable"),S&&v===S&&(M+=" active-sort"),M},me=S=>S&&v===S?p.jsx("span",{className:"sort-pill",children:A==="asc"?"":""}):null;C.useEffect(()=>{(async()=>{Et(!0);try{D(await VA(s,{storeOfficer:u,inStoreDept:c,isAdmin:h,isDeptManager:f,isRequester:y},500,(e==null?void 0:e.uid)||void 0))}finally{Et(!1)}})()},[u,c,h,f,y,s.join(","),e==null?void 0:e.uid]),C.useEffect(()=>{(h||f||y)&&_.length&&(new Set(_),_.every(M=>T0.includes(M))&&_.length<=T0.length&&x([]))},[h,f,y]),C.useEffect(()=>{u&&!(h||f||y)&&_.length&&x([])},[u,h,f,y]),C.useEffect(()=>{u&&!(h||f||y)&&(ue&&(ye(""),Ee(""),ct("")),V.trim()&&P(""))},[u,h,f,y]),C.useEffect(()=>{try{localStorage.setItem("requests.filters",JSON.stringify({statuses:_,columns:N}))}catch{}},[_.join(","),N.join(",")]),C.useEffect(()=>{const S=M=>{var Q,ae,te;const B=M.target;(Q=Tr.current)!=null&&Q.contains(B)||de(!1),(ae=qt.current)!=null&&ae.contains(B)||wt(!1),(te=jt.current)!=null&&te.contains(B)||G(!1)};return window.addEventListener("mousedown",S,!0),()=>window.removeEventListener("mousedown",S,!0)},[]);function Be(S){var qe,Me,De,He;const M=V.split("|").map(pt=>pt.trim()).filter(Boolean),B=cu(S,Pn).toLowerCase(),Q=du(S,xn).toLowerCase(),ae=Pa(S).toLowerCase(),te=md(S).join(" ").toLowerCase(),ie=hn(S).join(" ").toLowerCase(),se=[(S.rqCode||S.code||S.id||"").toString().toLowerCase(),(((qe=S.createdBy)==null?void 0:qe.fullName)||"").toLowerCase(),(((Me=S.createdBy)==null?void 0:Me.departmentId)||"").toLowerCase(),B,Q,(S.projectId||"").toLowerCase(),(S.engineerId||"").toLowerCase(),(S.status||"").toLowerCase(),ae,te,ie,S.urgent?"urgent":""].join(` 
 `),Z=(De=S.updatedAt)!=null&&De.toDate?S.updatedAt.toDate():(He=S.createdAt)!=null&&He.toDate?S.createdAt.toDate():null,ge=[];if(Z){ge.push(Z.toLocaleDateString()),ge.push(Z.toLocaleString());const pt=String(Z.getDate()).padStart(2,"0"),Lt=String(Z.getMonth()+1).padStart(2,"0"),dt=Z.getFullYear(),Rt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];ge.push(`${Lt}/${pt}/${dt}`),ge.push(`${pt}/${Lt}/${dt}`),ge.push(`${pt} ${Rt[Z.getMonth()]}`),ge.push(`${Rt[Z.getMonth()]} ${pt}`)}return M.length===0?!0:M.some(pt=>pt.split(/[\s,]+/).map(dt=>dt.trim().toLowerCase()).filter(Boolean).every(dt=>se.includes(dt)||ge.some(Rt=>Rt.toLowerCase().includes(dt))))}async function Pe(S){Sr(null),Ht(S.id);try{if(e!=null&&e.uid){const M={};M[`readBy.${e.uid}`]=Ai(),await za($t(r,"requests",S.id),M)}n(`/requests/new?rq=${S.id}`)}catch(M){console.error("openRequestRow failed",M),Sr("???? ??? ?????. ???? ?? ????? ???????? ?? ??? ????????."),Ht(null)}}const Ye=C.useMemo(()=>{let S=R.slice();return S=S.filter(M=>{var Q;return String(M.status||M.stage||"").toUpperCase()!=="DRAFT"?!0:T&&((Q=M.createdBy)==null?void 0:Q.uid)===T}),_.length&&(S=S.filter(M=>_.includes(M.status||""))),ue&&(S=S.filter(M=>{var se,Z;const B=(se=M.updatedAt)!=null&&se.toDate?M.updatedAt.toDate():(Z=M.createdAt)!=null&&Z.toDate?M.createdAt.toDate():null;if(!B)return!1;const Q=B.getFullYear(),ae=String(B.getMonth()+1).padStart(2,"0"),te=String(B.getDate()).padStart(2,"0");return`${Q}-${ae}-${te}`===ue})),V.trim()&&(S=S.filter(Be)),S.sort((M,B)=>{var ae,te,ie,se,Z,ge;const Q=A==="asc"?1:-1;if(v==="updatedAt"){const ve=(ae=M.updatedAt)!=null&&ae.toMillis?M.updatedAt.toMillis():(te=M.createdAt)!=null&&te.toMillis?M.createdAt.toMillis():0,qe=(ie=B.updatedAt)!=null&&ie.toMillis?B.updatedAt.toMillis():(se=B.createdAt)!=null&&se.toMillis?B.createdAt.toMillis():0;return(ve-qe)*Q}if(v==="status")return(M.status||"").localeCompare(B.status||"")*Q;if(v==="rq")return(M.rqCode||M.code||M.id||"").localeCompare(B.rqCode||B.code||B.id||"")*Q;if(v==="createdBy")return(((Z=M.createdBy)==null?void 0:Z.fullName)||"").localeCompare(((ge=B.createdBy)==null?void 0:ge.fullName)||"")*Q;if(v==="from")return Pa(M).localeCompare(Pa(B))*Q;if(v==="for")return md(M).join(",").localeCompare(md(B).join(","))*Q;if(v==="autoApproved"){const ve=Object.values(M.autoApprovedByDept||{}).some(Boolean)?1:0,qe=Object.values(B.autoApprovedByDept||{}).some(Boolean)?1:0;return(ve-qe)*Q}if(v==="projectName"){const ve=cu(M,Pn)||"",qe=cu(B,Pn)||"";return ve.localeCompare(qe)*Q}if(v==="engineer"){const ve=du(M,xn)||"",qe=du(B,xn)||"";return ve.localeCompare(qe)*Q}if(v==="itemsPreview"){const ve=hn(M).join(qo),qe=hn(B).join(qo);return ve.localeCompare(qe)*Q}return v==="urgent"?((M.urgent?1:0)-(B.urgent?1:0))*Q:v==="note"?(M.note||"").localeCompare(B.note||"")*Q:0}),S},[R,V,_.join(","),ue,v,A,hn,Pn,xn,T]),et=Math.max(1,Math.ceil(Ye.length/W)),Nt=Ye.slice((j-1)*W,(j-1)*W+W);C.useEffect(()=>{j>et&&q(1)},[et]);const Kt="inline-flex items-center justify-center h-8 w-8 rounded-full bg-blue-600 text-white",ir="inline-flex items-center justify-center h-8 w-8 rounded-full text-blue-700 hover:bg-blue-50",Dt=["createdBy","fromDept","forDept"],Gt=C.useMemo(()=>{if(N.length!==Dt.length)return!1;const S=new Set(N);return Dt.every(M=>S.has(M))},[N.join(",")]),or=_.length>0,Ir=!Gt,kn=!!ue,rs=or?"btn-primary font-semibold":"btn-ghost",Nn=Ir?"btn-primary font-semibold":"btn-ghost",ft=kn?"btn-primary font-semibold":"btn-ghost",Qt={page:1,sortKey:"updatedAt",sortDir:"desc"},Tt=C.useMemo(()=>{const S=V.trim();return/^[A-Z]{2,4}-\d{7}$/.test(S)?S:""},[V]),Qn=C.useMemo(()=>{const S=_.length>0,M=!Gt,B=!!ue,Q=V.trim().length>0,ae=j!==Qt.page,te=!(v===Qt.sortKey&&A===Qt.sortDir);return S||M||B||Q||ae||te},[_.join(","),Gt,ue,V,j,v,A]),Ar=()=>{Qn&&(P(""),x([]),L(Dt),ye(""),Ee(""),ct(""),m("updatedAt"),I("desc"),q(1))},Dn=S=>{if(!S)return"";const M=/^(\d{4})-(\d{2})-(\d{2})$/.exec(S);if(!M)return"";const[,B,Q,ae]=M;return`${ae}-${Q}-${B}`},ar=S=>String(S).padStart(2,"0"),Mr=S=>x(M=>M.includes(S)?M.filter(B=>B!==S):[...M,S]),lr=[{key:"createdBy",label:"Created by"},{key:"fromDept",label:"From dept"},{key:"forDept",label:"For dept"},{key:"projectName",label:"Project"},{key:"engineer",label:"Engineer"},{key:"itemsPreview",label:"Items"},{key:"autoApproved",label:"Auto-approved"},{key:"urgent",label:"Urgent"},{key:"note",label:"Note"}],wn=S=>L(M=>M.includes(S)?M.filter(B=>B!==S):[...M,S]);return p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex flex-wrap items-center gap-3 justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[320px]",children:[p.jsxs("div",{className:"relative w-1/2",children:[p.jsx("input",{autoComplete:"off",className:"input w-full pr-16",placeholder:"Search (multi-token, supports OR with |)",value:V,onChange:S=>{P(S.target.value),q(1)}}),Tt&&p.jsx("button",{type:"button",className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs font-semibold px-3 py-1 rounded-lg bg-blue-600 text-white hover:bg-blue-700",onClick:()=>n(`/requests/new?rq=${Tt}`),children:"Open"})]}),p.jsxs("div",{ref:Tr,className:"relative",children:[p.jsx("button",{className:rs,onClick:()=>de(S=>!S),children:"Status"}),k&&p.jsxs("div",{className:"absolute right-0 z-10 mt-1 w-56 border bg-white rounded-md shadow p-2 max-h-80 overflow-auto",children:[E0.map(S=>p.jsxs("label",{className:"flex items-center gap-2 px-2 py-1 hover:bg-blue-50 rounded",children:[p.jsx("input",{type:"checkbox",checked:_.includes(S),onChange:()=>Mr(S)}),p.jsx("span",{children:S})]},S)),p.jsxs("div",{className:"mt-2 flex gap-2",children:[p.jsx("button",{className:"btn-ghost",onClick:()=>x([]),children:"Clear"}),p.jsx("button",{className:"btn-primary",onClick:()=>de(!1),children:"Apply"})]})]})]}),p.jsxs("div",{ref:qt,className:"relative",children:[p.jsx("button",{className:Nn,onClick:()=>wt(S=>!S),children:"Category"}),ke&&p.jsxs("div",{className:"absolute right-0 z-10 mt-1 w-64 border bg-white rounded-md shadow p-2 max-h-96 overflow-auto",children:[p.jsx("div",{className:"px-2 py-1 text-xs text-gray-500",children:"Columns (fixed: RQ, Status, Last Update)"}),lr.map(S=>p.jsxs("label",{className:"flex items-center gap-2 px-2 py-1 hover:bg-blue-50 rounded",children:[p.jsx("input",{type:"checkbox",checked:N.includes(S.key),onChange:()=>wn(S.key)}),p.jsx("span",{children:S.label})]},S.key))]})]}),p.jsxs("div",{ref:jt,className:"relative",children:[p.jsx("button",{className:ft,onClick:()=>{if(Ee(Dn(ue)),ue){const S=/^(\d{4})-(\d{2})-(\d{2})$/.exec(ue);S&&(be(Number(S[1])),Xe(Number(S[2])),ct(ue))}else{const S=new Date;be(S.getFullYear()),Xe(S.getMonth()+1),ct("")}G(S=>!S)},children:"Last Update"}),gt&&p.jsxs("div",{className:"absolute right-0 z-10 mt-1 w-64 border bg-white rounded-md shadow p-3",children:[p.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Last update"}),p.jsxs("div",{className:"mb-2",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("button",{className:"btn-ghost",onClick:()=>{let S=Ne-1,M=Ie;S<1&&(S=12,M--),Xe(S),be(M)},children:"<"}),p.jsxs("div",{className:"font-semibold",children:[new Date(Ie,Ne-1,1).toLocaleString(void 0,{month:"short"})," ",Ie]}),p.jsx("button",{className:"btn-ghost",onClick:()=>{let S=Ne+1,M=Ie;S>12&&(S=1,M++),Xe(S),be(M)},children:">"})]}),p.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs text-gray-600 mb-1",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(S=>p.jsx("div",{children:S},S))}),p.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:(()=>{const M=new Date(Ie,Ne-1,1).getDay(),B=new Date(Ie,Ne,0).getDate(),Q=[];for(let ae=0;ae<M;ae++)Q.push(null);for(let ae=1;ae<=B;ae++)Q.push(ae);return Q.map((ae,te)=>{if(ae===null)return p.jsx("div",{className:"h-8"},te);const ie=`${Ie}-${ar(Ne)}-${ar(ae)}`,Z=Qe===ie?"bg-blue-600 text-white":"hover:bg-blue-50";return p.jsx("button",{className:`h-8 rounded ${Z}`,onClick:()=>{ct(ie),Ee(Dn(ie))},children:ae},te)})})()})]}),p.jsx("div",{className:"mt-2 flex gap-2 justify-end",children:p.jsx("button",{className:"btn-primary",onClick:()=>{ye(Qe||""),G(!1),m("updatedAt"),I("desc"),q(1)},children:"Apply"})})]})]}),p.jsx("button",{className:"btn-ghost disabled:opacity-50 disabled:cursor-not-allowed",disabled:!Qn,onClick:Ar,children:"Clear"})]}),p.jsx("div",{className:"shrink-0",children:p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{className:"btn-ghost",onClick:()=>q(S=>Math.max(1,S-1)),children:"< Prev"}),Array.from({length:Math.min(10,et)}).map((S,M)=>{const B=M+1,Q=B===j?Kt:ir;return p.jsx("button",{className:Q,onClick:()=>q(B),children:B},B)}),et>10&&p.jsxs("span",{className:"px-2",children:[" ",et]}),p.jsx("button",{className:"btn-ghost",onClick:()=>q(S=>Math.min(et,S+1)),children:"Next >"})]})})]}),Ue?p.jsx("div",{className:"card p-6",children:"Loading..."}):p.jsx("div",{className:"card table-card",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"table-modern",children:[p.jsx("thead",{className:"table-head",children:p.jsxs("tr",{children:[p.jsx("th",{className:fe("rq"),onClick:()=>Y("rq"),children:p.jsxs("span",{className:"header-content",children:["RQ ",me("rq")]})}),N.includes("createdBy")&&p.jsx("th",{className:fe("createdBy"),onClick:()=>Y("createdBy"),children:p.jsxs("span",{className:"header-content",children:["Created by ",me("createdBy")]})}),N.includes("fromDept")&&p.jsx("th",{className:fe("from"),onClick:()=>Y("from"),children:p.jsxs("span",{className:"header-content",children:["From dept ",me("from")]})}),N.includes("forDept")&&p.jsx("th",{className:fe("for"),onClick:()=>Y("for"),children:p.jsxs("span",{className:"header-content",children:["For dept ",me("for")]})}),N.includes("projectName")&&p.jsx("th",{className:fe("projectName"),onClick:()=>Y("projectName"),children:p.jsxs("span",{className:"header-content",children:["Project ",me("projectName")]})}),N.includes("engineer")&&p.jsx("th",{className:fe("engineer"),onClick:()=>Y("engineer"),children:p.jsxs("span",{className:"header-content",children:["Engineer ",me("engineer")]})}),N.includes("itemsPreview")&&p.jsx("th",{className:fe("itemsPreview"),onClick:()=>Y("itemsPreview"),children:p.jsxs("span",{className:"header-content",children:["Items ",me("itemsPreview")]})}),N.includes("autoApproved")&&p.jsx("th",{className:fe("autoApproved"),onClick:()=>Y("autoApproved"),children:p.jsxs("span",{className:"header-content",children:["Auto-approved ",me("autoApproved")]})}),p.jsx("th",{className:`${fe("status")} text-center`,onClick:()=>Y("status"),children:p.jsxs("span",{className:"header-content justify-center gap-1",children:["Status ",me("status")]})}),N.includes("urgent")&&p.jsx("th",{className:fe("urgent"),onClick:()=>Y("urgent"),children:p.jsxs("span",{className:"header-content",children:["Urgent ",me("urgent")]})}),N.includes("note")&&p.jsx("th",{className:fe("note"),onClick:()=>Y("note"),children:p.jsxs("span",{className:"header-content",children:["Note ",me("note")]})}),p.jsx("th",{className:fe("updatedAt"),onClick:()=>Y("updatedAt"),children:p.jsxs("span",{className:"header-content",children:["Last Update ",me("updatedAt")]})})]})}),p.jsxs("tbody",{children:[Nt.map(S=>{var ie,se;const M=!!S.urgent,B=e!=null&&e.uid?!((ie=S==null?void 0:S.readBy)!=null&&ie[e.uid]):!1;let Q="table-row";M&&B?Q+=" table-row-urgent":M?Q+=" table-row-urgent-soft":B&&(Q+=" table-row-unread"),nn===S.id&&(Q+=" row-loading");const te=`badge badge-status status-${String(S.status||"").toLowerCase().replace(/\s+/g,"_")}`;return p.jsxs("tr",{className:Q+" cursor-pointer",onClick:()=>Pe(S),children:[p.jsx("td",{className:"p-3",children:S.rqCode||S.code||S.id}),N.includes("createdBy")&&p.jsx("td",{className:"p-3",children:((se=S.createdBy)==null?void 0:se.fullName)||"-"}),N.includes("fromDept")&&p.jsx("td",{className:"p-3",children:S0(Pa(S))||"-"}),N.includes("forDept")&&p.jsx("td",{className:"p-3",children:(()=>{const Z=md(S).map(S0).filter(Boolean);return Z.length?Z.join(qo):"-"})()}),N.includes("projectName")&&p.jsx("td",{className:"p-3",children:cu(S,Pn)||"-"}),N.includes("engineer")&&p.jsx("td",{className:"p-3",children:du(S,xn)||"-"}),N.includes("itemsPreview")&&p.jsx("td",{className:"p-3",children:(()=>{const Z=hn(S,10);return Z.length?Z.join(qo):"-"})()}),N.includes("autoApproved")&&p.jsx("td",{className:"p-3",children:(()=>{const Z=S.autoApprovedByDept||{};return Object.values(Z).some(Boolean)?"Yes":"No"})()}),p.jsx("td",{className:"p-3 text-center align-middle",children:p.jsx("span",{className:te,children:S.status})}),N.includes("urgent")&&p.jsx("td",{className:"p-3",children:S.urgent?"Yes":"No"}),N.includes("note")&&p.jsx("td",{className:"p-3",children:S.note||""}),p.jsx("td",{className:"p-3",children:zO(S.updatedAt||S.createdAt)})]},S.id)}),Nt.length===0&&p.jsx("tr",{children:p.jsx("td",{className:"p-4 text-gray-500",colSpan:9,children:"No results"})})]})]})})}),Wt&&p.jsxs("div",{className:"alert alert-error",children:[p.jsx("span",{children:Wt}),p.jsx("button",{className:"ml-auto text-sm font-semibold underline",onClick:()=>Sr(null),children:"?????"})]})]})}const HO={OWNER_APPROVED:{label:"Approved by owner",Icon:jA,wrapper:"inline-flex items-center text-green-600",icon:"h-4 w-4"},PENDING_OWNER:{label:"Pending owner approval",Icon:MO,wrapper:"inline-flex items-center text-amber-500",icon:"h-4 w-4"},OWNER_REJECTED:{label:"Rejected by owner",Icon:FA,wrapper:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-red-600 text-white",icon:"h-3.5 w-3.5"},DELETED:{label:"Removed from request",Icon:BA,wrapper:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-white text-red-600 border border-red-200",icon:"h-3.5 w-3.5"}},Ri=t=>t.deleted?"DELETED":String(t.status||"PENDING_OWNER").toUpperCase(),I0=(t,e="SUBMITTED")=>{if(!t.length)return"CANCELED";const n=t.filter(o=>!o.deleted);if(!n.length)return"CANCELED";const r=n.filter(o=>Ri(o)==="OWNER_APPROVED").length,s=n.filter(o=>Ri(o)==="OWNER_REJECTED").length,i=n.length-r-s;return s===n.length?"REJECTED":i===0&&r>0?"FULLY_APPROVED":r>0?"PARTIALLY_APPROVED":i>0?"SUBMITTED":e},A0=new Set(["DRAFT","SUBMITTED","PARTIALLY_APPROVED","FULLY_APPROVED"]),WO=new Set(["SUBMITTED","PARTIALLY_APPROVED","FULLY_APPROVED"]),KO=new Set(["SUBMITTED","PARTIALLY_APPROVED","FULLY_APPROVED","STORE_PREPARING"]),GO=new Set(["SUBMITTED","PARTIALLY_APPROVED","FULLY_APPROVED"]),QO={DRAFT:"bg-gray-400",SUBMITTED:"bg-blue-500",PARTIALLY_APPROVED:"bg-amber-500",FULLY_APPROVED:"bg-green-500",STORE_PREPARING:"bg-purple-500",READY:"bg-teal-500",REJECTED:"bg-red-500",CANCELED:"bg-gray-500",CLOSED:"bg-slate-500"},Zl=50,YO=t=>{if(!t)return"";const e=new Date,n=e.getTime()-t.getTime(),r=4*60*60*1e3,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),o=t.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"});return n<60*1e3?"just now":n<60*60*1e3?`${Math.floor(n/(60*1e3))}m ago`:n<r?`${Math.floor(n/(60*60*1e3))}h ago`:i===s?`today, ${o}`:i===s-24*60*60*1e3?`yesterday, ${o}`:`${t.getDate().toString().padStart(2,"0")}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getFullYear()}, ${o}`},JO=t=>{if(!t)return"Unknown user";const e=t.fullName||t.uid||"Unknown user";return t.deptId?`${e}  ${t.deptId}`:e},XO=t=>{var r,s;if(!t)return null;const e=t.match(/Status:\s*([A-Z_ ]+)->\s*([A-Z_]+)/i);if(e)return((r=e[2])==null?void 0:r.trim().toUpperCase())||null;const n=t.match(/Initial status\s+([A-Z_]+)/i);return n&&((s=n[1])==null?void 0:s.trim().toUpperCase())||null},Qy=t=>{if(t==null)return null;if(typeof t=="number")return t;if(typeof(t==null?void 0:t.toMillis)=="function")return t.toMillis();if(typeof(t==null?void 0:t.seconds)=="number"){const e=typeof t.nanoseconds=="number"?t.nanoseconds:0;return t.seconds*1e3+Math.floor(e/1e6)}return null},gd=t=>{if(!t)return null;const e=t.uid??null,n=t.fullName??null,r=t.atMs??Qy(t.at);return!e&&!n&&!r?null:{uid:e,fullName:n,atMs:r}},$A=t=>{if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null},Vh=t=>{if(Array.isArray(t))return t.map(e=>{const n=Vh(e);return n===void 0?null:n});if($A(t)){const e={};return Object.entries(t).forEach(([n,r])=>{r!==void 0&&(e[n]=Vh(r))}),e}return t},Sp=t=>{const e=Qy(t);if(!e)return"";const n=new Date(e),r=n.getDate().toString().padStart(2,"0"),s=n.toLocaleString("en-US",{month:"short"}),i=n.toLocaleString("en-US",{hour:"numeric",minute:"2-digit"});return`${r} ${s} ${i}`},Ei=t=>(t||"").trim();function ZO(){var on,an,Vs,Yn,ko,va,Yy,Jy,Xy,Zy,ev;const{user:t,role:e}=ns(),n=oi(),[r]=sS(),s=r.get("rq"),i=!!s,o=Or(),l=(e==null?void 0:e.fullName)||(t==null?void 0:t.displayName)||(((on=t==null?void 0:t.email)==null?void 0:on.split("@")[0])??""),u=C.useMemo(()=>((e==null?void 0:e.departmentIds)||[]).map(U=>Ei(U)).filter(Boolean),[((e==null?void 0:e.departmentIds)||[]).join("|")]),c=C.useMemo(()=>u.length>0?u[0]:null,[u]),h=!!((an=e==null?void 0:e.roles)!=null&&an.admin),f=!!((Vs=e==null?void 0:e.roles)!=null&&Vs.deptManager),y=!!((Yn=e==null?void 0:e.roles)!=null&&Yn.storeOfficer),T=!!((ko=e==null?void 0:e.roles)!=null&&ko.requester),R=C.useMemo(()=>new Set((u||[]).map(w=>String(w).toUpperCase())),[u.join(",")]),D=R.has("STORE"),V=T||f||h;C.useEffect(()=>{!V&&!i&&n("/requests",{replace:!0})},[V,i]);const P=w=>{if(D)return!0;if(!y)return!1;const U=String(w||"").toUpperCase();return U?R.has(U):!1};C.useEffect(()=>()=>{be.current&&(clearTimeout(be.current),be.current=null)},[]);const[_,x]=C.useState([]),[j,q]=C.useState([]),[W,v]=C.useState([]),[m,A]=C.useState(null),[I,N]=C.useState(!1),[L,k]=C.useState(!0),[de,ke]=C.useState(!1),[wt,gt]=C.useState(!1),[G,ue]=C.useState(!1),[ye,Se]=C.useState(null),[Ee,Ie]=C.useState(!1),be=C.useRef(null),Ne=Ei(i?(m==null?void 0:m.fromDept)||((va=m==null?void 0:m.createdBy)==null?void 0:va.departmentId)||u[0]||null:u[0]||null),Xe=C.useCallback(()=>c||Ne||(m==null?void 0:m.fromDept)||null,[c,Ne,m==null?void 0:m.fromDept]),Qe=i&&((m==null?void 0:m.status)||(m==null?void 0:m.stage))||"DRAFT",ct=String(Qe).toUpperCase(),[Tr,qt]=C.useState(null);C.useEffect(()=>{qt(null)},[Qe,i,s]);const jt=Tr||Qe,Ue=String(jt).toUpperCase(),Et=ct==="DRAFT",nn=!i||!((Yy=m==null?void 0:m.createdBy)!=null&&Yy.uid)||m.createdBy.uid===(t==null?void 0:t.uid),Ht=Ne?R.has(String(Ne).toUpperCase()):!1,Wt=!i||A0.has(ct),Sr=Ue==="FULLY_APPROVED",Vr=Ue==="STORE_PREPARING",Pn=Ue==="READY",xn=Ue==="CLOSED",hn=i&&P(Ne),Y=hn&&Sr,fe=hn&&Vr,me=hn&&Vr,Be=hn&&!f&&!T&&["FULLY_APPROVED","STORE_PREPARING","READY","CLOSED"].includes(Ue),Pe=T&&nn,Ye=f&&Ht,et=h,Nt=f&&WO.has(ct),[Kt,ir]=C.useState(""),[Dt,Gt]=C.useState(""),[or,Ir]=C.useState(!1),[kn,rs]=C.useState(""),Nn=C.useRef(""),[ft,Qt]=C.useState([]),[Tt,Qn]=C.useState(null),Ar=C.useRef(null),[Dn,ar]=C.useState([]),[Mr,lr]=C.useState(!1),[wn,Cs]=C.useState(!1),[bt,b]=C.useState({}),[O,S]=C.useState(!1),[M,B]=C.useState(!1),Q=C.useRef(null),[ae,te]=C.useState(null),ie=C.useRef(history.pushState),se=C.useRef(history.replaceState),Z=C.useMemo(()=>((Array.isArray(m==null?void 0:m.lineDeptIds)?m==null?void 0:m.lineDeptIds:Array.isArray(m==null?void 0:m.deptIndex)?m.deptIndex:[])||[]).map(U=>String(U||"").toUpperCase()),[m==null?void 0:m.lineDeptIds,m==null?void 0:m.deptIndex]),ge=C.useMemo(()=>ft.some(w=>R.has(String(w.ownerDeptId||"").toUpperCase())),[ft,R]),ve=C.useMemo(()=>Be?ft.filter(w=>{const U=Ri(w),$=String(w.status||"").toUpperCase();return!w.deleted&&U!=="DELETED"&&$==="OWNER_APPROVED"}):ft,[ft,Be]),qe=Z.some(w=>R.has(w)),Me=f&&(ge||qe),De=i&&Pn&&(h||f&&(Ht||Me)),He=Wt&&(et||Pe||Ye),pt=Wt&&(et||Pe||Ye||Me),Lt=pt,dt=Et&&(h||T&&nn||f&&Ht),Rt=!Et&&A0.has(ct),Ps=w=>!Lt||w.lockedDeleted?!1:h?!0:nn?Et?!0:T&&nn:!1,Rr=!!(i&&Tt&&KO.has(ct)&&(h||T&&nn||f&&Ht)),[fn,rn]=C.useState(""),[ss,Ce]=C.useState(!1),[tt,bn]=C.useState(""),[is,je]=C.useState(!1),ur=C.useRef(null),li=C.useRef(null),yo=C.useRef(null),Rc=C.useRef(null);C.useEffect(()=>{(async()=>{try{const w=await nl(el(o,"projects")),U=await nl(el(o,"engineers")),$=await nl(el(o,"items"));x(w.docs.map(J=>({id:J.id,...J.data()}))),q(U.docs.map(J=>({id:J.id,...J.data()}))),v($.docs.map(J=>({id:J.id,...J.data()})))}finally{k(!1)}})()},[]),C.useEffect(()=>{if(!Kt||!_.length||fn)return;const w=_.find(U=>U.id===Kt);w&&rn(w.nameEn||w.nameAr||w.name||"")},[Kt,_,fn]),C.useEffect(()=>{if(!Dt||!j.length||tt)return;const w=j.find(U=>U.id===Dt);w&&bn(w.nameEn||w.nameAr||"")},[Dt,j,tt]),C.useEffect(()=>{s&&(async()=>{N(!0);try{const w=await sa($t(o,"requests",s));if(!w.exists()){Se("Request not found.");return}const U=w.data();A({id:w.id,...U});const $=U.rqCode||w.id;Qn($),Ar.current=$,ir(U.projectId||""),rn(U.projectNameEn||U.projectNameAr||U.projectName||""),Gt(U.engineerId||""),bn(U.engineerNameEn||U.engineerNameAr||""),Ir(!!U.urgent),rs(U.note||""),Nn.current=U.note||"";const J=Array.isArray(U.lines)&&U.lines.length?U.lines:Array.isArray(U.draftLines)?U.draftLines:[];Qt(J.map((pe,re)=>({key:pe.key||`${pe.itemId||"line"}-${re}`,itemId:pe.itemId,itemName:pe.itemName,ownerDeptId:Ei(pe.ownerDeptId),unit:pe.unit,qty:pe.qty,status:pe.status,ownerApprovedBy:pe.ownerApprovedBy||null,ownerRejectedBy:pe.ownerRejectedBy||null,deleted:!!pe.deleted,lockedDeleted:!!pe.deleted,lockedRejected:String(pe.status||"").toUpperCase()==="OWNER_REJECTED",removedBy:gd(pe.removedBy)}))),S(!1)}catch(w){console.error(w),Se("Failed to load request.")}finally{N(!1)}})()},[s,o]),C.useEffect(()=>{s||(A(null),Qn(null),Ar.current=null,ir(""),rn(""),Gt(""),bn(""),Ir(!1),rs(""),Nn.current="",Qt([]),S(!1),Se(null))},[s]),C.useEffect(()=>{!s||!(t!=null&&t.uid)||(async()=>{try{const w={};w[`readBy.${t.uid}`]=Ai(),await za($t(o,"requests",s),w)}catch{}})()},[s,t==null?void 0:t.uid,o]),C.useEffect(()=>{const w=U=>{var le,rt,Ft,st;const $=U.target,J=((le=ur.current)==null?void 0:le.contains($))??!1,pe=((rt=li.current)==null?void 0:rt.contains($))??!1,re=(((Ft=ma.current)==null?void 0:Ft.contains($))??!1)||!!((st=document.getElementById("item-combobox-overlay"))!=null&&st.contains($));J||Ce(!1),pe||je(!1),re||Cr(!1)};return window.addEventListener("mousedown",w,!0),()=>window.removeEventListener("mousedown",w,!0)},[]),C.useEffect(()=>{const w=U=>{O&&(U.preventDefault(),U.returnValue="")};return window.addEventListener("beforeunload",w),()=>window.removeEventListener("beforeunload",w)},[O]),C.useEffect(()=>{const w=history.pushState,U=history.replaceState;ie.current=w,se.current=U;function $(...re){if(O){Q.current={kind:"push",args:re},B(!0);return}return w.apply(this,re)}function J(...re){if(O){Q.current={kind:"replace",args:re},B(!0);return}return U.apply(this,re)}history.pushState=$,history.replaceState=J;const pe=()=>{O&&(history.go(1),Q.current={kind:"pop"},B(!0))};return window.addEventListener("popstate",pe),()=>{history.pushState=w,history.replaceState=U,window.removeEventListener("popstate",pe)}},[O]),C.useEffect(()=>{const w=U=>{if(!O)return;const $=U.target;if(!$)return;const J=$.closest("a");if(!J)return;const pe=J.getAttribute("href");if(!pe||pe.startsWith("#")||J.target==="_blank")return;const re=new URL(pe,window.location.href);re.origin===window.location.origin&&(U.preventDefault(),te(re.pathname+re.search+re.hash),B(!0))};return document.addEventListener("click",w,!0),()=>document.removeEventListener("click",w,!0)},[O]);const vo=w=>{const U=W.find(J=>J.itemCode===w),$=U==null?void 0:U.qty;return typeof $=="number"?$:void 0},Cc=w=>{for(const U of w){if(!U)continue;const $=Ri(U);if($==="DELETED"||$==="OWNER_REJECTED"||!P(U.ownerDeptId))continue;const J=vo(U.itemId);if(typeof J=="number"&&U.qty>J)return{line:U,available:J}}return null},_o=async(w,U={})=>{var J,pe,re;const{redirect:$=!1}=U;if(!de){ke(!0),Se(null),console.log("save() auth context",{uid:t==null?void 0:t.uid,role:e});try{if(!i&&!V){Se("You do not have permission to create requests."),ke(!1);return}if(i&&!pt){Se("You do not have permission to modify this request."),ke(!1);return}if(!Kt||!Dt||ft.length===0){Se("Please choose a project and engineer and add at least one item"),ke(!1);return}let le=(m==null?void 0:m.note)??(m==null?void 0:m.notes)??"";const rt=kn||"",Ft=Xe(),st={uid:(t==null?void 0:t.uid)||null,fullName:l||(t==null?void 0:t.displayName)||(t==null?void 0:t.email)||null,deptId:Ft},hs=st.fullName||st.uid||"User",Br=st.deptId?` (${st.deptId})`:"",Ze=`${hs}${Br}`,Jn=[],fs=[],dr=(ee,_e)=>{fs.push(_e?`${ee}: ${_e}`:ee)},_a=(ee,_e)=>{_e.length&&fs.push(`${ee}:
 - ${_e.join(`
 - `)}`)},Uc=ee=>{if(!ee)return"Unassigned";const _e=_.find(Ve=>Ve.id===ee);return(_e==null?void 0:_e.nameEn)||(_e==null?void 0:_e.nameAr)||(_e==null?void 0:_e.name)||ee},En=ee=>{if(!ee)return"Unassigned";const _e=j.find(Ve=>Ve.id===ee);return(_e==null?void 0:_e.nameEn)||(_e==null?void 0:_e.nameAr)||ee},jl=ee=>{if(!ee)return"Item";const _e=ee.itemName||ee.itemId||"Item",Ve=ee.itemId?` (${ee.itemId})`:"";return ee.ownerDeptId?`${_e}${Ve}  ${ee.ownerDeptId}`:`${_e}${Ve}`},Fl=ee=>{if(!ee||ee.qty==null)return"qty ?";const _e=ee.unit?` ${ee.unit}`:"";return`${ee.qty}${_e}`},Ut=(ee,_e)=>{if(!ee)return`idx-${_e}`;if(ee.key)return ee.key;const Ve=ee.ownerDeptId||"dept";return`${ee.itemId||"item"}-${Ve}-${_e}`},Ul=ft.map(ee=>{const{lockedDeleted:_e,lockedRejected:Ve,...pn}=ee;return{...pn,ownerDeptId:Ei(ee.ownerDeptId),deleted:!!ee.deleted}});if(w!=="DRAFT"){const ee=Cc(Ul);if(ee){const{line:_e,available:Ve}=ee;Se(`Cannot submit or approve because ${_e.itemName} (${_e.itemId}) requests ${_e.qty} but only ${Ve??0} available.`),ke(!1);return}}const zA=Array.from(new Set(Ul.filter(ee=>!ee.deleted).map(ee=>ee.ownerDeptId).filter(Boolean))),No=Ei(i?(m==null?void 0:m.fromDept)||((J=m==null?void 0:m.createdBy)==null?void 0:J.departmentId)||Ne||u[0]||null:Ne||u[0]||zA[0]||null),Bc=(ee=>{const _e=new Set;return ee.forEach(Ve=>{if(Ve.deleted)return;const pn=Ei(Ve.ownerDeptId);pn&&_e.add(pn)}),No&&_e.add(No),Array.from(_e)})(Ul),tv=i&&(m!=null&&m.createdBy)?m.createdBy:{uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:l,departmentId:No};let Do=Ar.current||Tt||"";if(!Do){const ee=No==="Store"?"STR":(No||"GEN").toString().slice(0,3).toUpperCase(),_e=new Date,Ve=String(_e.getMonth()+1).padStart(2,"0"),pn=String(_e.getDate()).padStart(2,"0"),Pr=`${_e.getFullYear()}${Ve}${pn}`,yi=`${ee}-${Pr}`,ln=await gO(o,async bo=>{const vi=$t(o,"counters",yi),Ms=await bo.get(vi);let js=Ms.exists()&&Ms.data().next||1;return bo.set(vi,{next:js+1},{merge:!0}),js});Do=`${ee}-${Ve}${pn}${String(ln).padStart(3,"0")}`}const qA=!!((pe=e==null?void 0:e.roles)!=null&&pe.admin),HA=!!((re=e==null?void 0:e.roles)!=null&&re.deptManager),fV=ee=>qA||HA&&u.includes(ee),WA=$A(m==null?void 0:m.autoApprovedByDept)?{...m==null?void 0:m.autoApprovedByDept}:{},nv=w==="DRAFT"?{}:{...WA},rv=Ul.map(ee=>{let Ve=String(ee.status||"").toUpperCase()||"PENDING_OWNER",pn=ee.ownerApprovedBy||null,Pr=ee.ownerRejectedBy||null,yi=gd(ee.removedBy);return ee.deleted&&(Ve="PENDING_OWNER",pn=null,Pr=null,yi=gd(ee.removedBy)),{...ee,status:Ve,ownerApprovedBy:pn,ownerRejectedBy:Pr,deleted:!!ee.deleted,removedBy:yi}}),sv=(m==null?void 0:m.status)||"SUBMITTED",KA=I0(rv,sv);let $r=w==="DRAFT"?"DRAFT":!i||h||T&&nn||f&&(Ht||Me)?KA:sv;w!=="DRAFT"&&ct==="DRAFT"&&($r="SUBMITTED");const Bl=(w==="DRAFT"?Ul.filter(ee=>!ee.deleted).map(ee=>{const{deleted:_e,removedBy:Ve,status:pn,ownerApprovedBy:Pr,ownerRejectedBy:yi,lockedDeleted:ln,lockedRejected:bo,...vi}=ee;return vi}):rv).map(ee=>Vh({...ee})),iv=$t(o,"requests",Do);let it,St=null,Vf=[];if(i){const ee=await sa(iv),_e=ee.exists()?ee.data():null;if(!_e&&!m)throw new Error("Request no longer exists.");const Ve=_e||m||{};St=Ve,Vf=Array.isArray(Ve.activityLog)?Ve.activityLog:[],it=Object.keys(Ve).reduce((pn,Pr)=>(Pr==="id"||(pn[Pr]=Ve[Pr]),pn),{})}else it={},Vf=Array.isArray(m==null?void 0:m.activityLog)?m==null?void 0:m.activityLog:[];St&&(le=(typeof St.note=="string"?St.note:typeof St.notes=="string"?St.notes:"")??""),delete it.draftLines,it.rqCode=Do,it.createdAt||(it.createdAt=(m==null?void 0:m.createdAt)||Ai()),(!i||!m)&&(it.createdBy=tv,it.fromDept=No),it.projectId=Kt,it.engineerId=Dt,it.urgent=or,it.note=kn||"",it.notes=kn||"",it.status=$r,it.stage=$r,$r==="CANCELED"?(it.canceledAt=Ai(),it.canceledBy={uid:(t==null?void 0:t.uid)||null,fullName:l||(t==null?void 0:t.displayName)||(t==null?void 0:t.email)||null,deptId:Ne||null}):("canceledAt"in it&&delete it.canceledAt,"canceledBy"in it&&delete it.canceledBy),it.lines=Bl,it.lineDeptIds=Bc,it.deptIndex=Bc,it.autoApprovedByDept=w==="DRAFT"?{}:nv,it.updatedAt=Ai(),it.readBy=it.readBy||(m==null?void 0:m.readBy)||{};const ov=String((St==null?void 0:St.status)||(St==null?void 0:St.stage)||"DRAFT").toUpperCase();if(St?ov!==$r&&dr("Status",`${ov} -> ${$r}`):dr("Initial status",$r),le!==rt){const ee=le&&rt.startsWith(le)?rt.slice(le.length).trim():"";!le&&rt?dr("Note added",rt):le&&!rt?dr("Note cleared",le):ee?dr("Note appended",ee):dr("Note updated",rt)}if(St){if((St.projectId||"")!==Kt&&dr("Project",`${Uc(St.projectId)} -> ${Uc(Kt)}`),(St.engineerId||"")!==Dt&&dr("Engineer",`${En(St.engineerId)} -> ${En(Dt)}`),!!St.urgent!==or){const Ve=!!St.urgent;dr("Urgent flag",`${Ve?"On":"Off"} -> ${or?"On":"Off"}`)}const ee=Array.isArray(St.lines)?St.lines:[],_e=(()=>{const Ve=new Map;ee.forEach((ln,bo)=>{Ve.set(Ut(ln,bo),ln)});const pn=[],Pr=[];Bl.forEach((ln,bo)=>{const vi=Ut(ln,bo);if(!Ve.has(vi)){pn.push(`${jl(ln)} (${Fl(ln)})`);return}const Ms=Ve.get(vi);Ve.delete(vi);const js=[];(Ms.qty??null)!==(ln.qty??null)&&js.push(`qty ${Ms.qty??"-"}->${ln.qty??"-"}`),(Ms.unit||"")!==(ln.unit||"")&&js.push(`unit ${Ms.unit||"-"}->${ln.unit||"-"}`);const uv=Ri(Ms),cv=Ri(ln);uv!==cv&&js.push(`status ${uv}->${cv}`);const YA=!!Ms.deleted,dv=!!ln.deleted;YA!==dv&&js.push(dv?"marked removed":"restored"),js.length&&Pr.push(`${jl(ln)} (${js.join(", ")})`)});const yi=[];return Ve.forEach(ln=>{yi.push(`${jl(ln)} (${Fl(ln)})`)}),{added:pn,updated:Pr,removed:yi}})();_a("Items added",_e.added),_a("Items updated",_e.updated),_a("Items removed",_e.removed)}St||(dr("Project",Uc(Kt)),dr("Engineer",En(Dt)),dr("Items",`${Bl.length}`));const GA=fs.join(`
`);let $c,zc;St?fs.length?($c="request_updated",zc=`${Ze} updated the request`):($c="request_saved",zc=`${Ze} saved the request`):($c="request_created",zc=`${Ze} created the request`),Jn.push({type:$c,summary:zc,details:GA||void 0,statusKey:$r});const QA=Date.now(),av=[...Jn.map((ee,_e)=>{const Ve=QA+_e;return{id:`evt-${Ve}-${Math.random().toString(36).slice(2,8)}`,type:ee.type,summary:ee.summary,details:ee.details||"",actor:st,createdAtMs:Ve,statusKey:ee.statusKey||$r}}),...Vf].slice(0,Zl);it.activityLog=av;const lv=Vh(it);console.log("saving payload",lv),await Ky(iv,lv),Qn(Do),Ar.current=Do,Qt(Bl.map((ee,_e)=>({...ee,key:ee.key||`${ee.itemId||"line"}-${_e}`,lockedDeleted:!!ee.deleted,lockedRejected:String(ee.status||"").toUpperCase()==="OWNER_REJECTED"}))),i&&(A(ee=>({...ee||{},rqCode:Do,fromDept:No,createdBy:tv,projectId:Kt,engineerId:Dt,urgent:or,note:kn,notes:kn,status:$r,stage:$r,lines:Bl,lineDeptIds:Bc,deptIndex:Bc,autoApprovedByDept:w==="DRAFT"?{}:nv,activityLog:av})),Nn.current=kn||""),S(!1),$&&n("/requests")}catch(le){console.error(le);const rt=(le==null?void 0:le.code)||"unknown",Ft=(le==null?void 0:le.message)||String(le);Se(`Error [${rt}]: ${Ft}`)}finally{ke(!1)}}},Yt=!He,xs=i&&P(Ne),cr=Wt&&(et||Pe),wo=Wt&&!cr&&f&&(Ht||Me),Eo=wo||!xn&&!cr&&!wo&&xs,nt=cr||Eo,ha=w=>{if(!nt)return;if(!Eo){w!==kn&&(S(!0),rs(w));return}const U=Nn.current||"";let $=w;if(U&&!$.startsWith(U))if(U.startsWith($))$=U;else{const J=$.length>=U.length?$.slice(U.length):"";$=U+J}$!==kn&&(S(!0),rs($))};C.useEffect(()=>{if(!i){Nn.current="";return}Eo?Nn.current=(m==null?void 0:m.note)||(m==null?void 0:m.notes)||"":Nn.current=""},[i,Eo,m==null?void 0:m.note,m==null?void 0:m.notes]),C.useEffect(()=>{if(!i){ar([]),lr(!1);return}if(!m){ar([]),lr(!0);return}const U=(Array.isArray(m==null?void 0:m.activityLog)?m.activityLog:[]).map(($,J)=>{var le;const pe=typeof($==null?void 0:$.createdAtMs)=="number"?$.createdAtMs:Qy($==null?void 0:$.createdAt),re=typeof pe=="number"?new Date(pe):(le=$==null?void 0:$.createdAt)!=null&&le.toDate?$.createdAt.toDate():null;return{id:($==null?void 0:$.id)||`evt-${J}`,type:($==null?void 0:$.type)||"event",summary:($==null?void 0:$.summary)||"",details:($==null?void 0:$.details)||"",actor:($==null?void 0:$.actor)||null,createdAt:re,statusKey:($==null?void 0:$.statusKey)||null}});ar(U),lr(!1)},[i,m]),C.useEffect(()=>{b({})},[s,Tt]);const To=!Yt&&!!Kt,So=!Yt&&!!Dt,Rf=()=>{Yt||(ir(""),rn(""),Ce(!0),je(!1),S(!0),setTimeout(()=>{var w;return(w=yo.current)==null?void 0:w.focus()},0))},Pc=()=>{Yt||(Gt(""),bn(""),je(!0),Ce(!1),S(!0),setTimeout(()=>{var w;return(w=Rc.current)==null?void 0:w.focus()},0))},Cf=w=>w.statusKey?w.statusKey:XO(w.details)||Ue,Pf=w=>{const U=Cf(w);return QO[U]||"bg-gray-300"},xf=w=>{b(U=>({...U,[w]:!U[w]}))},kf=async(w,U,$,J)=>{if(!Tt)return;const pe={uid:(t==null?void 0:t.uid)||null,fullName:l||(t==null?void 0:t.displayName)||(t==null?void 0:t.email)||null,deptId:Xe()},re=Date.now(),le={id:`evt-${re}-${Math.random().toString(36).slice(2,8)}`,type:w,summary:U,details:$||"",actor:pe,createdAtMs:re,statusKey:J},rt=Array.isArray(m==null?void 0:m.activityLog)?m==null?void 0:m.activityLog:[],Ft=[le,...rt].slice(0,Zl);await za($t(o,"requests",Tt),{activityLog:Ft}),A(st=>st&&{...st,activityLog:Ft}),ar(st=>[{id:le.id,type:w,summary:U,details:le.details,actor:pe,createdAt:new Date(re),statusKey:J},...st].slice(0,Zl))},os=C.useCallback(async(w,U)=>{if(Tt){ue(!0),Se(null);try{const $=Ue,J={uid:(t==null?void 0:t.uid)||null,fullName:l||(t==null?void 0:t.displayName)||(t==null?void 0:t.email)||null,deptId:Xe()},pe=Date.now(),re={id:`evt-${pe}-${Math.random().toString(36).slice(2,8)}`,type:"status_transition",summary:U,details:`Status: ${$} -> ${w}`,actor:J,createdAtMs:pe,statusKey:w},le=Array.isArray(m==null?void 0:m.activityLog)?m==null?void 0:m.activityLog:[],rt=[re,...le].slice(0,Zl);await za($t(o,"requests",Tt),{status:w,stage:w,updatedAt:Ai(),activityLog:rt});const Ft={id:re.id,type:re.type,summary:re.summary,details:re.details,actor:re.actor,createdAt:new Date(pe),statusKey:re.statusKey};A(st=>st&&{...st,status:w,stage:w,activityLog:rt}),ar(st=>[Ft,...st].slice(0,Zl)),qt(null)}catch($){console.error($);const J=($==null?void 0:$.code)||"unknown";Se(`Failed to update status (${J}).`)}finally{ue(!1)}}},[o,Tt,Ue,m==null?void 0:m.activityLog,t==null?void 0:t.uid,l,Xe]),as=w=>{var Ft,st,hs,Br,Ze;if(!w.status)return null;const $=Ri(w),J=HO[$];if(!J)return null;const pe=J.Icon;let re=J.label;if($==="OWNER_APPROVED"&&((Ft=w.ownerApprovedBy)!=null&&Ft.fullName)){const Jn=Sp(w.ownerApprovedBy.atMs??w.ownerApprovedBy.at);re=`Approved by ${w.ownerApprovedBy.fullName}${Jn?` at ${Jn}`:""}`}else if($==="OWNER_REJECTED"&&((st=w.ownerRejectedBy)!=null&&st.fullName)){const Jn=Sp(w.ownerRejectedBy.atMs??w.ownerRejectedBy.at);re=`Rejected by ${w.ownerRejectedBy.fullName}${Jn?` at ${Jn}`:""}`}else if($==="DELETED"){const Jn=(hs=w.removedBy)==null?void 0:hs.fullName,fs=Sp(((Br=w.removedBy)==null?void 0:Br.atMs)??((Ze=w.removedBy)==null?void 0:Ze.at));re=Jn?`Removed by ${Jn}${fs?` at ${fs}`:""}`:"Removed from request"}const le=J.wrapper||"inline-flex items-center text-gray-500",rt=J.icon||"h-4 w-4";return p.jsx("span",{className:le,title:re,children:p.jsx(pe,{className:rt})})},Io=w=>({...w,status:"PENDING_OWNER",ownerApprovedBy:null,ownerRejectedBy:null,removedBy:w.deleted?gd(w.removedBy):null,lockedRejected:!1});C.useEffect(()=>{if(!i||!GO.has(ct)){qt(null);return}const w=I0(ft);qt(w===ct?null:w)},[i,ft,ct]);const xc=w=>{if(!Nt)return;if(!R.has(String(w.ownerDeptId||"").toUpperCase())){Se(`You do not have permission to approve items owned by ${w.ownerDeptId}.`);return}if(P(w.ownerDeptId)){const $=vo(w.itemId);if(typeof $=="number"&&w.qty>$){Se(`Cannot approve this item because ${w.qty} requested but only ${$} in stock.`);return}}Qt($=>$.map(J=>J.key!==w.key?J:{...J,deleted:!1,status:"OWNER_APPROVED",ownerApprovedBy:{uid:t==null?void 0:t.uid,fullName:l,deptId:w.ownerDeptId,atMs:Date.now()},lockedRejected:!1})),S(!0)},kc=w=>{!Nt||!R.has(String(w.ownerDeptId||"").toUpperCase())||(Qt($=>$.map(J=>J.key===w.key?Io(J):J)),S(!0))},ks=w=>{if(!Rt||!f)return;const U=String(w.ownerDeptId||"").toUpperCase();(Ht||R.has(U))&&(Qt(J=>J.map(pe=>pe.key!==w.key?pe:String(pe.status||"").toUpperCase()==="OWNER_REJECTED"?{...Io(pe),deleted:!1}:{...pe,deleted:!1,status:"OWNER_REJECTED",ownerApprovedBy:null,ownerRejectedBy:{uid:t==null?void 0:t.uid,fullName:l,deptId:w.ownerDeptId,atMs:Date.now()},lockedRejected:!1})),S(!0))},Nc=w=>{if(!Ps(w)||w.lockedDeleted)return;if(Et){Qt($=>$.filter(J=>J.key!==w.key)),S(!0);return}const U={uid:t==null?void 0:t.uid,fullName:l,atMs:Date.now()};Qt($=>$.map(J=>{if(J.key!==w.key)return J;const pe=!J.deleted,re=Io(J);return pe?{...re,deleted:!0,lockedDeleted:J.lockedDeleted||!1,removedBy:U}:{...re,deleted:!1,lockedDeleted:!1,removedBy:null}})),S(!0)},Nf=async()=>{if(!Rr||!Tt){O?B(!0):n(-1);return}const w=O?"You have unsaved changes. Cancel this request anyway?":"Cancel this request for everyone?";if(window.confirm(w)){gt(!0),Se(null);try{const U=String((m==null?void 0:m.status)||(m==null?void 0:m.stage)||"SUBMITTED").toUpperCase(),$={status:"CANCELED",stage:"CANCELED",canceledAt:Ai()};$.canceledBy={uid:(t==null?void 0:t.uid)||null,fullName:l,deptId:Ne},await za($t(o,"requests",Tt),$),A(J=>J&&{...J,...$}),S(!1),qt(null),await kf("request_canceled","Request canceled",`Status: ${U} -> CANCELED`,"CANCELED")}catch(U){console.error(U);const $=(U==null?void 0:U.code)||"unknown";Se(`Failed to cancel request (${$}).`)}finally{gt(!1)}}},Df=async()=>{!pt||!O||await _o("DRAFT",{redirect:!1})},ls=async()=>{!pt||!O||await _o("SUBMITTED",{redirect:!1})},bf=async()=>{pt&&((O||!Tt)&&await _o("DRAFT",{redirect:!1}),await _o("SUBMITTED",{redirect:!0}))},[ui,us]=C.useState(""),[fa,Cr]=C.useState(!1),[Ns,ci]=C.useState(""),[Ao,Ds]=C.useState(""),[ot,pa]=C.useState(1),[Dc,cs]=C.useState(""),ma=C.useRef(null),Ro=["HSE","TRP","VRP","Store"],Co=C.useMemo(()=>{const w=ui.trim(),$=w.toLowerCase().split(/[\s,]+/).filter(Boolean),J=$.filter(le=>Ro.some(rt=>rt.toLowerCase()===le)),pe=$.filter(le=>!J.includes(le)),re=new Set(ft.map(le=>le.itemId));return W.filter(le=>{if(re.has(le.itemCode))return!1;if(!w)return!0;const rt=(le.nameEn||le.nameAr||"").toLowerCase(),Ft=(le.itemCode||"").toLowerCase(),st=(le.descriptionEn||le.descriptionAr||"").toLowerCase(),hs=pe.every(Ze=>rt.includes(Ze)||Ft.includes(Ze)||st.includes(Ze)),Br=J.length?J.some(Ze=>(le.ownerDeptId||"").toString().toLowerCase()===Ze):!0;return hs&&Br})},[W,ui,ft]),Ln=W.find(w=>w.itemCode===Ns||(w.nameEn||w.nameAr)===(ui||"")),jr=(Jy=Ln==null?void 0:Ln.allowedUnits)!=null&&Jy.length?Ln.allowedUnits:Ln!=null&&Ln.unit?[Ln.unit]:[],Ol=()=>{ci(""),Ds(""),pa(1),us("")},Lf=w=>{var U;dt&&(ci(w.itemCode),Ds(((U=w.allowedUnits)==null?void 0:U[0])||w.unit||""),us(w.nameEn||w.nameAr||w.itemCode),Cr(!1))},di=()=>{if(!dt){cs("You cannot add items to this request.");return}cs("");const w=W.find(re=>re.itemCode===Ns||(re.nameEn||re.nameAr)===ui);if(!w||!Ao||ot<=0)return;if(ft.some(re=>re.itemId===w.itemCode)){cs("Item already added. Please edit its quantity.");return}const U=`${w.itemCode}-${Date.now()}`,$=Ei(w.ownerDeptId);if(!$){cs("Item is missing an owner department.");return}if(P($)){const re=vo(w.itemCode);if(typeof re=="number"&&ot>re){cs(`Requested quantity (${ot}) exceeds available stock (${re}).`);return}}if(!He&&!R.has(String($||"").toUpperCase())){cs("You can only add items owned by your departments.");return}const pe={key:U,itemId:w.itemCode,itemName:w.nameEn||w.nameAr||w.itemCode,ownerDeptId:$,unit:Ao,qty:ot,status:"PENDING_OWNER",ownerApprovedBy:null,ownerRejectedBy:null,deleted:!1,removedBy:null,lockedDeleted:!1,lockedRejected:!1};Qt(re=>[...re,pe]),S(!0),Ol()},bc=()=>{var $;if(!dt||!fa)return null;const w=($=ma.current)==null?void 0:$.getBoundingClientRect();if(!w)return null;const U={position:"fixed",left:w.left,top:w.bottom+4,width:w.width,maxHeight:"28rem",overflowY:"auto",zIndex:9999};return Hu.createPortal(p.jsxs("div",{id:"item-combobox-overlay",className:"border bg-white rounded-md shadow",style:U,onMouseDown:J=>J.preventDefault(),children:[Ro.map(J=>{const pe=Co.filter(re=>re.ownerDeptId===J).sort((re,le)=>(re.nameEn||re.nameAr||"").localeCompare(le.nameEn||le.nameAr||""));return pe.length?p.jsxs("div",{children:[p.jsx("div",{className:"px-2 py-1 text-[11px] uppercase tracking-wide text-gray-500 bg-gray-50",children:J}),pe.map(re=>p.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-blue-50",onMouseDown:le=>{le.preventDefault(),Lf(re)},children:re.nameEn||re.nameAr||re.itemCode},re.itemCode))]},J):null}),Co.length===0&&p.jsx("div",{className:"px-3 py-2 text-gray-500",children:"No items"})]}),document.body)},[Fr,hi]=C.useState(null),[bs,Ls]=C.useState(""),[Of,Ur]=C.useState(!1),[fi,ga]=C.useState(""),[Po,pi]=C.useState(""),[ds,Vl]=C.useState(1),xo=C.useRef(null),Lc=w=>{if(!Lt)return;const U=ft.find(J=>J.key===w);if(!U||U.deleted)return;const $=W.find(J=>J.itemCode===U.itemId);hi(w),ga(($==null?void 0:$.itemCode)||U.itemId),pi(U.unit),Vl(U.qty),Ls(($==null?void 0:$.nameEn)||($==null?void 0:$.nameAr)||U.itemName),Ur(!1)},Ml=C.useMemo(()=>{const w=bs.trim();if(!w)return W;const $=w.toLowerCase().split(/[\s,]+/).filter(Boolean),J=$.filter(le=>Ro.some(rt=>rt.toLowerCase()===le)),pe=$.filter(le=>!J.includes(le)),re=new Set(ft.map(le=>le.itemId));if(Fr){const le=ft.find(rt=>rt.key===Fr);le&&re.delete(le.itemId)}return W.filter(le=>{if(re.has(le.itemCode))return!1;const rt=(le.nameEn||le.nameAr||"").toLowerCase(),Ft=(le.itemCode||"").toLowerCase(),st=(le.descriptionEn||le.descriptionAr||"").toLowerCase(),hs=pe.every(Ze=>rt.includes(Ze)||Ft.includes(Ze)||st.includes(Ze)),Br=J.length?J.some(Ze=>(le.ownerDeptId||"").toString().toLowerCase()===Ze):!0;return hs&&Br})},[W,bs,Fr,ft]),Os=w=>{var U;Lt&&(ga(w.itemCode),pi(((U=w.allowedUnits)==null?void 0:U[0])||w.unit||""),Ls(w.nameEn||w.nameAr||w.itemCode),Ur(!1))},Oc=()=>{if(!Lt||!Fr)return;const w=W.find($=>$.itemCode===fi||($.nameEn||$.nameAr)===bs);if(!w||!Po||ds<=0)return;if(P(w.ownerDeptId)){const $=vo(w.itemCode);if(typeof $=="number"&&ds>$){Se(`Cannot set ${w.itemCode} to ${ds}. Only ${$} in stock.`);return}}!He&&!R.has(String(w.ownerDeptId||"").toUpperCase())||(Qt($=>$.map(J=>{if(J.key!==Fr)return J;const pe={...J,key:J.key,itemId:w.itemCode,itemName:w.nameEn||w.nameAr||w.itemCode,ownerDeptId:w.ownerDeptId,unit:Po,qty:ds,deleted:J.deleted};return Io(pe)})),hi(null),Ur(!1),S(!0))},Vc=()=>{hi(null),Ur(!1)},Mc=()=>os("STORE_PREPARING","Store started preparing the request"),jc=()=>os("FULLY_APPROVED","Store canceled preparing"),ya=()=>os("READY","Store marked the request READY"),$n=()=>os("CLOSED","Request closed"),Fc=()=>{var $;if(!Lt||!Of||!Fr)return null;const w=($=xo.current)==null?void 0:$.getBoundingClientRect();if(!w)return null;const U={position:"fixed",left:w.left,top:w.bottom+4,width:w.width,maxHeight:"28rem",overflowY:"auto",zIndex:9999};return Hu.createPortal(p.jsxs("div",{id:"item-edit-overlay",className:"border bg-white rounded-md shadow",style:U,onMouseDown:J=>J.preventDefault(),children:[Ro.map(J=>{const pe=Ml.filter(re=>re.ownerDeptId===J).sort((re,le)=>(re.nameEn||re.nameAr||"").localeCompare(le.nameEn||le.nameAr||""));return pe.length?p.jsxs("div",{children:[p.jsx("div",{className:"px-2 py-1 text-[11px] uppercase tracking-wide text-gray-500 bg-gray-50",children:J}),pe.map(re=>p.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-blue-50",onMouseDown:le=>{le.preventDefault(),Os(re)},children:re.nameEn||re.nameAr||re.itemCode},re.itemCode))]},J):null}),Ml.length===0&&p.jsx("div",{className:"px-3 py-2 text-gray-500",children:"No items"})]}),document.body)};if(L||I)return p.jsx("div",{className:"card p-6",children:"Loading..."});const mi=i?(m==null?void 0:m.rqCode)||s||"Request":"New Request",gi=i&&m?((Xy=m.createdBy)==null?void 0:Xy.fullName)||((Zy=m.createdBy)==null?void 0:Zy.email)||"-":l,a=i&&m?((ev=m.createdBy)==null?void 0:ev.departmentId)||m.fromDept||"-":(u||[]).join("  ")||"-",d=i&&jt?p.jsx("span",{className:`badge badge-status status-${String(jt).toLowerCase().replace(/\s+/g,"_")}`,children:jt}):null,g=async()=>{var w;if(!(!i||!mi))try{if((w=navigator==null?void 0:navigator.clipboard)!=null&&w.writeText)await navigator.clipboard.writeText(mi);else{const U=document.createElement("textarea");U.value=mi,U.style.position="fixed",U.style.opacity="0",document.body.appendChild(U),U.select(),document.execCommand("copy"),document.body.removeChild(U)}be.current&&clearTimeout(be.current),Ie(!0),be.current=setTimeout(()=>{Ie(!1),be.current=null},1500)}catch(U){console.error("Failed to copy request code",U)}},E=Et,F=Et&&pt,z=Et&&(T&&nn||f&&Ht),ne=pt&&!Et,at=Rr,sn=()=>{if(O){Q.current=null,te("/requests"),B(!0);return}n("/requests")},We=()=>{wt||Nf()};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[i?p.jsxs("button",{type:"button",className:"text-xl font-semibold inline-flex items-center gap-2 hover:text-blue-700 focus:outline-none",onClick:g,title:"Copy request code",children:[p.jsx("span",{children:mi}),Ee&&p.jsx("span",{className:"text-xs font-medium text-green-600",children:"Copied"})]}):p.jsx("div",{className:"text-xl font-semibold",children:mi}),d]}),p.jsxs("div",{className:"card p-6 space-y-4",children:[p.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-sm text-gray-600",children:"Requested By"}),p.jsx("div",{className:"font-semibold",children:gi})]}),p.jsxs("div",{children:[p.jsx("div",{className:"text-sm text-gray-600",children:"Department"}),p.jsx("div",{className:"font-semibold",children:a})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs("label",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"checkbox",checked:or,disabled:Yt,onChange:w=>{Yt||(Ir(w.target.checked),S(!0))},className:Yt?"cursor-not-allowed accent-gray-400":""}),p.jsx("span",{children:"Urgent"})]})})]}),p.jsx("div",{className:"card table-card",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"table-modern",children:[p.jsx("thead",{className:"table-head",children:p.jsxs("tr",{children:[p.jsx("th",{className:"table-head-cell",children:p.jsx("span",{className:"header-content",children:"Item name"})}),p.jsx("th",{className:"table-head-cell",children:p.jsx("span",{className:"header-content",children:"Owner dept"})}),p.jsx("th",{className:"table-head-cell",children:p.jsx("span",{className:"header-content",children:"Unit"})}),p.jsx("th",{className:"table-head-cell",children:p.jsx("span",{className:"header-content",children:"Quantity"})}),p.jsx("th",{className:"table-head-cell",children:p.jsx("span",{className:"header-content",children:"Actions"})})]})}),p.jsxs("tbody",{children:[ve.map(w=>{var Fl;String(w.ownerDeptId||"").toUpperCase();const U=P(w.ownerDeptId),$=U?vo(w.itemId):void 0,J=U&&typeof $=="number"?p.jsxs("span",{children:[p.jsx("strong",{className:"text-lg font-semibold text-gray-900",children:w.qty}),p.jsxs("span",{className:"text-gray-500",children:["/",$]})]}):w.qty,pe=as(w),re=R.has(String(w.ownerDeptId||"").toUpperCase()),le=String(w.status||"").toUpperCase(),Ft=Ri(w)==="DELETED",st=le==="OWNER_REJECTED",hs=le==="OWNER_APPROVED",Br=!E&&!Ft&&!st&&Nt&&re,Ze=[],Jn=Lt&&(He||re),fs=Ps(w),_a=Lt&&Rt&&!E&&f&&(Ht||re)&&!(f&&nn&&fs);if(Ft?!w.lockedDeleted&&Jn&&(E||O)?Ze.push(p.jsx("button",{className:"btn-ghost px-4 text-sm font-medium text-gray-700 border border-gray-300 bg-white transition-all duration-150",onClick:()=>Nc(w),children:"Restore"},`${w.key}-restore`)):Ze.push(p.jsx("span",{className:"text-xs text-gray-400",children:"Removed"},`${w.key}-removed`)):st?_a&&O&&!w.lockedRejected?Ze.push(p.jsx("button",{className:"btn-ghost px-4 text-sm font-medium text-green-700 border border-green-400 bg-white transition-all duration-150",onClick:()=>ks(w),children:"Accept"},`${w.key}-accept`)):Ze.push(p.jsx("span",{className:"text-xs text-red-600 font-semibold",children:"Rejected"},`${w.key}-rejected`)):hs&&Br?Ze.push(p.jsx("button",{className:"btn-ghost px-4 text-sm font-medium text-amber-700 border border-amber-400 bg-white transition-all duration-150",onClick:()=>kc(w),children:"Disapprove"},`${w.key}-disapprove`)):(Jn?(Ze.push(p.jsx("button",{className:"btn-ghost",onClick:()=>Lc(w.key),children:p.jsx(VO,{className:"h-4 w-4 icon-blue"})},`${w.key}-edit`)),fs&&Ze.push(p.jsx("button",{className:"btn-ghost",onClick:()=>Nc(w),children:p.jsx(BA,{className:"h-4 w-4 text-red-600"})},`${w.key}-del`))):Ze.push(p.jsx("span",{className:"text-xs text-gray-400",children:"View only"},`${w.key}-view`)),_a&&Ze.push(p.jsx("button",{className:"btn-line-reject",title:"Reject item",onClick:()=>ks(w),children:p.jsx(FA,{className:"h-4 w-4 text-white"})},`${w.key}-reject`)),Br&&Ze.push(p.jsx("button",{className:"btn-line-approve",title:"Approve",onClick:()=>xc(w),children:p.jsx(jA,{className:"h-4 w-4 text-white"})},`${w.key}-approve`))),!Lt)return p.jsxs("tr",{className:"table-row",children:[p.jsx("td",{className:"p-3",children:p.jsxs("div",{className:"flex items-center gap-2",children:[pe,p.jsxs("span",{children:[w.itemName," ",p.jsxs("span",{className:"text-gray-500",children:["(",w.itemId,")"]})]})]})}),p.jsx("td",{className:"p-3",children:w.ownerDeptId}),p.jsx("td",{className:"p-3",children:w.unit}),p.jsx("td",{className:"p-3",children:J}),p.jsx("td",{className:"p-3",children:p.jsx("div",{className:"flex flex-wrap gap-2 transition-all duration-200",children:Ze})})]},w.key);if(!(w.key===Fr))return p.jsxs("tr",{className:"table-row",children:[p.jsx("td",{className:"p-3",children:p.jsxs("div",{className:"flex items-center gap-2",children:[pe,p.jsxs("span",{children:[w.itemName," ",p.jsxs("span",{className:"text-gray-500",children:["(",w.itemId,")"]})]})]})}),p.jsx("td",{className:"p-3",children:w.ownerDeptId}),p.jsx("td",{className:"p-3",children:w.unit}),p.jsx("td",{className:"p-3",children:J}),p.jsx("td",{className:"p-3",children:p.jsx("div",{className:"flex flex-wrap gap-2 transition-all duration-200",children:Ze})})]},w.key);const En=W.find(Ut=>Ut.itemCode===fi)||W.find(Ut=>(Ut.nameEn||Ut.nameAr)===bs),jl=(Fl=En==null?void 0:En.allowedUnits)!=null&&Fl.length?En.allowedUnits:En!=null&&En.unit?[En.unit]:[];return p.jsxs("tr",{className:"table-row bg-gray-50",children:[p.jsx("td",{className:"p-3 align-top",children:p.jsxs("div",{ref:xo,className:"relative",children:[p.jsx("input",{autoComplete:"off",className:"input pr-16",placeholder:"Search item",value:bs,onFocus:()=>{Yt||(Ur(!0),Ce(!1),je(!1),Cr(!1))},onChange:Ut=>{Ls(Ut.target.value),Ur(!0),Ce(!1),je(!1),Cr(!1)},onKeyDown:Ut=>{Ut.key==="Escape"&&Ur(!1)}}),Lt&&bs&&p.jsx("button",{type:"button",className:"absolute right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1","aria-label":"Clear item search",onMouseDown:Ut=>Ut.preventDefault(),onClick:()=>{Ls(""),ga(""),pi(""),Ur(!0)},children:p.jsx(pd,{className:"h-4 w-4"})}),p.jsx(Sa,{className:"h-4 w-4 text-gray-500 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"}),p.jsx(Fc,{})]})}),p.jsx("td",{className:"p-3 align-top",children:(En==null?void 0:En.ownerDeptId)||w.ownerDeptId}),p.jsx("td",{className:"p-3 align-top",children:p.jsxs("select",{className:"input",disabled:!En,value:Po,onChange:Ut=>pi(Ut.target.value),children:[p.jsx("option",{value:"",children:"Unit"}),jl.map(Ut=>p.jsx("option",{value:Ut,children:Ut},Ut))]})}),p.jsx("td",{className:"p-3 align-top",children:p.jsx("input",{autoComplete:"off",className:"input",type:"number",min:1,value:ds,onChange:Ut=>Vl(Number(Ut.target.value))})}),p.jsx("td",{className:"p-3 align-top",children:p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!En||!Po||ds<=0,onClick:Oc,children:"Save"}),p.jsx("button",{type:"button",className:"btn-ghost",onClick:Vc,children:"Cancel"})]})})]},w.key)}),dt&&p.jsxs("tr",{className:"table-row bg-white/60",children:[p.jsxs("td",{className:"p-3 align-top",children:[p.jsxs("div",{ref:ma,className:"relative",children:[p.jsx("input",{autoComplete:"off",className:"input pr-16",placeholder:"Search item (e.g. HSE, FI)",value:ui,onFocus:()=>{dt&&(Cr(!0),Ce(!1),je(!1))},onChange:w=>{dt&&(us(w.target.value),Cr(!0),Ce(!1),je(!1))},onKeyDown:w=>{w.key==="Escape"&&Cr(!1)}}),dt&&(ui||Ns)&&p.jsx("button",{type:"button",className:"absolute right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1","aria-label":"Clear item selection",onMouseDown:w=>w.preventDefault(),onClick:()=>{Ol(),cs(""),Cr(!1)},children:p.jsx(pd,{className:"h-4 w-4"})}),p.jsx(Sa,{className:"h-4 w-4 text-gray-500 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"}),p.jsx(bc,{})]}),Dc&&p.jsx("div",{className:"text-red-600 text-xs mt-1",children:Dc})]}),p.jsx("td",{className:"p-3 align-top",children:(Ln==null?void 0:Ln.ownerDeptId)||"-"}),p.jsx("td",{className:"p-3 align-top",children:p.jsxs("select",{className:"input",disabled:!Ln,value:Ao,onChange:w=>Ds(w.target.value),children:[p.jsx("option",{value:"",children:"Unit"}),jr.map(w=>p.jsx("option",{value:w,children:w},w))]})}),p.jsx("td",{className:"p-3 align-top",children:p.jsx("input",{autoComplete:"off",className:"input",type:"number",min:1,value:ot,onChange:w=>pa(Number(w.target.value)),onKeyDown:w=>{w.key==="Enter"&&di(),w.key==="Escape"&&(us(""),Ds(""),pa(1))},placeholder:"Quantity"})}),p.jsx("td",{className:"p-3 align-top",children:p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!dt||!Ln||!Ao||ot<=0,onClick:di,children:"Add"}),p.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>{us(""),Ds(""),pa(1),Cr(!1)},children:"Clear"})]})})]})]})]})})}),p.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Project"}),p.jsxs("div",{ref:ur,className:"relative",children:[p.jsx("input",{ref:yo,autoComplete:"off",className:`input pr-16 ${Yt?"cursor-not-allowed bg-gray-100 text-gray-600":""}`,placeholder:"Select project",value:fn,disabled:Yt,readOnly:Yt,onFocus:()=>{Yt||(Ce(!0),je(!1))},onChange:w=>{Yt||(rn(w.target.value),Ce(!0),je(!1),S(!0))}}),To&&p.jsx("button",{type:"button",className:"absolute right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1","aria-label":"Clear project selection",onMouseDown:w=>w.preventDefault(),onClick:Rf,children:p.jsx(pd,{className:"h-4 w-4"})}),p.jsx(Sa,{className:"h-4 w-4 text-gray-500 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"}),ss&&p.jsxs("div",{className:"absolute z-10 mt-1 w-full border bg-white rounded-md shadow",style:{maxHeight:"28rem",overflowY:"auto"},children:[_.filter(w=>{const U=fn.toLowerCase(),$=(w.nameEn||w.nameAr||w.name||"").toLowerCase();return!U||$.includes(U)}).sort((w,U)=>(w.nameEn||w.nameAr||w.name||"").localeCompare(U.nameEn||U.nameAr||U.name||"")).map(w=>p.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-blue-50",onClick:()=>{ir(w.id),rn(w.nameEn||w.nameAr||w.name||""),Ce(!1)},children:w.nameEn||w.nameAr||w.name},w.id)),_.length===0&&p.jsx("div",{className:"px-3 py-2 text-gray-500",children:"No projects"})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Engineer"}),p.jsxs("div",{ref:li,className:"relative",children:[p.jsx("input",{ref:Rc,autoComplete:"off",className:`input pr-16 ${Yt?"cursor-not-allowed bg-gray-100 text-gray-600":""}`,placeholder:"Select engineer",value:tt,disabled:Yt,readOnly:Yt,onFocus:()=>{Yt||(je(!0),Ce(!1))},onChange:w=>{Yt||(bn(w.target.value),je(!0),Ce(!1),S(!0))}}),So&&p.jsx("button",{type:"button",className:"absolute right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1","aria-label":"Clear engineer selection",onMouseDown:w=>w.preventDefault(),onClick:Pc,children:p.jsx(pd,{className:"h-4 w-4"})}),p.jsx(Sa,{className:"h-4 w-4 text-gray-500 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"}),is&&p.jsxs("div",{className:"absolute z-10 mt-1 w-full border bg-white rounded-md shadow",style:{maxHeight:"28rem",overflowY:"auto"},children:[j.filter(w=>{const U=tt.toLowerCase(),$=(w.nameEn||w.nameAr||"").toLowerCase();return!U||$.includes(U)}).sort((w,U)=>(w.nameEn||w.nameAr||"").localeCompare(U.nameEn||U.nameAr||"")).map(w=>p.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-blue-50",onClick:()=>{Gt(w.id),bn(w.nameEn||w.nameAr||""),je(!1)},children:w.nameEn||w.nameAr},w.id)),j.length===0&&p.jsx("div",{className:"px-3 py-2 text-gray-500",children:"No engineers"})]})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Notes (Optional)"}),p.jsx("textarea",{autoComplete:"off",className:`input resize-none ${nt?"":"cursor-not-allowed bg-gray-100 text-gray-600"}`,rows:3,wrap:"off",style:{overflowX:"auto",overflowY:"auto",whiteSpace:"pre"},value:kn,readOnly:!nt,disabled:!nt,onChange:w=>ha(w.target.value),placeholder:"Notes (Optional)"})]}),ye&&p.jsx("div",{className:"text-red-600",children:ye}),p.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[p.jsx("button",{className:"btn-ghost",onClick:sn,children:"Back"}),at&&p.jsx("button",{className:"btn-ghost text-red-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:de||wt,onClick:We,children:wt?"Canceling...":"Cancel Request"}),F&&p.jsx("button",{className:"btn-ghost disabled:opacity-50 disabled:cursor-not-allowed",disabled:!O||de,onClick:Df,children:de?"Saving...":"Save Draft"}),Y&&p.jsx("button",{className:"btn-primary bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:G,onClick:Mc,children:G?"Updating...":"PREPARING"}),fe&&p.jsx("button",{className:"btn-ghost disabled:opacity-50 disabled:cursor-not-allowed",disabled:G,onClick:jc,children:G?"Updating...":"Cancel PREPARING"}),me&&p.jsx("button",{className:"btn-primary bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:G,onClick:ya,children:G?"Updating...":"READY"}),De&&p.jsx("button",{className:"btn-primary bg-gray-900 hover:bg-black disabled:opacity-50 disabled:cursor-not-allowed",disabled:G,onClick:$n,children:G?"Updating...":"Close"}),ne&&p.jsx("button",{className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!O||de,onClick:ls,children:de?"Saving...":"Save"}),z&&p.jsx("button",{className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:de,onClick:bf,children:de?"Sending...":"Submit"})]})]}),i&&p.jsxs("div",{className:"card mt-6 p-0 overflow-hidden",children:[p.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 border-b border-gray-100",onClick:()=>Cs(w=>!w),children:[p.jsx("span",{className:"text-base font-semibold text-gray-800",children:"History"}),p.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[wn?"Hide":"Show",p.jsx(Sa,{className:`h-4 w-4 transition-transform duration-200 ${wn?"rotate-180":""}`})]})]}),p.jsx("div",{className:`transition-[max-height] duration-300 ${wn?"max-h-[320px]":"max-h-0"} overflow-hidden`,children:wn&&p.jsx("div",{className:"max-h-[320px] overflow-y-auto",children:Mr?p.jsx("div",{className:"px-4 py-6 text-sm text-gray-500",children:"Loading"}):Dn.length===0?p.jsx("div",{className:"px-4 py-6 text-sm text-gray-500",children:"No history yet."}):p.jsx("div",{className:"overflow-x-auto",children:p.jsx("ul",{className:"divide-y divide-gray-100 min-w-full",children:Dn.map(w=>{const U=!!bt[w.id];return p.jsx("li",{children:p.jsx("button",{type:"button",className:"w-full px-4 py-3 text-left",onClick:()=>xf(w.id),children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx("span",{className:`mt-1 h-2.5 w-2.5 rounded-full ${Pf(w)}`}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-start justify-between gap-3",children:[p.jsx("p",{className:"text-sm font-semibold text-gray-900",children:JO(w.actor)}),p.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:w.createdAt?YO(w.createdAt):""})]}),U&&w.details&&w.details.trim()&&p.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap break-words",children:w.details})]}),p.jsx(Sa,{className:`h-4 w-4 text-gray-400 transition-transform duration-200 ${U?"rotate-180":""}`})]})})},w.id)})})})})})]}),p.jsx("div",{style:{height:"40vh"}}),M&&p.jsx("div",{className:"fixed inset-0 z-[99999] bg-black/30 flex items-center justify-center",children:p.jsxs("div",{className:"card p-6 max-w-md w-full",children:[p.jsx("div",{className:"text-base font-semibold mb-2",children:"Unsaved changes"}),p.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"You have unsaved changes. Stay on this page to save your draft, or leave without saving."}),p.jsxs("div",{className:"flex gap-2 justify-end",children:[p.jsx("button",{className:"btn-primary",onClick:()=>{B(!1),Q.current=null,te(null)},children:"Stay on this page"}),p.jsx("button",{className:"btn-ghost",onClick:()=>{const w=Q.current,U=ae;if(B(!1),te(null),Q.current=null,U){window.location.href=U;return}w&&(w.kind==="push"&&w.args?ie.current.apply(history,w.args):w.kind==="replace"&&w.args?se.current.apply(history,w.args):w.kind==="pop"&&history.back())},children:"Leave without saving"})]})]})})]})}function Ud(t){if(!t)return null;if(typeof t=="object"&&typeof t.toDate=="function")try{return t.toDate()}catch{}if(t instanceof Date)return t;if(typeof t=="string"){const e=/^(\d{4})-(\d{2})-(\d{2})/.exec(t);if(e){const r=Number(e[1]),s=Number(e[2]),i=Number(e[3]);return new Date(r,s-1,i,0,0,0)}const n=new Date(t);if(!isNaN(n.getTime()))return n}return null}function eV(t){const e=Ud(t);if(!e)return"-";const n=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),s=e.getFullYear();let i=e.getHours();const o=String(e.getMinutes()).padStart(2,"0"),l=i>=12?"PM":"AM";i=i%12,i===0&&(i=12);const u=String(i).padStart(2,"0");return`${n}-${r}-${s} ${u}:${o} ${l}`}function tV(){var Pn,xn,hn;const{role:t}=ns(),e=oi(),n=(t==null?void 0:t.departmentIds)||[],r=!!((Pn=t==null?void 0:t.roles)!=null&&Pn.admin),s=!!((xn=t==null?void 0:t.roles)!=null&&xn.storeOfficer),i=((t==null?void 0:t.departmentIds)||[]).includes("Store"),o=!!((hn=t==null?void 0:t.roles)!=null&&hn.deptManager),l=r||s||o,[u,c]=C.useState([]),[h,f]=C.useState(""),y=(()=>{try{const Y=localStorage.getItem("inventory.filters");if(Y){const fe=JSON.parse(Y);if(Array.isArray(fe.columns))return fe.columns.filter(me=>typeof me=="string")}}catch{}return["itemName"]})(),[T,R]=C.useState(y),[D,V]=C.useState(!1),[P,_]=C.useState(!1),[x,j]=C.useState(""),[q,W]=C.useState(new Date().getFullYear()),[v,m]=C.useState(new Date().getMonth()+1),[A,I]=C.useState(""),[N,L]=C.useState(1),k=20,[de,ke]=C.useState("code"),[wt,gt]=C.useState("asc"),G=C.useRef(null),ue=C.useRef(null),[ye,Se]=C.useState(!0);C.useEffect(()=>{(async()=>{Se(!0);try{c(await RO(500))}finally{Se(!1)}})()},[]);const Ee=Y=>{gt(fe=>de===Y&&fe==="asc"?"desc":"asc"),ke(Y)},Ie=Y=>{let fe="table-head-cell";return Y&&(fe+=" sortable"),Y&&de===Y&&(fe+=" active-sort"),fe},be=Y=>Y&&de===Y?p.jsx("span",{className:"sort-pill",children:wt==="asc"?"ASC":"DESC"}):null;C.useEffect(()=>{t&&!l&&e("/requests",{replace:!0})},[l,t]),C.useEffect(()=>{try{localStorage.setItem("inventory.filters",JSON.stringify({columns:T}))}catch{}},[T.join(",")]),C.useEffect(()=>{const Y=fe=>{var Be,Pe;const me=fe.target;(Be=G.current)!=null&&Be.contains(me)||V(!1),(Pe=ue.current)!=null&&Pe.contains(me)||_(!1)};return window.addEventListener("mousedown",Y,!0),()=>window.removeEventListener("mousedown",Y,!0)},[]);function Ne(Y){const fe=h.split("|").map(Be=>Be.trim()).filter(Boolean),me=[(Y.itemCode||"").toString().toLowerCase(),(Y.nameEn||Y.nameAr||"").toLowerCase(),(Y.unit||"").toLowerCase(),(Y.ownerDeptId||"").toLowerCase(),(Y.descriptionEn||Y.descriptionAr||"").toLowerCase()].join(` 
 `);return fe.length===0?!0:fe.some(Be=>Be.split(/[\s,]+/).filter(Boolean).every(Pe=>me.includes(Pe.toLowerCase())))}const Xe=C.useMemo(()=>{let Y=u.slice();if(!r&&!i){const fe=new Set(n.map(me=>String(me).toUpperCase()));Y=Y.filter(me=>fe.has(String(me.ownerDeptId||"").toUpperCase()))}return x&&(Y=Y.filter(fe=>{const me=Ud(fe.updatedAt);if(!me)return!1;const Be=me.getFullYear(),Pe=String(me.getMonth()+1).padStart(2,"0"),Ye=String(me.getDate()).padStart(2,"0");return`${Be}-${Pe}-${Ye}`===x})),h.trim()&&(Y=Y.filter(Ne)),Y.sort((fe,me)=>{const Be=wt==="asc"?1:-1;if(de==="code")return(fe.itemCode||"").localeCompare(me.itemCode||"")*Be;if(de==="name")return(fe.nameEn||fe.nameAr||"").localeCompare(me.nameEn||me.nameAr||"")*Be;if(de==="unit")return(fe.unit||"").localeCompare(me.unit||"")*Be;if(de==="owner")return(fe.ownerDeptId||"").localeCompare(me.ownerDeptId||"")*Be;if(de==="available")return((fe.qty||0)-(me.qty||0))*Be;if(de==="reorder")return((fe.reorderLevel||0)-(me.reorderLevel||0))*Be;if(de==="updatedAt"){const Pe=Ud(fe.updatedAt),Ye=Ud(me.updatedAt),et=Pe?Pe.getTime():0,Nt=Ye?Ye.getTime():0;return(et-Nt)*Be}return 0}),Y},[u,h,x,de,wt]),Qe=Math.max(1,Math.ceil(Xe.length/k)),ct=Xe.slice((N-1)*k,(N-1)*k+k);C.useEffect(()=>{N>Qe&&L(1)},[Qe]);const Tr=[{key:"itemName",label:"Item name"},{key:"owner",label:"Owner dept"},{key:"unit",label:"Unit"},{key:"description",label:"Description"},{key:"reorder",label:"Reorder level"},{key:"updatedAt",label:"Updated at"}],qt=Y=>R(fe=>fe.includes(Y)?fe.filter(me=>me!==Y):[...fe,Y]),jt=["itemName"],Ue=C.useMemo(()=>{if(T.length!==jt.length)return!1;const Y=new Set(T);return jt.every(fe=>Y.has(fe))},[T.join(",")]),Et=!!x,nn=!Ue,Ht=Et?"btn-primary font-semibold":"btn-ghost",Wt=nn?"btn-primary font-semibold":"btn-ghost",Sr=Y=>String(Y).padStart(2,"0"),Vr=()=>{f(""),R(jt),j(""),I(""),L(1),ke("code"),gt("asc")};return p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"text-xl font-semibold",children:"Inventory"}),p.jsxs("div",{className:"flex flex-wrap items-center gap-3 justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[320px]",children:[p.jsx("input",{autoComplete:"off",className:"input w-1/2",placeholder:"Search items (multi-token, OR with |)",value:h,onChange:Y=>{f(Y.target.value),L(1)}}),p.jsxs("div",{ref:ue,className:"relative",children:[p.jsx("button",{className:Ht,onClick:()=>{if(x){const Y=/^(\d{4})-(\d{2})-(\d{2})$/.exec(x);Y&&(W(Number(Y[1])),m(Number(Y[2])),I(x))}else{const Y=new Date;W(Y.getFullYear()),m(Y.getMonth()+1),I("")}_(Y=>!Y)},children:"Date"}),P&&p.jsxs("div",{className:"absolute right-0 z-10 mt-1 w-64 border bg-white rounded-md shadow p-3",children:[p.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Updated at"}),p.jsxs("div",{className:"mb-2",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("button",{className:"btn-ghost",onClick:()=>{let Y=v-1,fe=q;Y<1&&(Y=12,fe--),m(Y),W(fe)},children:"<"}),p.jsxs("div",{className:"font-semibold",children:[new Date(q,v-1,1).toLocaleString(void 0,{month:"short"})," ",q]}),p.jsx("button",{className:"btn-ghost",onClick:()=>{let Y=v+1,fe=q;Y>12&&(Y=1,fe++),m(Y),W(fe)},children:">"})]}),p.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs text-gray-600 mb-1",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(Y=>p.jsx("div",{children:Y},Y))}),p.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:(()=>{const fe=new Date(q,v-1,1).getDay(),me=new Date(q,v,0).getDate(),Be=[];for(let Pe=0;Pe<fe;Pe++)Be.push(null);for(let Pe=1;Pe<=me;Pe++)Be.push(Pe);return Be.map((Pe,Ye)=>{if(Pe===null)return p.jsx("div",{className:"h-8"},Ye);const et=`${q}-${Sr(v)}-${Sr(Pe)}`,Kt=A===et?"bg-blue-600 text-white":"hover:bg-blue-50";return p.jsx("button",{className:`h-8 rounded ${Kt}`,onClick:()=>{I(et)},children:Pe},Ye)})})()})]}),p.jsx("div",{className:"mt-2 flex gap-2 justify-end",children:p.jsx("button",{className:"btn-primary",onClick:()=>{j(A||""),_(!1),ke("updatedAt"),gt("desc"),L(1)},children:"Apply"})})]})]}),p.jsxs("div",{ref:G,className:"relative",children:[p.jsx("button",{className:Wt,onClick:()=>V(Y=>!Y),children:"Category"}),D&&p.jsxs("div",{className:"absolute right-0 z-10 mt-1 w-64 border bg-white rounded-md shadow p-2 max-h-96 overflow-auto",children:[p.jsx("div",{className:"px-2 py-1 text-xs text-gray-500",children:"Columns (fixed: Item code, Available)"}),Tr.map(Y=>p.jsxs("label",{className:"flex items-center gap-2 px-2 py-1 hover:bg-blue-50 rounded",children:[p.jsx("input",{type:"checkbox",checked:T.includes(Y.key),onChange:()=>qt(Y.key)}),p.jsx("span",{children:Y.label})]},Y.key))]})]}),p.jsx("button",{className:"btn-ghost disabled:opacity-50 disabled:cursor-not-allowed",disabled:!(h.trim()||!Ue||x||de!=="code"||wt!=="asc"||N!==1),onClick:Vr,children:"Clear"})]}),p.jsx("div",{className:"shrink-0",children:p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{className:"btn-ghost",onClick:()=>L(Y=>Math.max(1,Y-1)),children:"< Prev"}),Array.from({length:Math.min(10,Qe)}).map((Y,fe)=>{const me=fe+1,Be=me===N?"inline-flex items-center justify-center h-8 w-8 rounded-full bg-blue-600 text-white":"inline-flex items-center justify-center h-8 w-8 rounded-full text-blue-700 hover:bg-blue-50";return p.jsx("button",{className:Be,onClick:()=>L(me),children:me},me)}),Qe>10&&p.jsxs("span",{className:"px-2",children:[" ",Qe]}),p.jsx("button",{className:"btn-ghost",onClick:()=>L(Y=>Math.min(Qe,Y+1)),children:"Next >"})]})})]}),ye?p.jsx("div",{className:"card p-6",children:"Loading..."}):p.jsx("div",{className:"card table-card",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"table-modern",children:[p.jsx("thead",{className:"table-head",children:p.jsxs("tr",{children:[p.jsx("th",{className:Ie("code"),onClick:()=>Ee("code"),children:p.jsxs("span",{className:"header-content",children:["Item code ",be("code")]})}),T.includes("itemName")&&p.jsx("th",{className:Ie("name"),onClick:()=>Ee("name"),children:p.jsxs("span",{className:"header-content",children:["Item name ",be("name")]})}),T.includes("unit")&&p.jsx("th",{className:Ie("unit"),onClick:()=>Ee("unit"),children:p.jsxs("span",{className:"header-content",children:["Unit ",be("unit")]})}),T.includes("owner")&&p.jsx("th",{className:Ie("owner"),onClick:()=>Ee("owner"),children:p.jsxs("span",{className:"header-content",children:["Owner dept ",be("owner")]})}),p.jsx("th",{className:Ie("available"),onClick:()=>Ee("available"),children:p.jsxs("span",{className:"header-content",children:["Available ",be("available")]})}),T.includes("description")&&p.jsx("th",{className:"table-head-cell",children:p.jsx("span",{className:"header-content",children:"Description"})}),T.includes("reorder")&&p.jsx("th",{className:Ie("reorder"),onClick:()=>Ee("reorder"),children:p.jsxs("span",{className:"header-content",children:["Reorder level ",be("reorder")]})}),T.includes("updatedAt")&&p.jsx("th",{className:Ie("updatedAt"),onClick:()=>Ee("updatedAt"),children:p.jsxs("span",{className:"header-content",children:["Updated at ",be("updatedAt")]})})]})}),p.jsx("tbody",{children:ct.length?ct.map(Y=>p.jsxs("tr",{className:"table-row",children:[p.jsx("td",{className:"p-3",children:Y.itemCode}),T.includes("itemName")&&p.jsx("td",{className:"p-3",children:Y.nameEn||Y.nameAr||"-"}),T.includes("unit")&&p.jsx("td",{className:"p-3",children:Y.unit}),T.includes("owner")&&p.jsx("td",{className:"p-3",children:Y.ownerDeptId}),p.jsx("td",{className:"p-3",children:Y.qty}),T.includes("description")&&p.jsx("td",{className:"p-3",children:Y.descriptionEn||Y.descriptionAr||""}),T.includes("reorder")&&p.jsx("td",{className:"p-3",children:Y.reorderLevel??"-"}),T.includes("updatedAt")&&p.jsx("td",{className:"p-3",children:eV(Y.updatedAt)})]},Y.id)):p.jsx("tr",{children:p.jsx("td",{className:"p-3 text-gray-500",colSpan:7,children:"No items"})})})]})})})]})}function nV(){var r;const{role:t}=ns(),e=oi(),n=!!((r=t==null?void 0:t.roles)!=null&&r.auditor);return C.useEffect(()=>{n||e("/requests",{replace:!0})},[n]),p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"text-xl font-semibold",children:"Reporting"}),p.jsx("div",{className:"card p-6 text-gray-500",children:"Reports dashboard (coming soon)"})]})}function rV(){const{user:t,role:e}=ns(),n=OA(e,t);return p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"text-xl font-semibold",children:"Profile"}),p.jsxs("div",{className:"card p-6",children:[p.jsx("div",{children:p.jsx("b",{children:n})}),p.jsx("div",{className:"text-gray-600 text-sm",children:t==null?void 0:t.email})]})]})}function sV(){var i;const{role:t}=ns(),[e,n]=C.useState(""),r=Or();if(!((i=t==null?void 0:t.roles)!=null&&i.admin))return p.jsx("div",{className:"card p-4",children:"Admin only."});const s=async()=>{n("Seeding...");try{if((await sa($t(r,"meta","seed_v1"))).exists()){n("Already seeded.");return}const l=bA(r);["Artawi - Workshop","CPS03 - Laydown Area Repair","CPS07 - AX46","CPS07 - R 679 DZ 59","DS01 - E&I","DS01 - MOC 493 & 494","DS01 - VRP TR I&H","DS02 - E&I","DS02 - Scaffolding","DS03 - Hydrovac","DS04 - Hydrovac","DS04 - Scaffolding","DS05 - Band Wall","DS05 - MF5/4","DS05 - Scaffolding","DS05 - TAR MOC 701","MDS - MOC374","MDS - Scaffolding","MSDS - VRP TR I DH Lower","NIDS - HS18","PWRI","QDS - MOC 857","QDS - MOC356","QDS - Scaffolding","QDS - TRP TK02","Qurainat - Train A&B PWD Line Represents","RPP - Scaffolding","SDS - BR36","SDS - BU35","SDS - Scaffolding","Other"].forEach((R,D)=>l.set($t(r,"projects",`P${D+1}`),{nameEn:R,nameAr:R,active:!0})),[{ar:"  ",en:"Ahmed Mohsen Hadi"},{ar:" ",en:"Abdul Samad Hadi"},{ar:" ",en:"Yousif Chaseb"},{ar:"  ",en:"Hussain Abdul Karem"}].forEach((R,D)=>l.set($t(r,"engineers",`E${D+1}`),{nameAr:R.ar,nameEn:R.en,active:!0}));const h=[["HSE-001"," ","    ","",50,"HSE","2025-10-25","Safety Helmet","Hard hat for impact protection"],["HSE-002"," ","    ","",120,"HSE","2025-10-25","Work Gloves","Thick leather gloves for heavy duty"],["HSE-003"," ","     ","",85,"HSE","2025-10-25","Safety Goggles","Clear protective goggles"],["HSE-004"," "," N95     ","",40,"HSE","2025-10-26","Face Mask N95","N95 mask for dust/chemicals"],["HSE-005"," ","    ","",200,"HSE","2025-10-26","Reflective Vest","Hi-vis reflective vest"],["HSE-006"," ","    ","",60,"HSE","2025-10-27","Safety Shoes","Steel-toe slip-resistant shoes"],["HSE-007"," ","   6 ","",30,"HSE","2025-10-27","Fire Extinguisher","6kg dry powder extinguisher"],["HSE-008","  ","   ","",15,"HSE","2025-10-28","First Aid Kit","Basic kit for minor injuries"],["HSE-009"," ",' " " ',"",10,"HSE","2025-10-28","Warning Sign","Plastic Work Area sign"],["HSE-010"," ","    ","",50,"HSE","2025-10-29","Sanitizer","Surface & hand sanitizer"]],f=[["TRP-001"," ","    ","",300,"TRP","2025-10-20","Engine Oil","Synthetic engine oil"],["TRP-002"," ","  22.5 ","",45,"TRP","2025-10-21","Truck Tire","22.5 inch heavy duty tire"],["TRP-003"," "," 12 75 ","",70,"TRP","2025-10-21","Car Battery","12V 75Ah battery"],["TRP-004"," ","  ","",1500,"TRP","2025-10-22","Diesel Fuel","High-quality diesel"],["TRP-005"," ","  ","",500,"TRP","2025-10-22","Tie Rope","Strong nylon rope"],["TRP-006"," ","   2 ","",5,"TRP","2025-10-23","Forklift","Electric 2T forklift"],["TRP-007"," ","   ","",250,"TRP","2025-10-23","Pallet","Wooden pallet"],["TRP-008"," "," /  ","",90,"TRP","2025-10-24","Warning Tape","Red/white hazard tape"],["TRP-009"," GPS","  ","",15,"TRP","2025-10-24","GPS Device","Vehicle tracking device"],["TRP-010"," "," LED ","",110,"TRP","2025-10-25","Flashlight","Portable LED flashlight"]],y=[["VRP-001"," ","  ","",200,"VRP","2025-10-15","Notebook","Leather cover notebook"],["VRP-002"," ","  ","",150,"VRP","2025-10-16","Ink Pen","Premium gift pen"],["VRP-003"," ","  ","",30,"VRP","2025-10-16","Business Card","Printed business cards"],["VRP-004"," ","  ","",500,"VRP","2025-10-17","Company Brochure","Services/products brochure"],["VRP-005"," ","  ","",100,"VRP","2025-10-17","Document Bag","Presentation bag"],["VRP-006"," ","   ","",300,"VRP","2025-10-18","Coffee Mug","Mug with company logo"],["VRP-007"," ","  ","",5,"VRP","2025-10-18","Event Ticket","Marketing conference ticket"],["VRP-008"," ","  ","",75,"VRP","2025-10-19","Partnership Contract","Template contract"],["VRP-009"," "," ","",3,"VRP","2025-10-19","Projector","Portable projector"],["VRP-010"," USB","USB 64GB  ","",90,"VRP","2025-10-20","USB Drive","64GB with profiles"]];[...h,...f,...y].forEach(R=>{const[D,V,P,_,x,j,q,W,v]=R,m=[_];l.set($t(r,"items",D),{itemCode:D,nameAr:V,nameEn:W,descriptionAr:P,descriptionEn:v,unit:_,allowedUnits:m,qty:Number(x),ownerDeptId:j,updatedAt:q})}),await l.commit(),await Ky($t(r,"meta","seed_v1"),{at:new Date().toISOString()}),n("Seed completed.")}catch(o){n("Error: "+(o.message||""))}};return p.jsxs("div",{className:"card p-4 space-y-3",children:[p.jsx("div",{className:"font-semibold",children:"Admin Seed (v1)"}),p.jsx("button",{className:"btn-primary",onClick:s,children:"Run Seed"}),e&&p.jsx("div",{className:"text-sm",children:e})]})}const Ip=[{fullName:"Ali Majed",username:"ali.majed",email:"ali.majed@rak.com",uid:"xNEznJJ65TU4EBpXfaRKC3L9dZG2",roles:["storeOfficer"],departments:["VRP","TRP"]},{fullName:"Hussain Abdul Kareem",username:"hussain.abdulkareem",email:"hussain.abdulkareem@rak.com",uid:"ted6NJZynMdQFKTZqpsWZJ0uW9S2",roles:["requester"],departments:["VRP"]},{fullName:"Hasanin Adil",username:"hasanin.adil",email:"hasanin.adil@rak.com",uid:"wiBMUGFzB3OFLJcqwE38zKpaqOr1",roles:["requester","storeOfficer"],departments:["VRP"]},{fullName:"Mohammed Adnan",username:"mohammed.adnan",email:"mohammed.adnan@rak.com",uid:"zUOXvNDfeHSqFO5bSYAgiECqZ342",roles:["requester"],departments:["TRP"]},{fullName:"Abdul Samad Hadi",username:"abdulsamad.hadi",email:"abdulsamad.hadi@rak.com",uid:"ozpFoLSq7JRfZZrXlO7m6Mm7LHn1",roles:["requester","storeOfficer"],departments:["TRP"]},{fullName:"Ahmed Jehad",username:"ahmed.jehad",email:"ahmed.jehad@rak.com",uid:"T6cxpyT4dqedMHe6LQ6mz0MJZLo2",roles:["deptManager","requester","storeOfficer"],departments:["Pipline Project","Pipline Ops"]},{fullName:"Jaffer Akeel",username:"jaffer.akeel",email:"jaffer.akeel@rak.com",uid:"qlZZ6TGs6BOCU611BQf7IZ1xPoh2",roles:["deptManager","requester","storeOfficer"],departments:["Pipline Project","Pipline Ops"]},{fullName:"Ghanam Khalel",username:"ghanam.khalel",email:"ghanam.khalel@rak.com",uid:"LW9vjYJfQOWaiwPrvGB57a4aHbj2",roles:["deptManager","requester","storeOfficer"],departments:["CPS","Leak","Maintenace"]},{fullName:"Store Officer",username:"pipline.storeofficer",email:"pipline.storeofficer@rak.com",uid:"H4fLRhUnoGQ7h5tWLTYmp5he9Qr2",roles:["storeOfficer"],departments:["Pipline Project","Pipline Ops","CPS","Leak","Maintenace"]},{fullName:"Nasser SaadAllah",username:"nasser.saadallah",email:"nasser.saadallah@rak.com",uid:"S0IUmB4tQ7OS4QIKL59xyNoOs1G2",roles:["requester"],departments:[]},{fullName:"Ammer Aouad",username:"ammer.aouad",email:"ammer.aouad@rak.com",uid:"7i7yg7pNjZbihO4DcrGC0R2NU2R2",roles:["deptManager","requester","storeOfficer"],departments:["EI"]},{fullName:"Nashwan Faisal",username:"nashwan.faisal",email:"nashwan.faisal@rak.com",uid:"Kt2oaPXGlhNGWyGifG4ngGAWPEO2",roles:["requester"],departments:["EI"]},{fullName:"Store Officer",username:"ei.storeofficer",email:"ei.storeofficer@rak.com",uid:"ypUphfNw01Wk6g0UAxn3jcBwEMs1",roles:["storeOfficer"],departments:["EI"]}],iV=["admin","deptManager","requester","storeOfficer"];function oV(){var l;const{role:t}=ns(),[e,n]=C.useState(""),[r,s]=C.useState(!1),i=Or();if(!((l=t==null?void 0:t.roles)!=null&&l.admin))return p.jsx("div",{className:"card p-4",children:"Admin only."});const o=async()=>{if(!r){s(!0),n("Running seed");try{const u=$t(i,"meta","users_seed_v1");if((await sa(u)).exists()){n("Seed already executed."),s(!1);return}const h=bA(i);Ip.forEach(f=>{const y=f.departments.map(V=>V.trim()).filter(Boolean),T=$t(i,"usernames",f.username);h.set(T,{uid:f.uid,email:f.email,fullName:f.fullName});const R=$t(i,"roles",f.uid),D=iV.reduce((V,P)=>(V[P]=f.roles.includes(P),V),{});h.set(R,{fullName:f.fullName,email:f.email,departmentIds:y,roles:D})}),await h.commit(),await Ky($t(i,"meta","users_seed_v1"),{at:new Date().toISOString(),count:Ip.length}),n(`Seed completed (${Ip.length} users).`)}catch(u){n(`Error: ${(u==null?void 0:u.message)||String(u)}`)}finally{s(!1)}}};return p.jsxs("div",{className:"card p-4 space-y-3",children:[p.jsx("div",{className:"font-semibold",children:"Admin User Seed"}),p.jsx("p",{className:"text-sm text-gray-600",children:"           ."}),p.jsx("button",{className:"btn-primary",disabled:r,onClick:o,children:r?"Seeding":"Run User Seed"}),e&&p.jsx("div",{className:"text-sm",children:e})]})}function aV(){const{id:t}=SP(),[e,n]=C.useState(null),[r,s]=C.useState(!0),i=Or();return C.useEffect(()=>{(async()=>{if(t)try{const o=await sa($t(i,"requests",t));n(o.data())}finally{s(!1)}})()},[t]),r?p.jsx("div",{className:"card p-6",children:"Loading"}):e?p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"text-xl font-semibold",children:e.rqCode||t}),p.jsxs("div",{className:"card p-6",children:[p.jsxs("div",{className:"text-sm text-gray-600",children:["Project: ",e.projectNameAr||e.projectNameEn||"-"]}),p.jsxs("div",{className:"text-sm text-gray-600",children:["Engineer: ",e.engineerNameAr||e.engineerNameEn||"-"]}),p.jsxs("div",{className:"text-sm text-gray-600",children:["Status: ",e.stage||e.status]})]})]}):p.jsx("div",{className:"card p-6",children:"Not found"})}function lV({open:t,onClose:e}){var T,R,D,V;const{role:n}=ns(),r="left-0",s=(n==null?void 0:n.departmentIds)||[],i=!!((T=n==null?void 0:n.roles)!=null&&T.admin),o=s.includes("Store"),l=!!((R=n==null?void 0:n.roles)!=null&&R.requester),u=!!((D=n==null?void 0:n.roles)!=null&&D.storeOfficer),c=!!((V=n==null?void 0:n.roles)!=null&&V.auditor),h=!!l,f=o&&!i?"/requests":"/",y=({to:P,icon:_,label:x})=>p.jsxs(U_,{to:P,className:({isActive:j})=>`flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-blue-50 ${j?"bg-blue-50":""}`,onClick:e,children:[p.jsx(_,{className:"h-4 w-4 icon-blue"}),p.jsx("span",{children:x})]});return C.useEffect(()=>{const P=_=>{_.key==="Escape"&&e()};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[e]),p.jsxs(p.Fragment,{children:[p.jsx("div",{className:`fixed inset-0 bg-black/20 z-40 sm:hidden ${t?"block":"hidden"}`,onClick:e}),p.jsxs("aside",{className:`fixed ${r} top-0 z-50 h-full w-72 bg-white border ${t?"":"translate-x-[-200%]"} sm:translate-x-0 transition-transform`,children:[p.jsx("div",{className:"p-4 flex items-center justify-between gap-2 border-b",children:p.jsxs(mh,{to:f,onClick:e,className:"flex items-center gap-2",children:[p.jsx("img",{src:"/logo.svg",className:"h-6 w-6"}),p.jsx("div",{className:"font-semibold",children:"RAK IMS"})]})}),p.jsxs("div",{className:"p-3 space-y-1",children:[p.jsx(y,{to:"/",icon:DO,label:"Home"}),p.jsx(y,{to:"/requests",icon:bO,label:"Requests"}),h&&p.jsxs(U_,{to:"/requests/new",className:({isActive:P})=>`flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-blue-50 ${P?"bg-blue-50":""}`,onClick:e,children:[p.jsx(UA,{className:"h-4 w-4 icon-blue"}),p.jsx("span",{children:"New Request"})]}),u&&p.jsx(y,{to:"/inventory",icon:kO,label:"Inventory"}),c&&p.jsx(y,{to:"/reporting",icon:NO,label:"Reporting"}),p.jsx(y,{to:"/profile",icon:jO,label:"Profile"}),p.jsxs("button",{onClick:()=>KN(lf()),className:"flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-blue-50",children:[p.jsx(LO,{className:"h-4 w-4 icon-blue"}),p.jsx("span",{children:"Sign out"})]})]})]})]})}function uV({children:t}){const[e,n]=C.useState(!1);return p.jsxs("div",{className:"min-h-screen bg-white flex",children:[p.jsx(lV,{open:e,onClose:()=>n(!1)}),p.jsxs("div",{className:"flex-1 flex flex-col",children:[p.jsx("button",{className:"sm:hidden fixed top-3 left-3 z-40 btn-ghost",onClick:()=>n(!0),"aria-label":"Menu",children:p.jsx(OO,{className:"h-5 w-5 icon-blue"})}),p.jsx("main",{className:"p-3 sm:p-4 lg:p-6 max-w-6xl w-full mx-auto",children:t})]})]})}function Fs({children:t}){const{user:e,loading:n}=ns();return n?p.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loading"}):e?p.jsx(uV,{children:t}):p.jsx(tS,{to:"/login",replace:!0})}const cV=HP([{path:"/",element:p.jsx(Fs,{children:p.jsx($O,{})})},{path:"/requests",element:p.jsx(Fs,{children:p.jsx(qO,{})})},{path:"/requests/new",element:p.jsx(Fs,{children:p.jsx(ZO,{})})},{path:"/requests/:id",element:p.jsx(Fs,{children:p.jsx(aV,{})})},{path:"/inventory",element:p.jsx(Fs,{children:p.jsx(tV,{})})},{path:"/reporting",element:p.jsx(Fs,{children:p.jsx(nV,{})})},{path:"/profile",element:p.jsx(Fs,{children:p.jsx(rV,{})})},{path:"/admin/seed",element:p.jsx(Fs,{children:p.jsx(sV,{})})},{path:"/admin/seed-users",element:p.jsx(Fs,{children:p.jsx(oV,{})})},{path:"/login",element:p.jsx(SO,{})},{path:"*",element:p.jsx(tS,{to:"/",replace:!0})}]);function dV(){return p.jsx(EO,{children:p.jsx(ZP,{router:cV})})}Ap.createRoot(document.getElementById("root")).render(p.jsx(j0.StrictMode,{children:p.jsx(dV,{})}));
